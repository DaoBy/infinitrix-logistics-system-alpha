import{C as D,g as _,j as O,h as K,d as H,o as d,w as C,b as t,c,e as h,t as g,s as $,a as l,u as a,v as Q,x as J,F as Y,r as X,f as A,W as Z}from"./app-Xu1-QTPS.js";import{E as ee}from"./EmployeeLayout-HD3iRf9t.js";import{_ as m}from"./InputLabel-BxIgZQZ8.js";import{T as y}from"./TextInput-42f6rjVr.js";import{_ as te}from"./TextArea-DrfKMXJu.js";import{_ as S}from"./InputError-D9nXzJOf.js";import{_ as oe}from"./PrimaryButton-CQvisOOW.js";import{_ as P}from"./SecondaryButton-B4_LijSy.js";import{_ as se}from"./MapPicker-qE2233-E.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-Dma88ZBl.js";import"./DangerButton-B9GvHwCg.js";/* empty css                                                                  */const ae={class:"flex justify-between items-center w-full px-4 md:px-6"},le={class:"py-6 px-2 md:px-6"},re={class:"max-w-screen-xl mx-auto"},ie={key:0,class:"mb-6"},ne={key:0,class:"p-4 bg-blue-100 text-blue-800 rounded"},de={key:1,class:"p-4 bg-green-100 text-green-800 rounded"},ue={key:2,class:"p-4 bg-red-100 text-red-800 rounded"},ce={class:"grid grid-cols-1 lg:grid-cols-4 gap-8"},me={class:"lg:col-span-3"},pe={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},ge={class:"space-y-8"},ye={class:"border-b border-gray-200 pb-6"},fe={class:"grid grid-cols-1 gap-6"},ve={class:"flex items-center mt-1"},be={class:"border-b border-gray-200 pb-6"},_e={class:"mt-1 relative"},he={key:0,class:"absolute inset-y-0 right-0 pr-3 flex items-center"},xe={key:1,class:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto"},we=["onClick"],ke={class:"font-medium"},Ve={class:"text-sm text-gray-600"},Ce={class:"border-b border-gray-200 pb-6"},Se={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Me={class:"md:col-span-2"},Ue={class:"md:col-span-2"},Fe={class:"pb-6"},Ae={class:"mt-2 text-sm text-gray-500"},Be={class:"flex justify-between items-center pt-4 px-2"},Ee={class:"lg:col-span-1"},Ge={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Te={class:"flex justify-between items-start mb-3"},$e={key:0,class:"space-y-3"},Pe={key:1,class:"text-center py-2"},Ye={__name:"Edit",props:{region:Object,status:String,success:String,error:String},setup(u){const f=u,x=(r=>{const e=r.split(",").map(s=>s.trim());return{street_address:e[0]||"",barangay:e[1]||"",city_municipality:e[2]||"",province:e[3]||"",postal_code:e[4]||""}})(f.region.warehouse_address),o=D({name:f.region.name,warehouse_address:f.region.warehouse_address,street_address:x.street_address,barangay:x.barangay,city_municipality:x.city_municipality,province:x.province,postal_code:x.postal_code,color_hex:f.region.color_hex||"#CCCCCC",geographic_location:{lat:parseFloat(f.region.geographic_location.latitude),lng:parseFloat(f.region.geographic_location.longitude)}}),M=_(""),b=_([]),U=_(!1),w=_(!1),v=_(null),k=_(!0);let F=null,V=null;function I(r,e){let s;return function(...p){const n=()=>{clearTimeout(s),r(...p)};clearTimeout(s),s=setTimeout(n,e)}}const q=()=>new Promise(r=>{if(window.google&&window.google.maps){w.value=!0,r();return}const e=setInterval(()=>{window.google&&window.google.maps&&(clearInterval(e),w.value=!0,L(),r())},100)});function L(){window.google&&window.google.maps&&(F=new google.maps.places.AutocompleteService,V=new google.maps.Geocoder)}O(async()=>{await q()});const R=I(async r=>{const e=r.target.value;if(!e||e.length<3){b.value=[];return}if(!w.value||!F){console.warn("Google Maps not loaded yet");return}U.value=!0;try{const s={input:e,types:["geocode","establishment"],componentRestrictions:{country:"ph"}};F.getPlacePredictions(s,(i,p)=>{U.value=!1,p===google.maps.places.PlacesServiceStatus.OK&&i?b.value=i.map(n=>({place_id:n.place_id,main_text:n.structured_formatting.main_text,secondary_text:n.structured_formatting.secondary_text,description:n.description})):b.value=[]})}catch(s){U.value=!1,console.error("Address search error:",s)}},300);async function W(r){if(M.value=r.description,b.value=[],!w.value||!V){console.warn("Google Maps not loaded yet");return}try{const e=await new Promise((i,p)=>{V.geocode({placeId:r.place_id},(n,T)=>{T==="OK"&&n[0]?i(n[0]):p(new Error(`Geocoding failed: ${T}`))})});B(e.address_components);const s={lat:e.geometry.location.lat(),lng:e.geometry.location.lng()};o.geographic_location=s,o.warehouse_address=r.description,v.value&&typeof v.value.onMarkerManuallyUpdated=="function"&&v.value.onMarkerManuallyUpdated(s)}catch(e){console.error("Error selecting address:",e),o.warehouse_address=r.description}}function B(r){const e={street:"",barangay:"",city:"",province:"",postal:""};r.forEach(s=>{const i=s.types;i.includes("street_number")?e.street=s.long_name+" "+e.street:i.includes("route")?e.street+=s.long_name:i.includes("sublocality_level_1")||i.includes("sublocality")?e.barangay=s.long_name:i.includes("locality")?e.city=s.long_name:i.includes("administrative_area_level_2")?e.province=s.long_name:i.includes("administrative_area_level_1")?e.province||(e.province=s.long_name):i.includes("postal_code")&&(e.postal=s.long_name)}),o.street_address=e.street.trim(),o.barangay=e.barangay,o.city_municipality=e.city,o.province=e.province,o.postal_code=e.postal}function E(){const r=[o.street_address,o.barangay,o.city_municipality,o.province,o.postal_code].filter(e=>e&&e.trim()!=="");o.warehouse_address=r.join(", ")}K([()=>o.street_address,()=>o.barangay,()=>o.city_municipality,()=>o.province,()=>o.postal_code],()=>{E()});async function N(){if(!(!w.value||!V||!o.warehouse_address))try{const r=await new Promise((s,i)=>{V.geocode({address:o.warehouse_address},(p,n)=>{n==="OK"&&p[0]?s(p[0]):i(new Error(`Geocoding failed: ${n}`))})});B(r.address_components);const e={lat:r.geometry.location.lat(),lng:r.geometry.location.lng()};o.geographic_location=e,v.value&&typeof v.value.onMarkerManuallyUpdated=="function"&&v.value.onMarkerManuallyUpdated(e)}catch(r){console.error("Manual geocoding failed:",r)}}function j(r){o.geographic_location=r}function z(){E(),o.put(route("admin.regions.update",f.region.id),{preserveScroll:!0})}function G(){Z.get(route("admin.regions.index"))}return(r,e)=>(d(),H(ee,null,{header:C(()=>[t("div",ae,[e[15]||(e[15]=t("div",null,[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Edit Warehouse"),t("p",{class:"mt-1 text-sm text-gray-500"}," Update and configure the warehouse with precise location details. ")],-1)),l(P,{onClick:G},{default:C(()=>e[14]||(e[14]=[A("View Warehouses")])),_:1})])]),default:C(()=>[t("div",le,[t("div",re,[u.status||u.success||u.error?(d(),c("div",ie,[u.status?(d(),c("div",ne,g(u.status),1)):h("",!0),u.success?(d(),c("div",de,g(u.success),1)):h("",!0),u.error?(d(),c("div",ue,g(u.error),1)):h("",!0)])):h("",!0),t("div",ce,[t("div",me,[t("div",pe,[t("form",{onSubmit:$(z,["prevent"])},[t("div",ge,[t("div",ye,[e[17]||(e[17]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Step 1: Region Information",-1)),t("div",fe,[t("div",null,[l(m,{for:"name",value:"Region Name *"}),l(y,{id:"name",modelValue:a(o).name,"onUpdate:modelValue":e[0]||(e[0]=s=>a(o).name=s),class:"mt-1 block w-full",placeholder:"e.g., Metro Manila, Central Luzon, Bataan Warehouse",required:""},null,8,["modelValue"]),l(S,{message:a(o).errors.name},null,8,["message"])]),t("div",null,[l(m,{for:"color_hex",value:"Region Color *"}),t("div",ve,[Q(t("input",{type:"color",id:"color_hex","onUpdate:modelValue":e[1]||(e[1]=s=>a(o).color_hex=s),class:"h-10 w-10 rounded border border-gray-300 mr-2"},null,512),[[J,a(o).color_hex]]),l(y,{modelValue:a(o).color_hex,"onUpdate:modelValue":e[2]||(e[2]=s=>a(o).color_hex=s),class:"block w-32",placeholder:"#FF0000",required:"",pattern:"^#[0-9A-Fa-f]{6}$"},null,8,["modelValue"])]),l(S,{message:a(o).errors.color_hex},null,8,["message"]),e[16]||(e[16]=t("p",{class:"text-sm text-gray-500 mt-1"},"Choose a color to represent this region on maps and charts",-1))])])]),t("div",be,[e[20]||(e[20]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Step 2: Find General Location",-1)),t("div",null,[l(m,{for:"address-search",value:"Search for City/Municipality/Landmark *"}),t("div",_e,[l(y,{id:"address-search",modelValue:M.value,"onUpdate:modelValue":e[3]||(e[3]=s=>M.value=s),onInput:a(R),class:"block w-full pr-10",placeholder:"Type city, municipality, or landmark (e.g., Balanga City, Bataan)",autocomplete:"off"},null,8,["modelValue","onInput"]),U.value?(d(),c("div",he,e[18]||(e[18]=[t("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):h("",!0),b.value.length>0&&M.value?(d(),c("div",xe,[(d(!0),c(Y,null,X(b.value,(s,i)=>(d(),c("div",{key:i,onClick:p=>W(s),onMousedown:e[4]||(e[4]=$(()=>{},["prevent"])),class:"px-4 py-2 cursor-pointer hover:bg-gray-100 border-b border-gray-100 last:border-b-0"},[t("div",ke,g(s.main_text),1),t("div",Ve,g(s.secondary_text),1)],40,we))),128))])):h("",!0)]),e[19]||(e[19]=t("p",{class:"text-sm text-gray-500 mt-1"},"Search for the general area first. You'll specify the exact warehouse address in the next step.",-1))])]),t("div",Ce,[e[21]||(e[21]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Step 3: Specify Exact Warehouse Address",-1)),t("div",Se,[t("div",Me,[l(m,{for:"street_address",value:"Street Address/Building Name *"}),l(y,{id:"street_address",modelValue:a(o).street_address,"onUpdate:modelValue":e[5]||(e[5]=s=>a(o).street_address=s),class:"mt-1 block w-full",placeholder:"e.g., 4th Floor, The Bunker, Capitol Compound",required:""},null,8,["modelValue"])]),t("div",null,[l(m,{for:"barangay",value:"Barangay"}),l(y,{id:"barangay",modelValue:a(o).barangay,"onUpdate:modelValue":e[6]||(e[6]=s=>a(o).barangay=s),class:"mt-1 block w-full",placeholder:"e.g., San Jose"},null,8,["modelValue"])]),t("div",null,[l(m,{for:"city_municipality",value:"City/Municipality *"}),l(y,{id:"city_municipality",modelValue:a(o).city_municipality,"onUpdate:modelValue":e[7]||(e[7]=s=>a(o).city_municipality=s),class:"mt-1 block w-full",placeholder:"e.g., Balanga City",required:""},null,8,["modelValue"])]),t("div",null,[l(m,{for:"province",value:"Province *"}),l(y,{id:"province",modelValue:a(o).province,"onUpdate:modelValue":e[8]||(e[8]=s=>a(o).province=s),class:"mt-1 block w-full",placeholder:"e.g., Bataan",required:""},null,8,["modelValue"])]),t("div",null,[l(m,{for:"postal_code",value:"Postal Code"}),l(y,{id:"postal_code",modelValue:a(o).postal_code,"onUpdate:modelValue":e[9]||(e[9]=s=>a(o).postal_code=s),class:"mt-1 block w-full",placeholder:"e.g., 2100"},null,8,["modelValue"])]),t("div",Ue,[l(m,{for:"warehouse_address",value:"Full Warehouse Address (Auto-generated) *"}),l(te,{id:"warehouse_address",modelValue:a(o).warehouse_address,"onUpdate:modelValue":e[10]||(e[10]=s=>a(o).warehouse_address=s),class:"mt-1 block w-full",rows:2,required:"",readonly:"",placeholder:"This will be automatically generated from the fields above"},null,8,["modelValue"]),l(S,{message:a(o).errors.warehouse_address},null,8,["message"])])]),t("div",{class:"mt-4"},[t("button",{type:"button",onClick:N,class:"text-sm text-blue-600 hover:text-blue-800"}," 🔄 Update map location based on address above ")])]),t("div",Fe,[e[23]||(e[23]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Step 4: Verify Location on Map",-1)),t("div",null,[l(m,{value:"Region Location *"}),e[22]||(e[22]=t("p",{class:"text-sm text-gray-600 mb-2"},"Drag the marker to the exact warehouse location. The map will update when you search or enter an address.",-1)),l(se,{ref_key:"mapPickerRef",ref:v,modelValue:a(o).geographic_location,"onUpdate:modelValue":e[11]||(e[11]=s=>a(o).geographic_location=s),class:"h-64 border border-gray-300 rounded-lg mt-2",onMarkerUpdated:j},null,8,["modelValue"]),t("div",Ae," Coordinates: "+g(a(o).geographic_location.lat.toFixed(6))+", "+g(a(o).geographic_location.lng.toFixed(6)),1),l(S,{message:a(o).errors["geographic_location.lat"]},null,8,["message"]),l(S,{message:a(o).errors["geographic_location.lng"]},null,8,["message"])])]),t("div",Be,[l(P,{type:"button",onClick:G},{default:C(()=>e[24]||(e[24]=[A("View Warehouses")])),_:1}),l(oe,{type:"submit",disabled:a(o).processing},{default:C(()=>[A(g(a(o).processing?"Saving...":"Save Changes"),1)]),_:1},8,["disabled"])])])],32)])]),t("div",Ee,[t("div",Ge,[t("div",Te,[e[25]||(e[25]=t("h3",{class:"font-semibold text-blue-800"},"📝 Quick Guide",-1)),t("button",{onClick:e[12]||(e[12]=s=>k.value=!k.value),class:"text-blue-500 hover:text-blue-700 text-sm"},g(k.value?"Hide":"Show"),1)]),k.value?(d(),c("div",$e,e[26]||(e[26]=[t("div",{class:"text-sm text-blue-700"},[t("h4",{class:"font-medium mb-1"},"Step 1: Region Info"),t("p",{class:"text-xs"},"Name your region and choose a color")],-1),t("div",{class:"text-sm text-blue-700"},[t("h4",{class:"font-medium mb-1"},"Step 2: General Search"),t("p",{class:"text-xs"},"Find the city or municipality first")],-1),t("div",{class:"text-sm text-blue-700"},[t("h4",{class:"font-medium mb-1"},"Step 3: Exact Address"),t("p",{class:"text-xs"},"Fill in the specific warehouse details")],-1),t("div",{class:"text-sm text-blue-700"},[t("h4",{class:"font-medium mb-1"},"Step 4: Map Verify"),t("p",{class:"text-xs"},"Drag the pin to the exact location")],-1),t("div",{class:"mt-3 p-2 bg-blue-100 rounded border border-blue-200"},[t("p",{class:"text-xs text-blue-600 font-medium"},"💡 Pro Tip"),t("p",{class:"text-xs text-blue-600 mt-1"}," Can't find the exact address? Search for the nearest city first, then manually enter the full warehouse address below. ")],-1)]))):(d(),c("div",Pe,[t("button",{onClick:e[13]||(e[13]=s=>k.value=!0),class:"text-blue-600 hover:text-blue-800 text-sm"}," Show Guide ")]))])])])])])]),_:1}))}};export{Ye as default};
