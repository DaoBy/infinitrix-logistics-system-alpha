import{p as ne,g as x,C as ie,j as de,d as C,o as r,w as i,b as a,a as v,c as o,e as d,t as l,F as I,r as F,n as V,f as g,k as ue,v as U,u as k,M as ce,x as ge,W as f}from"./app-BOCrhSfO.js";import{E as me}from"./EmployeeLayout-D01AghRc.js";import{_ as j}from"./PrimaryButton-7U4Qu6md.js";import{_ as S}from"./SecondaryButton-BoCxbQ9w.js";import{_ as ve}from"./SearchInput-g_WCWFPT.js";import{S as z}from"./SelectInput-BaEQ9Gfo.js";import{_ as pe}from"./DataTable-C5A94wxb.js";import{M as fe}from"./Modal-Dwgib7t_.js";import{P as ye}from"./Pagination-D3KPnYBN.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-DsrNUkqS.js";import"./DangerButton-CBhu99um.js";const ke={class:"flex justify-between items-center w-full px-6 md:px-8"},_e={class:"flex gap-2"},be={class:"zoom-content"},he={class:"px-6 py-4"},Ce={key:0,class:"mb-4"},Se={key:0,class:"p-3 bg-blue-100 text-blue-800 rounded"},we={key:1,class:"p-3 bg-green-100 text-green-800 rounded"},qe={key:2,class:"p-3 bg-red-100 text-red-800 rounded"},Me={key:1,class:"bg-white shadow-sm rounded-lg overflow-hidden border border-gray-200 mb-4"},Ne={class:"p-4"},Re={class:"flex flex-wrap gap-2"},Ve=["onClick"],je={class:"mb-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3"},Be={class:"w-full sm:w-96"},De={class:"flex items-center gap-3"},Te={class:"text-sm text-gray-500 bg-blue-50 px-3 py-1 rounded border border-blue-100 whitespace-nowrap"},Pe={key:0,class:"ml-1"},$e={class:"justify-center flex items-center"},Ae={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-full max-w-[98vw]"},Le={class:"p-4 bg-white border-b border-gray-200"},Ie={class:"flex items-center space-x-2"},Fe={class:"font-bold text-green-700 tracking-wide text-sm"},Ue={class:"text-xs text-gray-500 mt-1"},ze={key:0},Ee={class:"font-medium text-gray-900"},Oe={class:"text-gray-900"},He={key:0},We={class:"text-sm font-medium text-gray-900 mb-1"},Ge={class:"text-xs text-gray-500 space-y-1"},Je={key:0,class:"flex items-center gap-1"},Ke={key:0,class:"text-gray-400"},Qe={key:1,class:"flex items-center gap-1"},Xe={key:2,class:"text-gray-400"},Ye={key:1,class:"text-sm text-gray-500"},Ze={key:0},et={class:"text-sm font-medium text-gray-900 mb-1"},tt={class:"text-xs text-gray-500 space-y-1"},st={key:0,class:"flex items-center gap-1"},at={key:0,class:"text-gray-400"},rt={key:1,class:"flex items-center gap-1"},lt={key:2,class:"text-gray-400"},ot={key:1,class:"text-sm text-gray-500"},nt={class:"flex items-center"},it={class:"text-gray-700"},dt={class:"flex space-x-2"},ut={class:"text-center py-8"},ct={class:"bg-gray-50 rounded-lg p-6 max-w-md mx-auto"},gt={class:"text-gray-500 mb-3"},mt={key:0,class:"mt-4"},vt={class:"p-5"},pt={class:"space-y-4"},ft=["value"],yt={class:"mt-6 flex justify-end space-x-3"},xt={key:0},kt={key:1},_t={__name:"Index",props:{packages:Object,status:String,success:String,error:String,filters:Object},setup(n){var $,A,L;const _=n,u=ne({search:(($=_.filters)==null?void 0:$.search)||"",category:((A=_.filters)==null?void 0:A.category)||"",status:((L=_.filters)==null?void 0:L.status)||""}),B=x("item_code"),D=x("asc"),b=x(!1),w=x(!1),q=x(null),E=[{field:"delivery_reference",header:"Delivery Ref",sortable:!0},{field:"item_code",header:"Item Code",sortable:!0},{field:"item_name",header:"Item Name",sortable:!0},{field:"sender",header:"Sender",sortable:!1},{field:"receiver",header:"Receiver",sortable:!1},{field:"category",header:"Category",sortable:!0},{field:"status",header:"Status",sortable:!0},{field:"current_region",header:"Current Location",sortable:!0},{field:"actions",header:"Actions",sortable:!1}],O=[{value:"",text:"All Categories"},{value:"piece",text:"Piece"},{value:"carton",text:"Carton"},{value:"sack",text:"Sack"},{value:"roll",text:"Roll"},{value:"B/R",text:"Bundle/Roll"},{value:"C/S",text:"Custom Size"}],H=[{value:"",text:"All Statuses"},{value:"preparing",text:"Preparing"},{value:"loaded",text:"Loaded"},{value:"in_transit",text:"In Transit"},{value:"delivered",text:"Delivered"},{value:"completed",text:"Completed"},{value:"returned",text:"Returned"},{value:"rejected",text:"Rejected"},{value:"damaged_in_transit",text:"Damaged in Transit"},{value:"lost_in_transit",text:"Lost in Transit"}],T=[{value:"preparing",title:"Preparing"},{value:"loaded",title:"Loaded"},{value:"in_transit",title:"In Transit"},{value:"delivered",title:"Delivered"},{value:"completed",title:"Completed"},{value:"returned",title:"Returned"},{value:"rejected",title:"Rejected"},{value:"damaged_in_transit",title:"Damaged in Transit"},{value:"lost_in_transit",title:"Lost in Transit"}],W={preparing:"Preparing",loaded:"Loaded",in_transit:"In Transit",delivered:"Delivered",completed:"Completed",returned:"Returned",rejected:"Rejected",damaged_in_transit:"Damaged in Transit",lost_in_transit:"Lost in Transit"};function p(t){return t&&(t.mobile||t.phone)||null}function y(t){return t&&t.email||null}function G(t){return t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}function J(t){return t?{piece:"Piece",carton:"Carton",sack:"Sack",roll:"Roll","B/R":"Bundle/Roll","C/S":"Carton/Sack"}[t]||t:"N/A"}function h(){const t={...u,page:1};f.visit(route("admin.packages.index"),{data:t,preserveState:!0,preserveScroll:!0,replace:!0})}let P=null;function K(){clearTimeout(P),P=setTimeout(()=>{h()},500)}function Q(){u.search="",u.category="",u.status="",h()}const m=ie({package_id:null,status:"",remarks:""});function X(t){B.value=t.field,D.value=t.direction;const s={...u,sort:t.field,direction:t.direction};f.visit(route("admin.packages.index"),{data:s,preserveState:!0,preserveScroll:!0,replace:!0})}function Y(t){const s={...u,page:t};f.visit(route("admin.packages.index"),{data:s,preserveState:!0,preserveScroll:!0,replace:!0})}function M(){f.reload()}function Z(t){const s=["packages.track","packages.show","admin.packages.show","employee.packages.show"];for(const e of s)if(route().has(e)){f.get(route(e,t));return}f.get(`/packages/${t}`)}function ee(t){q.value=t,m.package_id=t.id,m.status=t.status,m.remarks="",w.value=!0}function N(){w.value=!1,m.reset(),q.value=null}function te(){const t=["admin.packages.mark-status","packages.update-status","employee.packages.update-status"];let s=!1;for(const e of t)if(route().has(e)){m.put(route(e,q.value.id),{preserveScroll:!0,onSuccess:()=>{N(),M()}}),s=!0;break}s||(console.error("No valid status update route found"),alert("Error: Could not find update route"))}function se(t){if(R.value.length===0){alert("Please select at least one package");return}if(confirm(`Are you sure you want to update ${R.value.length} package(s) to ${t}?`)){const s=["admin.packages.bulk-status","packages.bulk-status","employee.packages.bulk-status"];let e=!1;for(const c of s)if(route().has(c)){f.post(route(c),{package_ids:R.value.map(oe=>oe.id),status:t},{preserveScroll:!0,onSuccess:()=>{M()}}),e=!0;break}e||(console.error("No valid bulk status route found"),alert("Error: Could not find bulk update route"))}}function ae(t){return t==="delivered"||t==="completed"?"bg-green-500 text-white hover:bg-green-600":t==="returned"||t==="rejected"?"bg-red-500 text-white hover:bg-red-600":t==="in_transit"||t==="loaded"||t==="ready_for_pickup"?"bg-green-500 text-white hover:bg-green-600":t==="preparing"?"bg-yellow-500 text-white hover:bg-yellow-600":t==="damaged_in_transit"||t==="lost_in_transit"?"bg-red-500 text-white hover:bg-red-600":"bg-gray-500 text-white hover:bg-gray-600"}function re(t){return t==="delivered"||t==="completed"?"bg-green-100 text-green-800":t==="returned"||t==="rejected"?"bg-red-100 text-red-800":t==="in_transit"||t==="loaded"||t==="ready_for_pickup"?"bg-green-100 text-green-800":t==="preparing"?"bg-yellow-100 text-yellow-800":t==="damaged_in_transit"||t==="lost_in_transit"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}function le(t){switch(t){case"piece":return"bg-blue-100 text-blue-800";case"carton":return"bg-green-100 text-green-800";case"sack":return"bg-amber-100 text-amber-800";case"roll":return"bg-red-100 text-red-800";case"B/R":return"bg-indigo-100 text-indigo-800";case"C/S":return"bg-pink-100 text-pink-800";default:return"bg-gray-100 text-gray-800"}}const R=x([]);return de(()=>{console.log("Initial filters from server:",_.filters)}),(t,s)=>(r(),C(me,null,{header:i(()=>[a("div",ke,[s[7]||(s[7]=a("div",null,[a("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Package Monitoring"),a("p",{class:"mt-1 text-sm text-gray-500"}," Track and manage package status and locations ")],-1)),a("div",_e,[v(S,{onClick:M},{default:i(()=>s[6]||(s[6]=[g("Refresh Data")])),_:1}),t.$page.props.auth.user.is_admin?(r(),C(j,{key:0,onClick:s[0]||(s[0]=e=>b.value=!b.value)},{default:i(()=>[g(l(b.value?"Hide Tools":"Status Tools"),1)]),_:1})):d("",!0)])])]),default:i(()=>[a("div",be,[a("div",he,[n.status||n.success||n.error?(r(),o("div",Ce,[n.status?(r(),o("div",Se,l(n.status),1)):d("",!0),n.success?(r(),o("div",we,l(n.success),1)):d("",!0),n.error?(r(),o("div",qe,l(n.error),1)):d("",!0)])):d("",!0),b.value&&t.$page.props.auth.user.is_admin?(r(),o("div",Me,[s[8]||(s[8]=a("div",{class:"p-4 bg-blue-50 border-b border-gray-200"},[a("h3",{class:"font-medium text-gray-900 flex items-center"}," Bulk Status Actions ")],-1)),a("div",Ne,[a("div",Re,[(r(),o(I,null,F(T,e=>a("button",{key:e.value,onClick:c=>se(e.value),class:V(["px-3 py-1.5 text-sm rounded-md",ae(e.value)])}," Mark as "+l(e.title),11,Ve)),64))])])])):d("",!0),a("div",je,[a("div",Be,[v(ve,{modelValue:u.search,"onUpdate:modelValue":s[1]||(s[1]=e=>u.search=e),placeholder:"Search packages by item code, name, waybill, or reference...",class:"w-full",onInput:K},null,8,["modelValue"])]),a("div",De,[v(z,{modelValue:u.category,"onUpdate:modelValue":s[2]||(s[2]=e=>u.category=e),options:O,"option-value":"value","option-label":"text",placeholder:"All Categories",class:"w-full sm:w-48",onChange:h},null,8,["modelValue"]),v(z,{modelValue:u.status,"onUpdate:modelValue":s[3]||(s[3]=e=>u.status=e),options:H,"option-value":"value","option-label":"text",placeholder:"All Statuses",class:"w-full sm:w-48",onChange:h},null,8,["modelValue"]),a("div",Te,[g(" ðŸ“¦ Showing "+l(n.packages.data?n.packages.data.length:0)+" "+l(n.packages.data&&n.packages.data.length===1?"package":"packages")+" ",1),n.packages.data&&n.packages.total>n.packages.per_page?(r(),o("span",Pe," (Page "+l(n.packages.current_page)+" of "+l(n.packages.last_page)+") ",1)):d("",!0)])])]),a("div",$e,[a("div",Ae,[a("div",Le,[v(pe,{columns:E,data:n.packages.data||[],"sort-field":B.value,"sort-direction":D.value,onSort:X,class:"w-full"},{delivery_reference:i(({row:e})=>{var c;return[a("div",Ie,[s[9]||(s[9]=a("span",{class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-green-100 text-green-800"}," Ref ",-1)),a("span",Fe,l(((c=e.delivery_request)==null?void 0:c.reference_number)||`DR-${String(e.delivery_request_id||"").padStart(6,"0")}`),1)]),a("div",Ue,[g(" ID: DO-"+l(String(e.delivery_request_id||"").padStart(6,"0"))+" ",1),e.created_at?(r(),o("span",ze," | Created: "+l(G(e.created_at)),1)):d("",!0)])]}),item_code:i(({row:e})=>[a("div",Ee,l(e.item_code),1)]),item_name:i(({row:e})=>[a("div",Oe,l(e.item_name),1)]),sender:i(({row:e})=>{var c;return[(c=e.delivery_request)!=null&&c.sender?(r(),o("div",He,[a("div",We,l(e.delivery_request.sender.name||e.delivery_request.sender.company_name||"N/A"),1),a("div",Ge,[p(e.delivery_request.sender)?(r(),o("div",Je,[s[10]||(s[10]=a("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),g(" "+l(p(e.delivery_request.sender))+" ",1),e.delivery_request.sender.phone&&e.delivery_request.sender.mobile?(r(),o("span",Ke," ("+l(e.delivery_request.sender.mobile===p(e.delivery_request.sender)?"Mobile":"Phone")+") ",1)):d("",!0)])):d("",!0),y(e.delivery_request.sender)?(r(),o("div",Qe,[s[11]||(s[11]=a("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),g(" "+l(y(e.delivery_request.sender)),1)])):d("",!0),!p(e.delivery_request.sender)&&!y(e.delivery_request.sender)?(r(),o("div",Xe," No contact info ")):d("",!0)])])):(r(),o("div",Ye,"No sender info"))]}),receiver:i(({row:e})=>{var c;return[(c=e.delivery_request)!=null&&c.receiver?(r(),o("div",Ze,[a("div",et,l(e.delivery_request.receiver.name||e.delivery_request.receiver.company_name||"N/A"),1),a("div",tt,[p(e.delivery_request.receiver)?(r(),o("div",st,[s[12]||(s[12]=a("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),g(" "+l(p(e.delivery_request.receiver))+" ",1),e.delivery_request.receiver.phone&&e.delivery_request.receiver.mobile?(r(),o("span",at," ("+l(e.delivery_request.receiver.mobile===p(e.delivery_request.receiver)?"Mobile":"Phone")+") ",1)):d("",!0)])):d("",!0),y(e.delivery_request.receiver)?(r(),o("div",rt,[s[13]||(s[13]=a("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),g(" "+l(y(e.delivery_request.receiver)),1)])):d("",!0),!p(e.delivery_request.receiver)&&!y(e.delivery_request.receiver)?(r(),o("div",lt," No contact info ")):d("",!0)])])):(r(),o("div",ot,"No receiver info"))]}),category:i(({row:e})=>[a("span",{class:V(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",le(e.category)])},l(J(e.category)),3)]),status:i(({row:e})=>[a("span",{class:V(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",re(e.status)])},l(W[e.status]||"N/A"),3)]),current_region:i(({row:e})=>{var c;return[a("div",nt,[e.current_region&&e.current_region.color_hex?(r(),o("div",{key:0,class:"w-3 h-3 rounded-full mr-2 border border-gray-300",style:ue({backgroundColor:e.current_region.color_hex})},null,4)):d("",!0),a("span",it,l(((c=e.current_region)==null?void 0:c.name)||"N/A"),1)])]}),actions:i(({row:e})=>[a("div",dt,[v(S,{onClick:c=>Z(e.id),class:"text-xs py-1 px-2"},{default:i(()=>s[14]||(s[14]=[g("View")])),_:2},1032,["onClick"]),t.$page.props.auth.user.is_admin?(r(),C(j,{key:0,onClick:c=>ee(e),class:"text-xs py-1 px-2"},{default:i(()=>s[15]||(s[15]=[g(" Update Status ")])),_:2},1032,["onClick"])):d("",!0)])]),empty:i(()=>[a("div",ut,[a("div",ct,[s[17]||(s[17]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-10 w-10 text-gray-400 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1)),s[18]||(s[18]=a("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No packages found",-1)),a("p",gt,l(u.search||u.category||u.status?"Try adjusting your search terms or filters":"No packages are currently being tracked"),1),u.search||u.category||u.status?(r(),C(S,{key:0,onClick:Q,class:"mt-2"},{default:i(()=>s[16]||(s[16]=[g(" Clear Filters ")])),_:1})):d("",!0)])])]),_:1},8,["data","sort-field","sort-direction"]),n.packages&&n.packages.links&&n.packages.links.length>3?(r(),o("div",mt,[v(ye,{pagination:n.packages,onPageChanged:Y},null,8,["pagination"])])):d("",!0)])])])])]),v(fe,{show:w.value,onClose:N,"max-width":"md"},{default:i(()=>[a("div",vt,[s[23]||(s[23]=a("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Update Package Status",-1)),a("div",pt,[a("div",null,[s[20]||(s[20]=a("label",{for:"status",class:"block text-sm font-medium text-gray-700"},"New Status *",-1)),U(a("select",{id:"status","onUpdate:modelValue":s[4]||(s[4]=e=>k(m).status=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},[s[19]||(s[19]=a("option",{disabled:"",value:""},"Select a status",-1)),(r(),o(I,null,F(T,e=>a("option",{key:e.value,value:e.value},l(e.title),9,ft)),64))],512),[[ce,k(m).status]])]),a("div",null,[s[21]||(s[21]=a("label",{for:"remarks",class:"block text-sm font-medium text-gray-700"},"Remarks",-1)),U(a("textarea",{id:"remarks",rows:"3","onUpdate:modelValue":s[5]||(s[5]=e=>k(m).remarks=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Add any remarks about the status update..."},null,512),[[ge,k(m).remarks]])])]),a("div",yt,[v(S,{onClick:N},{default:i(()=>s[22]||(s[22]=[g(" Cancel ")])),_:1}),v(j,{onClick:te,disabled:k(m).processing},{default:i(()=>[k(m).processing?(r(),o("span",xt,"Updating...")):(r(),o("span",kt,"Update Status"))]),_:1},8,["disabled"])])])]),_:1},8,["show"])]),_:1}))}},Dt=xe(_t,[["__scopeId","data-v-4b396075"]]);export{Dt as default};
