import{i as R,g as L,h as Re,j as dt,d as _e,o as l,w as z,b as e,c as n,e as d,t as r,f as g,F as P,r as Z,n as $,a as M,W as se,p as Ft,q as rt,s as it,k as lt,u as It,v as Wt,x as Pt}from"./app-AKIpI5kC.js";import{E as Lt}from"./EmployeeLayout-BOs8DfTq.js";import{_ as ke}from"./PrimaryButton-C4c8jBYk.js";import{_ as re}from"./SecondaryButton-piyuntTR.js";import{D as nt}from"./DangerButton-ttTomH3t.js";import{S as qe}from"./SelectInput-Cl2C_FMi.js";import{_ as ot}from"./SearchInput-CeYc0t6l.js";import{_ as Ht,a as Et}from"./ConfirmationModal-CsKcrEJD.js";import{M as ut}from"./Modal-BjHu2a2U.js";import{_ as Ut}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Ot}from"./StatusBadge-CZj25irX.js";import{r as Kt}from"./TruckIcon-DNlcQwxY.js";import"./NavLink-BIDGqMa0.js";const Gt={class:"p-4 max-h-[90vh] overflow-y-auto"},Jt={class:"bg-gray-50 rounded-lg p-3 mb-4"},Qt={class:"flex items-center space-x-3"},Xt={class:"flex items-center space-x-2 flex-1"},Yt={class:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center"},Zt={class:"text-blue-600 font-medium text-xs"},es={class:"min-w-0 flex-1"},ts={class:"text-sm font-medium text-gray-900 truncate"},ss={class:"flex items-center space-x-2 flex-1"},as={class:"min-w-0 flex-1"},rs={class:"text-sm font-medium text-gray-900 truncate"},is={class:"text-xs text-gray-500 truncate"},ls={key:0,class:"mt-2 flex justify-center"},ns={class:"mb-4"},os={key:0,class:"flex items-center justify-center py-4"},ds={key:1,class:"space-y-2"},us={class:"flex items-center"},cs={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},ms={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},vs={key:2,class:"mt-3 p-2 bg-red-50 border border-red-200 rounded text-sm"},gs={class:"text-red-700 text-xs list-disc list-inside space-y-1"},ps={key:0},_s={key:1},xs={key:2},fs={class:"flex justify-end space-x-2 pt-3 border-t"},hs={key:0,class:"flex items-center"},ys={key:1},bs={__name:"DispatchModal",props:{show:{type:Boolean,default:!1},set:{type:Object,default:null}},emits:["close","dispatched"],setup(Q,{emit:B}){const N=Q,ee=B,oe=R(()=>[{key:"assigned_orders",label:"Assigned Deliveries",passed:k.value.has_assigned_orders,status:k.value.has_assigned_orders?`${k.value.assigned_orders_count} orders`:"No orders"},{key:"truck",label:"Truck Available",passed:k.value.truck_available,status:k.value.truck_available?"Available":"Unavailable"},{key:"driver",label:"Driver Available",passed:k.value.driver_available,status:k.value.driver_available?"Available":"Unavailable"},{key:"waybills",label:"Waybills",passed:k.value.waybills_complete,status:k.value.waybills_complete?"Complete":"Missing"},{key:"stickers",label:"Package Stickers",passed:k.value.stickers_complete,status:k.value.stickers_complete?"Complete":"Missing"},{key:"manifest",label:"Manifest",passed:k.value.manifest_complete,status:k.value.manifest_complete?"Finalized":"Not ready"}]),k=L({can_dispatch:!1,has_assigned_orders:!1,assigned_orders_count:0,truck_available:!1,driver_available:!1,waybills_complete:!1,stickers_complete:!1,manifest_complete:!1,missing_waybills:[],unstickerized_packages:[],errors:[],warnings:[],message:"",total_volume:0,total_weight:0,capacity_percentage:0,manifest_check:null}),T=L(!1),H=L(!1),q=()=>{ee("close")},xe=async()=>{var u;if(!(!((u=N.set)!=null&&u.id)||!k.value.can_dispatch)){H.value=!0;try{await se.post(route("cargo-assignments.dispatch.driver-truck-set",N.set.id),{},{onSuccess:()=>{ee("dispatched"),q()},onError:o=>{console.error("Dispatch failed:",o),alert("Dispatch failed. Please check the requirements and try again.")},onFinish:()=>{H.value=!1}})}catch(o){console.error("Dispatch error:",o),H.value=!1,alert("An error occurred during dispatch. Please try again.")}}},ie=async()=>{var u,o,v,X,b;if((u=N.set)!=null&&u.id){T.value=!0;try{const Y=await fetch(route("cargo-assignments.dispatch.validate",N.set.id));if(!Y.ok)throw new Error(`HTTP error! status: ${Y.status}`);const V=await Y.json(),te=V.manifest_check||{},de=te.has_manifest&&te.manifest_valid;k.value={can_dispatch:V.is_valid||!1,has_assigned_orders:V.assigned_orders_count>0,assigned_orders_count:V.assigned_orders_count||0,truck_available:!((o=V.errors)!=null&&o.some(ae=>ae.includes("Truck"))),driver_available:!((v=V.errors)!=null&&v.some(ae=>ae.includes("Driver"))),waybills_complete:(((X=V.missing_waybills)==null?void 0:X.length)||0)===0,stickers_complete:(((b=V.unstickerized_packages)==null?void 0:b.length)||0)===0,manifest_complete:de,missing_waybills:V.missing_waybills||[],unstickerized_packages:V.unstickerized_packages||[],errors:V.errors||[],warnings:V.warnings||[],message:V.message||"",total_volume:V.total_volume||0,total_weight:V.total_weight||0,capacity_percentage:V.capacity_percentage||0,manifest_check:te}}catch(Y){console.error("Validation error:",Y),k.value={can_dispatch:!1,has_assigned_orders:!1,assigned_orders_count:0,truck_available:!1,driver_available:!1,waybills_complete:!1,stickers_complete:!1,manifest_complete:!1,missing_waybills:[],unstickerized_packages:[],errors:["Failed to validate dispatch requirements: "+Y.message],warnings:[],message:"Failed to validate dispatch requirements",total_volume:0,total_weight:0,capacity_percentage:0,manifest_check:null}}finally{T.value=!1}}};return Re(()=>N.show,u=>{var o;u&&((o=N.set)!=null&&o.id)&&ie()}),Re(()=>N.set,u=>{N.show&&(u!=null&&u.id)&&ie()}),dt(()=>{var u;N.show&&((u=N.set)!=null&&u.id)&&ie()}),(u,o)=>(l(),_e(ut,{show:Q.show,"max-width":"lg",onClose:q},{default:z(()=>{var v,X,b,Y,V,te,de,ae,c,fe,U,he,we;return[e("div",Gt,[e("div",{class:"flex items-center justify-between mb-3"},[o[1]||(o[1]=e("h3",{class:"text-lg font-medium text-gray-900"}," Dispatch Driver-Truck Set ",-1)),e("button",{onClick:q,class:"text-gray-400 hover:text-gray-600"},o[0]||(o[0]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Jt,[e("div",Qt,[e("div",Xt,[e("div",Yt,[e("span",Zt,r(((X=(v=Q.set)==null?void 0:v.driver)==null?void 0:X.initials)||"DR"),1)]),e("div",es,[e("p",ts,r(((Y=(b=Q.set)==null?void 0:b.driver)==null?void 0:Y.name)||"N/A"),1)])]),e("div",ss,[o[2]||(o[2]=e("svg",{class:"h-6 w-6 text-indigo-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})],-1)),e("div",as,[e("p",rs,r(((te=(V=Q.set)==null?void 0:V.truck)==null?void 0:te.license_plate)||"N/A"),1),e("p",is,r((ae=(de=Q.set)==null?void 0:de.truck)==null?void 0:ae.make)+" "+r((fe=(c=Q.set)==null?void 0:c.truck)==null?void 0:fe.model),1)])])]),(U=Q.set)!=null&&U.available_for_backhaul?(l(),n("div",ls,o[3]||(o[3]=[e("span",{class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-purple-100 text-purple-800 border border-purple-300"},[e("svg",{class:"h-3 w-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})]),g(" Backhaul Assignment ")],-1)]))):d("",!0)]),e("div",ns,[o[6]||(o[6]=e("h4",{class:"text-sm font-medium text-gray-900 mb-2"}," Dispatch Requirements ",-1)),T.value?(l(),n("div",os,o[4]||(o[4]=[e("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"},null,-1),e("span",{class:"text-sm text-gray-600"},"Validating requirements...",-1)]))):(l(),n("div",ds,[(l(!0),n(P,null,Z(oe.value,O=>(l(),n("div",{key:O.key,class:$(["flex items-center justify-between p-2 border rounded text-sm",O.passed?"border-green-200 bg-green-50":"border-red-200 bg-red-50"])},[e("div",us,[(l(),n("svg",{class:$([O.passed?"text-green-500":"text-red-500","w-4 h-4 mr-2"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[O.passed?(l(),n("path",cs)):(l(),n("path",ms))],2)),e("span",null,r(O.label),1)]),e("span",{class:$([O.passed?"text-green-700":"text-red-700","text-xs font-medium"])},r(O.status),3)],2))),128))])),!k.value.can_dispatch&&!T.value?(l(),n("div",vs,[o[5]||(o[5]=e("p",{class:"text-red-800 font-medium mb-1"},"Cannot Dispatch:",-1)),e("ul",gs,[(l(!0),n(P,null,Z(k.value.errors,O=>(l(),n("li",{key:O},r(O),1))),128)),((he=k.value.missing_waybills)==null?void 0:he.length)>0?(l(),n("li",ps," Missing waybills: "+r(k.value.missing_waybills.length)+" orders ",1)):d("",!0),((we=k.value.unstickerized_packages)==null?void 0:we.length)>0?(l(),n("li",_s," Missing stickers: "+r(k.value.unstickerized_packages.length)+" packages ",1)):d("",!0),k.value.manifest_complete?d("",!0):(l(),n("li",xs," Manifest not finalized "))])])):d("",!0)]),e("div",fs,[M(re,{onClick:q,disabled:H.value,size:"sm"},{default:z(()=>o[7]||(o[7]=[g(" Cancel ")])),_:1},8,["disabled"]),M(ke,{onClick:xe,disabled:!k.value.can_dispatch||H.value,size:"sm",class:"min-w-24"},{default:z(()=>[H.value?(l(),n("span",hs,o[8]||(o[8]=[e("div",{class:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"},null,-1),g(" Dispatching... ")]))):(l(),n("span",ys," Dispatch "))]),_:1},8,["disabled"])])])]}),_:1},8,["show"]))}},ks=Ut(bs,[["__scopeId","data-v-93717be2"]]),ws={class:"flex flex-wrap justify-between items-center gap-4 px-4 md:px-6 w-full"},Cs={class:"flex flex-wrap gap-2"},As={key:0,class:"px-4 md:px-6 py-2 max-w-screen-xl mx-auto"},Ss={class:"py-6 px-2 md:px-6"},Ds={key:0,class:"flex justify-center items-center py-12"},Ms={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6 text-center mb-6 max-w-screen-xl mx-auto"},$s={class:"mt-1 text-sm text-red-600"},Vs={class:"bg-white shadow-sm rounded-lg border border-gray-200 mb-6 max-w-screen-xl mx-auto"},js={class:"border-b border-gray-200"},zs={class:"-mb-px flex space-x-8 px-6"},qs=["disabled"],Rs=["disabled"],Ns=["disabled"],Bs={class:"p-4 border-b border-gray-200"},Ts={class:"flex flex-col lg:flex-row gap-4"},Fs={class:"flex-1"},Is={class:"flex items-center gap-2"},Ws={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4"},Ps={class:"flex justify-between items-center mt-4"},Ls={class:"text-sm text-gray-500"},Hs={key:0,class:"ml-2"},Es={key:1,class:"ml-2"},Us={key:2,class:"ml-2"},Os={key:0,class:"text-xs text-gray-600"},Ks={key:0,class:"flex justify-center items-center py-12 max-w-screen-xl mx-auto"},Gs={class:"ml-3 text-gray-600"},Js={key:1,class:"mb-6 max-w-screen-xl mx-auto"},Qs={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Xs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Ys={class:"flex justify-between items-start mb-3"},Zs={class:"font-medium text-gray-900"},ea={class:"text-sm text-gray-500"},ta={key:0,class:"px-2 py-1 rounded-full text-xs font-semibold bg-purple-100 text-purple-800 border border-purple-300"},sa={class:"text-xs text-gray-600 mb-3"},aa={key:0,class:"mb-3 p-2 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800"},ra={key:0,class:"max-w-screen-xl mx-auto"},ia={class:"bg-white shadow-sm rounded-lg overflow-hidden border border-gray-200"},la={class:"overflow-x-auto"},na={class:"min-w-full divide-y divide-gray-200"},oa={class:"bg-gray-50"},da={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},ua=["checked"],ca={class:"bg-white divide-y divide-gray-200"},ma={class:"px-6 py-4 whitespace-nowrap"},va=["checked","onChange"],ga={class:"px-6 py-4 whitespace-nowrap"},pa={class:"flex items-center space-x-2"},_a={class:"font-bold text-green-700 tracking-wide text-sm"},xa={class:"text-xs text-gray-500 mt-1"},fa={key:0,class:"text-xs text-yellow-600 flex items-center mt-1"},ha={class:"px-6 py-4 whitespace-nowrap"},ya={class:"text-sm text-gray-900"},ba={class:"text-sm text-gray-500"},ka={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},wa={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ca={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Aa={class:"px-6 py-4 whitespace-nowrap"},Sa={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Da={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ma={key:0,class:"text-center py-12"},$a={key:1,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Va={class:"flex-1 flex justify-between items-center"},ja={class:"text-sm text-gray-700"},za={class:"flex space-x-2"},qa=["disabled"],Ra=["disabled"],Na={key:1,class:"max-w-screen-xl mx-auto"},Ba={class:"bg-white shadow-sm rounded-lg overflow-hidden border border-gray-200"},Ta={class:"overflow-x-auto"},Fa={class:"min-w-full divide-y divide-gray-200"},Ia={class:"bg-white divide-y divide-gray-200"},Wa={class:"px-6 py-4 whitespace-nowrap"},Pa={class:"flex items-center space-x-2"},La={class:"font-bold text-green-700 tracking-wide text-sm"},Ha={class:"text-xs text-gray-500 mt-1"},Ea={class:"px-6 py-4 whitespace-nowrap"},Ua={class:"text-sm text-gray-900"},Oa={class:"text-sm text-gray-500"},Ka={class:"px-6 py-4 whitespace-nowrap"},Ga={class:"flex items-center"},Ja={key:0,class:"flex-shrink-0 h-8 w-8 bg-green-100 rounded-full flex items-center justify-center"},Qa={class:"text-green-600 font-medium text-xs"},Xa={key:1,class:"flex-shrink-0 h-8 w-8 bg-gray-100 rounded-full flex items-center justify-center"},Ya={class:"ml-3"},Za={class:"text-sm font-medium text-gray-900"},er={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},tr={class:"text-xs text-gray-500"},sr={class:"px-6 py-4 whitespace-nowrap"},ar={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800 border border-blue-300"},rr={key:1,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800 border border-gray-300"},ir={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},lr={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},nr={class:"flex justify-end space-x-2"},or={key:1,class:"inline-flex items-center px-2 py-1 text-xs text-gray-400 bg-gray-100 rounded border border-gray-300",title:"Cannot cancel - Manifest finalized"},dr={key:0,class:"text-center py-12"},ur={key:1,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},cr={class:"flex-1 flex justify-between items-center"},mr={class:"text-sm text-gray-700"},vr={class:"flex space-x-2"},gr=["disabled"],pr=["disabled"],_r={key:2,class:"max-w-screen-xl mx-auto"},xr={class:"bg-white shadow-sm rounded-lg overflow-hidden border border-gray-200"},fr={class:"overflow-x-auto"},hr={class:"min-w-full divide-y divide-gray-200"},yr={class:"bg-white divide-y divide-gray-200"},br={class:"px-6 py-4 whitespace-nowrap"},kr={class:"flex items-center space-x-2"},wr={class:"font-bold text-green-700 tracking-wide text-sm"},Cr={class:"text-xs text-gray-500 mt-1"},Ar={class:"px-6 py-4 whitespace-nowrap"},Sr={class:"text-sm text-gray-900"},Dr={class:"text-sm text-gray-500"},Mr={class:"px-6 py-4 whitespace-nowrap"},$r={class:"flex items-center"},Vr={class:"flex-shrink-0 h-8 w-8 bg-purple-100 rounded-full flex items-center justify-center"},jr={class:"text-purple-600 font-medium text-xs"},zr={class:"ml-3"},qr={class:"text-sm font-medium text-gray-900"},Rr={class:"text-xs text-gray-500"},Nr={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Br={class:"text-xs text-gray-500"},Tr={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Fr={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ir={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Wr={key:0,class:"text-center py-12"},Pr={key:1,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Lr={class:"flex-1 flex justify-between items-center"},Hr={class:"text-sm text-gray-700"},Er={class:"flex space-x-2"},Ur=["disabled"],Or=["disabled"],Kr={class:"mt-8 max-w-screen-xl mx-auto"},Gr={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Jr={class:"lg:col-span-1"},Qr={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},Xr={class:"flex justify-between items-center mb-4"},Yr={class:"text-lg font-medium text-gray-900"},Zr={class:"space-y-3 max-h-96 overflow-y-auto"},ei={class:"flex justify-between items-start"},ti={class:"flex-1"},si={class:"flex items-center space-x-2 mb-2"},ai={class:"font-bold text-green-700 tracking-wide text-sm"},ri={class:"text-xs text-gray-500"},ii={class:"mt-1 text-xs text-gray-600"},li={key:0,class:"mt-1 p-1 bg-yellow-100 border border-yellow-300 rounded text-xs text-yellow-800"},ni={key:1,class:"mt-1 p-1 bg-red-100 border border-red-300 rounded text-xs text-red-800"},oi=["onClick"],di={key:1,class:"text-center text-gray-500 py-8"},ui={key:0,class:"mt-4 pt-4 border-t border-gray-200"},ci={class:"text-sm text-gray-600 space-y-1"},mi={key:0,class:"p-2 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800 mt-2"},vi={key:1,class:"p-2 bg-red-50 border border-red-200 rounded text-xs text-red-800 mt-2"},gi={key:2,class:"p-2 bg-red-50 border border-red-200 rounded text-xs text-red-800 mt-2"},pi={class:"lg:col-span-2"},_i={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},xi={class:"flex justify-between items-center mb-4"},fi={class:"flex space-x-2"},hi=["onClick"],yi={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},bi=["onClick"],ki={class:"flex justify-between items-start mb-3"},wi={class:"flex items-center"},Ci={class:"ml-3"},Ai={class:"text-sm font-medium text-gray-900"},Si={key:0,class:"mt-1"},Di={key:1,class:"mt-1"},Mi={class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800"},$i={class:"flex flex-col items-end space-y-1"},Vi={key:0,class:"px-2 py-1 rounded-full text-xs font-semibold bg-purple-100 text-purple-800 border border-purple-300"},ji={class:"mb-3"},zi={class:"text-sm font-medium text-gray-900"},qi={class:"text-xs text-gray-500"},Ri={class:"grid grid-cols-2 gap-2 text-sm mb-3"},Ni={class:"font-medium"},Bi={class:"mb-4 space-y-3"},Ti={class:"flex justify-between text-xs text-gray-600 mb-1"},Fi={class:"w-full bg-gray-200 rounded-full h-2"},Ii={class:"text-xs text-gray-500 mt-1 text-right"},Wi={class:"flex justify-between text-xs text-gray-600 mb-1"},Pi={class:"w-full bg-gray-200 rounded-full h-2"},Li={class:"text-xs text-gray-500 mt-1 text-right"},Hi={class:"text-xs text-gray-600 mb-3 space-y-1"},Ei={key:0,class:"mt-2 text-center"},Ui={key:0,class:"text-center py-8"},Oi={class:"text-gray-400 mb-4"},Ki={class:"space-y-4"},Gi={class:"flex items-start"},Ji={class:"flex-shrink-0 mt-0.5"},Qi={key:0,class:"h-5 w-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Xi={key:1,class:"h-5 w-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Yi={class:"ml-3 flex-1"},Zi={class:"font-medium text-sm"},el={key:0,class:"mt-1 text-xs space-y-1"},tl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},sl={class:"bg-gray-50 rounded-lg p-3 border border-gray-200"},al={class:"space-y-2 text-xs"},rl={class:"flex justify-between"},il={class:"font-medium"},ll={class:"flex justify-between"},nl={class:"flex justify-between"},ol={class:"font-medium"},dl={class:"flex justify-between"},ul={class:"bg-gray-50 rounded-lg p-3 border border-gray-200"},cl={class:"flex items-center space-x-3"},ml={class:"flex-1 min-w-0"},vl={class:"text-sm font-medium text-gray-900 truncate"},gl={class:"text-xs text-gray-500 truncate"},pl={class:"flex items-center space-x-2 mt-1"},_l={class:"text-xs text-gray-500"},xl={key:0,class:"px-1.5 py-0.5 rounded-full text-xs font-semibold bg-purple-100 text-purple-800 border border-purple-300"},fl={class:"mt-1"},hl={class:"border rounded-lg"},yl={class:"bg-gray-50 px-3 py-2 border-b"},bl={class:"text-sm font-medium text-gray-900 flex items-center"},kl={class:"max-h-40 overflow-y-auto"},wl={class:"flex justify-between items-start"},Cl={class:"flex-1 min-w-0"},Al={class:"flex items-center space-x-2"},Sl={class:"font-medium text-sm text-gray-900 truncate"},Dl={class:"text-xs text-gray-500 mt-0.5 truncate"},Ml={class:"flex items-center space-x-3 mt-1 text-xs text-gray-400"},$l={class:"flex items-center space-x-1 ml-2"},Vl={key:0,class:"inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-yellow-100 text-yellow-800",title:"Missing stickers"},jl={key:1,class:"inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-red-100 text-red-800",title:"Region mismatch"},zl={class:"p-6"},ql={class:"mt-4 bg-red-50 border border-red-200 rounded-lg p-4"},Rl={class:"flex items-start"},Nl={class:"ml-3"},Bl={class:"mt-2 text-sm text-red-700 space-y-1"},Tl={class:"mt-4"},Fl={class:"mt-6 flex justify-end space-x-4"},Yl={__name:"Index",props:{deliveries:Object,driverTruckSets:{type:Array,default:()=>[]},batchSuggestions:{type:Array,default:()=>[]},regions:{type:Array,default:()=>[]},flash:Object,filters:Object},setup(Q){var Oe,Ke,Ge,Je,Qe,Xe;const B=Q,N=L(!1),ee=L(null),oe=L(!1),k=L(!1),T=L(null),H=L(""),q=L(!1),xe=L(!1),ie=L(null),u=L(((Oe=B.filters)==null?void 0:Oe.activeTab)||"ready"),o=L([]),v=L(null),X=L("all"),b=Ft({search:((Ke=B.filters)==null?void 0:Ke.search)||"",region_id:((Ge=B.filters)==null?void 0:Ge.region_id)||"",driver_id:((Je=B.filters)==null?void 0:Je.driver_id)||"",sticker_status:((Qe=B.filters)==null?void 0:Qe.sticker_status)||"",status:((Xe=B.filters)==null?void 0:Xe.status)||""}),Y=R(()=>{var s;return[{value:"",label:"All Regions"},...((s=B.regions)==null?void 0:s.map(t=>({value:t.id,label:t.name})))||[]]}),V=R(()=>[{value:"",label:"All Sticker Status"},{value:"with_stickers",label:"With Stickers"},{value:"missing_stickers",label:"Missing Stickers"}]),te=R(()=>{const s=new Map;return u.value==="assigned"&&c.value.data&&c.value.data.forEach(t=>{var p;const i=(p=t.driver_truck_assignment)==null?void 0:p.driver;i&&i.id&&s.set(i.id,{value:i.id,label:i.name,name:i.name,employee_id:i.employee_id||null})}),[{value:"",label:"All Drivers"},...Array.from(s.values())]}),de=R(()=>[{value:"all",label:"All Types"},{value:"regular",label:"Regular"},{value:"backhaul",label:"Backhaul"}]),ae=R(()=>{var s,t,i;return((s=B.flash)==null?void 0:s.success)||((t=B.flash)==null?void 0:t.error)||((i=B.flash)==null?void 0:i.warning)}),c=R(()=>B.deliveries||{data:[],meta:{}}),fe=R(()=>U.value.length>0&&U.value.every(s=>$e(s.id))),U=R(()=>c.value.data||[]),he=R(()=>Array.isArray(B.driverTruckSets)?B.driverTruckSets:[]),we=R(()=>Array.isArray(B.batchSuggestions)?B.batchSuggestions:[]),O=R(()=>we.value.filter(s=>{var t;return((t=s.delivery_requests)==null?void 0:t.every(i=>i.status==="ready"))??!1})),Me=R(()=>{const s=he.value;return!Array.isArray(s)||s.length===0?[]:s.map(t=>{const i=t.driver||{},p=t.truck||{};let S=i.initials||"";return!S&&i.name&&(S=be(i.name)),{...t,driver:{...i,name:i.name||"Driver",initials:S,delivery_orders_count:i.delivery_orders_count??i.current_assignments??0,current_assignments:i.current_assignments??i.delivery_orders_count??0,canAcceptNewAssignment:i.canAcceptNewAssignment??i.available??!1,available:i.available??!0},truck:{...p,volume_capacity:p.volume_capacity??0,weight_capacity:p.weight_capacity??0,license_plate:p.license_plate||"Truck",make:p.make||"",model:p.model||"",status:p.status||"unknown"},current_volume:t.current_volume??0,current_weight:t.current_weight??0,available_volume:t.available_volume??0,available_weight:t.available_weight??0,is_available:t.is_available??!0,available_for_backhaul:t.available_for_backhaul??!1,region:t.region??{name:"N/A"},current_region:t.current_region??{name:"N/A"},active_orders:t.active_orders??[]}}).filter(t=>X.value==="all"?!0:X.value==="backhaul"?t.available_for_backhaul:X.value==="regular"?!t.available_for_backhaul:!0)}),ct=R(()=>U.value.map(s=>{if(!s.driver_truck_assignment)return s;const t=he.value.find(i=>i.id===s.driver_truck_assignment.id);return t?{...s,driver_truck_assignment:{...s.driver_truck_assignment,has_finalized_manifest:t.has_finalized_manifest,manifest_status:t.manifest_status}}:s})),ue=R(()=>o.value.reduce((s,t)=>{var p;const i=((p=t.delivery_request)==null?void 0:p.packages)||[];return s+Ae(i)},0)),ce=R(()=>o.value.reduce((s,t)=>{var p;const i=((p=t.delivery_request)==null?void 0:p.packages)||[];return s+Se(i)},0)),Ne=R(()=>o.value.some(s=>pe(s))),Be=R(()=>{if(o.value.length===0)return!1;const s=o.value.some(i=>i.is_backhaul),t=o.value.some(i=>!i.is_backhaul);return s&&t}),mt=R(()=>o.value.some(s=>De(s))),K=R(()=>{var x,y;if(!v.value||o.value.length===0)return{isValid:!1,message:"Please select deliveries and a driver-truck set",details:[],availableVolume:0,availableWeight:0};const s=[],t=v.value.truck||{},i=v.value.current_volume||0,p=v.value.current_weight||0,S=(t.volume_capacity||0)-i,a=(t.weight_capacity||0)-p;ue.value>S&&s.push(`Insufficient volume capacity: ${G(ue.value)} selected vs ${G(S)} available`),ce.value>a&&s.push(`Insufficient weight capacity: ${J(ce.value)} selected vs ${J(a)} available`);const m=(x=v.value.region)==null?void 0:x.id,f=(y=v.value.current_region)==null?void 0:y.id,h=v.value.available_for_backhaul;o.value.forEach(w=>{var D,F,I,W,E,j,ne;const C=(F=(D=w.delivery_request)==null?void 0:D.pick_up_region)==null?void 0:F.id,A=(W=(I=w.delivery_request)==null?void 0:I.drop_off_region)==null?void 0:W.id;h?(C!==f&&s.push(`Backhaul: Pickup must be from current region (${(E=v.value.current_region)==null?void 0:E.name})`),A!==m&&s.push(`Backhaul: Delivery must be to home region (${(j=v.value.region)==null?void 0:j.name})`)):C!==m&&s.push(`Regular: Pickup must be from home region (${(ne=v.value.region)==null?void 0:ne.name})`)}),Be.value&&s.push("Cannot mix regular and backhaul assignments in the same batch"),Ne.value&&s.push("Some packages are missing stickers");const _=s.length===0;return{isValid:_,message:_?"Assignment is valid":"Assignment validation failed",details:s,availableVolume:S,availableWeight:a}});Re(u,(s,t)=>{s!==t&&Ce(s)});async function vt(){N.value=!0,ee.value=null;try{const s={...b,activeTab:u.value};await se.reload({data:s,preserveState:!0,preserveScroll:!0})}catch(s){ee.value=s.message||"Failed to load deliveries"}finally{N.value=!1}}async function Ce(s){if(!(s===u.value||q.value)){q.value=!0,u.value=s;try{const t={...b,activeTab:s};await se.visit(route("cargo-assignments.index"),{data:t,preserveState:!0,preserveScroll:!0,replace:!0,only:["deliveries","filters"],onFinish:()=>{q.value=!1}})}catch{ee.value="Failed to switch tabs",q.value=!1}}}async function ye(){oe.value=!0;try{await se.reload({only:["deliveries","driverTruckSets","batchSuggestions"],onSuccess:()=>{ee.value=null}})}catch{ee.value="Failed to refresh data"}finally{oe.value=!1}}function le(){const s={...b,activeTab:u.value};se.visit(route("cargo-assignments.index"),{data:s,preserveState:!0,preserveScroll:!0,replace:!0,only:["deliveries","filters"]})}let Te=null;function Fe(){clearTimeout(Te),Te=setTimeout(()=>{le()},500)}function gt(){b.search="",b.region_id="",b.driver_id="",b.sticker_status="",le()}function me(s){if(s>=1&&s<=c.value.meta.last_page){const t={...b,activeTab:u.value,page:s};Object.keys(t).forEach(i=>{(t[i]===""||t[i]===null||t[i]===void 0)&&delete t[i]}),se.visit(route("cargo-assignments.index"),{data:t,preserveState:!0,preserveScroll:!0,replace:!0})}}function pt(){if(fe.value)o.value=o.value.filter(s=>!U.value.some(t=>t.id===s.id));else{const s=U.value.filter(t=>!o.value.some(i=>i.id===t.id));o.value.push(...s)}}function _t(s){o.value.some(i=>i.id===s.id)?o.value=o.value.filter(i=>i.id!==s.id):o.value.push(s)}function $e(s){return o.value.some(t=>t.id===s)}function xt(s){o.value=o.value.filter(t=>t.id!==s)}function Ie(){o.value=[],v.value=null}function ft(s){v.value=s}function We(){K.value.isValid&&(k.value=!0)}function ht(){k.value=!1}function yt(){const s=o.value.map(i=>i.delivery_request_id||i.id),t=new Date(Date.now()+6e4);se.post(route("cargo-assignments.assign.batch"),{delivery_request_ids:s,driver_truck_assignment_id:v.value.id,estimated_departure:t.toISOString()},{onStart:()=>N.value=!0,onFinish:()=>{N.value=!1,k.value=!1,Ie()},onError:i=>{console.error("Batch assignment failed:",i),alert("Failed to assign deliveries. Please try again.")}})}function bt(s){ie.value=s,xe.value=!0}function Pe(){xe.value=!1,ie.value=null}function kt(){ye(),Pe()}function Le(s){return s.active_orders&&s.active_orders.length>0}function wt(s){return s.active_orders?s.active_orders.length:0}function Ct(s){var t;if((t=s.driver_truck_assignment)!=null&&t.has_finalized_manifest){alert("Cannot cancel assignment. Manifest has been finalized and this delivery is ready for dispatch.");return}T.value=s,H.value=""}function He(){T.value=null,H.value=""}async function At(){if(!(!T.value||!H.value.trim()))try{await se.post(route("cargo-assignments.deliveries.cancel",T.value.id),{reason:H.value},{onStart:()=>N.value=!0,onFinish:()=>{N.value=!1,T.value=null,H.value=""},onSuccess:()=>{ye()},onError:s=>{console.error("Failed to cancel delivery:",s),alert("Failed to cancel delivery assignment. Please try again.")}})}catch(s){console.error("Error cancelling delivery:",s),alert("An error occurred while cancelling the delivery.")}}function Ve(s){se.get(route("deliveries.show",s))}function St(){return{ready:"Search ready deliveries...",assigned:"Search assigned deliveries...",active:"Search active deliveries..."}[u.value]||"Search deliveries..."}function Dt(){return{ready:"ready for assignment",assigned:"assigned",active:"active"}[u.value]||""}function Mt(s){const t=B.regions.find(i=>i.id==(s||b.region_id));return(t==null?void 0:t.name)||"Selected Region"}function $t(s){if(!s)return"";const t=te.value.find(i=>i.value==s);return(t==null?void 0:t.name)||(t==null?void 0:t.label)||"Selected Driver"}function Vt(s){return{with_stickers:"With Stickers",missing_stickers:"Missing Stickers"}[s]||s}function jt(s){return{ready:"Ready",assigned:"Assigned",dispatched:"Dispatched",in_transit:"In Transit"}[s]||s}function zt(s){return{ready:"success",assigned:"info",dispatched:"primary",in_transit:"secondary"}[s]||"secondary"}function be(s){return s?s.split(" ").map(t=>t[0]).join("").toUpperCase().substring(0,2):"??"}function ve(s){if(!s.truck||!s.truck.volume_capacity)return 0;const t=s.current_volume||0;return Math.round(t/s.truck.volume_capacity*100)}function ge(s){if(!s.truck||!s.truck.weight_capacity)return 0;const t=s.current_weight||0;return Math.round(t/s.truck.weight_capacity*100)}function qt(s){if(!s)return"bg-gray-100 text-gray-800";const t=Ee(s);return t>=90?"bg-red-100 text-red-800":t>=75?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}function Ee(s){if(!s||!s.truck)return 0;const t=s.truck.volume_capacity>0?Math.round(s.current_volume/s.truck.volume_capacity*100):0,i=s.truck.weight_capacity>0?Math.round(s.current_weight/s.truck.weight_capacity*100):0;return Math.max(t,i)}function Rt(s){return s?new Date(s).toLocaleDateString():"N/A"}function je(s){return s?new Date(s).toLocaleString():"N/A"}const G=s=>{const t=Number(s||0);return t<.001?`${(t*1e6).toFixed(0)} cm³`:t<.01?`${t.toFixed(6)} m³`:`${t.toFixed(2)} m³`},J=s=>{const t=Number(s)||0;return t===0?"0 kg":t<1?`${(t*1e3).toFixed(0)} g`:`${t.toFixed(1)} kg`},Ae=s=>!s||!Array.isArray(s)?0:s.reduce((t,i)=>{if(i.height&&i.width&&i.length){const p=parseFloat(i.height)||0,S=parseFloat(i.width)||0,a=parseFloat(i.length)||0,m=p*S*a/1e6;return t+m}return t+(Number(i.volume)||0)},0);function Se(s){return!s||!Array.isArray(s)?0:s.reduce((t,i)=>t+(Number(i.weight)||0),0)}const pe=s=>{var i;return(((i=s.delivery_request)==null?void 0:i.packages)||[]).some(p=>!p.sticker_printed_at)},De=s=>{var m,f,h,_,x,y;if(!v.value)return!1;const t=(m=v.value.region)==null?void 0:m.id,i=(f=v.value.current_region)==null?void 0:f.id,p=v.value.available_for_backhaul,S=(_=(h=s.delivery_request)==null?void 0:h.pick_up_region)==null?void 0:_.id,a=(y=(x=s.delivery_request)==null?void 0:x.drop_off_region)==null?void 0:y.id;return p?S!==i||a!==t:S!==t};function Nt(s){if(!s||!s.delivery_requests)return;o.value=s.delivery_requests||[];const t=ze(s);t.length>0&&(v.value=t[0]),We()}function ze(s){const t=Me.value;return!Array.isArray(t)||t.length===0?[]:t.filter(i=>{var w,C,A,D;const p=((w=i.region)==null?void 0:w.id)===((C=s.pickup_region)==null?void 0:C.id)||i.available_for_backhaul&&((A=i.current_region)==null?void 0:A.id)===((D=s.pickup_region)==null?void 0:D.id),S=i.truck||{},a=i.current_volume||0,m=i.current_weight||0,f=(S.volume_capacity||0)-a,h=(S.weight_capacity||0)-m,_=Number(s.total_volume)||0,x=Number(s.total_weight)||0,y=f>=_&&h>=x;return i.is_available&&p&&y})}function Bt(s){var p,S,a;const t=(p=s.pickup_region)==null?void 0:p.id,i=(S=s.destination_region)==null?void 0:S.id;return((a=s.delivery_requests)==null?void 0:a.every(m=>{var _,x,y,w;const f=(x=(_=m.delivery_request)==null?void 0:_.pick_up_region)==null?void 0:x.id,h=(w=(y=m.delivery_request)==null?void 0:y.drop_off_region)==null?void 0:w.id;return f===i&&h===t}))||!1}function Tt(s){X.value=s}function Ue(s){if(s.has_finalized_manifest||!s.is_available)return!1;const t=s.truck||{},i=s.current_volume||0,p=s.current_weight||0,S=(t.volume_capacity||0)-i,a=(t.weight_capacity||0)-p;return S>=ue.value&&a>=ce.value}return dt(()=>{setInterval(()=>{u.value==="active"&&ye()},3e4)}),(s,t)=>(l(),_e(Lt,null,{header:z(()=>[e("div",ws,[t[16]||(t[16]=e("div",null,[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Cargo Assignment Dashboard "),e("p",{class:"text-sm text-gray-600 mt-1"}," Manage delivery assignments and track active deliveries ")],-1)),e("div",Cs,[M(ot,{modelValue:b.search,"onUpdate:modelValue":t[0]||(t[0]=i=>b.search=i),placeholder:"Search deliveries...",onKeyup:rt(le,["enter"]),onInput:Fe,class:"w-full md:w-64"},null,8,["modelValue"]),M(re,{onClick:ye,loading:oe.value},{default:z(()=>t[15]||(t[15]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),g(" Refresh ")])),_:1},8,["loading"])])])]),default:z(()=>{var i,p,S;return[ae.value?(l(),n("div",As,[M(Ht,{flash:Q.flash},null,8,["flash"])])):d("",!0),e("div",Ss,[N.value?(l(),n("div",Ds,t[17]||(t[17]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)]))):ee.value?(l(),n("div",Ms,[t[19]||(t[19]=e("svg",{class:"mx-auto h-12 w-12 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),t[20]||(t[20]=e("h3",{class:"mt-2 text-sm font-medium text-red-800"},"Failed to load deliveries",-1)),e("p",$s,r(ee.value),1),M(ke,{onClick:vt,class:"mt-4"},{default:z(()=>t[18]||(t[18]=[g(" Try Again ")])),_:1})])):(l(),n(P,{key:2},[e("div",Vs,[e("div",js,[e("nav",zs,[e("button",{onClick:t[1]||(t[1]=a=>Ce("ready")),class:$(["py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200",u.value==="ready"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"]),disabled:q.value}," Assignment ",10,qs),e("button",{onClick:t[2]||(t[2]=a=>Ce("assigned")),class:$(["py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200",u.value==="assigned"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"]),disabled:q.value}," Assigned ",10,Rs),e("button",{onClick:t[3]||(t[3]=a=>Ce("active")),class:$(["py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200",u.value==="active"?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"]),disabled:q.value}," Active Deliveries ",10,Ns)])]),e("div",Bs,[e("div",Ts,[e("div",Fs,[M(ot,{modelValue:b.search,"onUpdate:modelValue":t[4]||(t[4]=a=>b.search=a),placeholder:St(),onKeyup:rt(le,["enter"]),onInput:Fe,class:"w-full",disabled:q.value},null,8,["modelValue","placeholder","disabled"])]),e("div",Is,[M(re,{onClick:ye,loading:oe.value,disabled:q.value},{default:z(()=>t[21]||(t[21]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),g(" Refresh ")])),_:1},8,["loading","disabled"]),M(re,{onClick:gt,disabled:q.value},{default:z(()=>t[22]||(t[22]=[g(" Reset ")])),_:1},8,["disabled"])])]),e("div",Ws,[M(qe,{modelValue:b.region_id,"onUpdate:modelValue":t[5]||(t[5]=a=>b.region_id=a),options:Y.value,placeholder:"Filter by Region",onChange:le,disabled:q.value},null,8,["modelValue","options","disabled"]),u.value==="ready"?(l(),_e(qe,{key:0,modelValue:b.sticker_status,"onUpdate:modelValue":t[6]||(t[6]=a=>b.sticker_status=a),options:V.value,placeholder:"Sticker Status",onChange:le,disabled:q.value},null,8,["modelValue","options","disabled"])):d("",!0),u.value==="assigned"?(l(),_e(qe,{key:1,modelValue:b.driver_id,"onUpdate:modelValue":t[7]||(t[7]=a=>b.driver_id=a),options:te.value,placeholder:"Filter by Driver",onChange:le,disabled:q.value},null,8,["modelValue","options","disabled"])):d("",!0)]),e("div",Ps,[e("div",Ls,[g(" Showing "+r(((i=c.value.meta)==null?void 0:i.from)||0)+" to "+r(((p=c.value.meta)==null?void 0:p.to)||0)+" of "+r(((S=c.value.meta)==null?void 0:S.total)||0)+" deliveries ",1),b.region_id?(l(),n("span",Hs," in "+r(Mt(b.region_id)),1)):d("",!0),b.sticker_status&&u.value==="ready"?(l(),n("span",Es," • "+r(Vt(b.sticker_status)),1)):d("",!0),b.driver_id&&u.value==="assigned"?(l(),n("span",Us," • Driver: "+r($t(b.driver_id)),1)):d("",!0)]),u.value==="ready"?(l(),n("div",Os,t[23]||(t[23]=[e("span",{class:"flex items-center"},[e("div",{class:"w-2 h-2 bg-yellow-500 rounded-full mr-1"}),g(" Missing Stickers ")],-1)]))):d("",!0)])])]),q.value?(l(),n("div",Ks,[t[24]||(t[24]=e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)),e("span",Gs,"Loading "+r(Dt())+" deliveries...",1)])):u.value==="ready"&&O.value.length>0?(l(),n("div",Js,[e("div",Qs,[t[25]||(t[25]=e("h3",{class:"text-lg font-medium text-blue-800 mb-3"},"Batch Assignment Suggestions",-1)),e("div",Xs,[(l(!0),n(P,null,Z(O.value,a=>{var m,f,h,_,x;return l(),n("div",{key:((m=a.destination_region)==null?void 0:m.id)||((f=a.pickup_region)==null?void 0:f.id),class:"bg-white border border-blue-200 rounded-lg p-4 hover:shadow-md transition-shadow"},[e("div",Ys,[e("div",null,[e("p",Zs,r(((h=a.pickup_region)==null?void 0:h.name)??"N/A")+" → "+r(((_=a.destination_region)==null?void 0:_.name)??"N/A"),1),e("p",ea,r(((x=a.delivery_requests)==null?void 0:x.length)??0)+" deliveries",1)]),Bt(a)?(l(),n("span",ta," Backhaul ")):d("",!0)]),e("div",sa,[e("p",null,"Volume: "+r(G(a.total_volume||0)),1),e("p",null,"Weight: "+r(J(a.total_weight||0)),1)]),s.hasUnstickerizedPackagesInSuggestion(a)?(l(),n("div",aa," ⚠️ Some packages are missing stickers ")):d("",!0),M(ke,{onClick:y=>Nt(a),size:"xs",class:"w-full",disabled:!ze(a).length||s.hasUnstickerizedPackagesInSuggestion(a)},{default:z(()=>[g(" Assign Batch ("+r(ze(a).length)+" sets available) ",1)]),_:2},1032,["onClick","disabled"])])}),128))])])])):d("",!0),q.value?d("",!0):(l(),n(P,{key:2},[u.value==="ready"?(l(),n("div",ra,[e("div",ia,[e("div",la,[e("table",na,[e("thead",oa,[e("tr",null,[e("th",da,[e("input",{type:"checkbox",checked:fe.value,onChange:pt,class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,40,ua)]),t[26]||(t[26]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Reference #",-1)),t[27]||(t[27]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Route",-1)),t[28]||(t[28]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Packages",-1)),t[29]||(t[29]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Volume",-1)),t[30]||(t[30]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Weight",-1)),t[31]||(t[31]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status",-1)),t[32]||(t[32]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Created",-1)),t[33]||(t[33]=e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions",-1))])]),e("tbody",ca,[(l(!0),n(P,null,Z(U.value,a=>{var m,f,h,_,x,y,w,C,A;return l(),n("tr",{key:a.id,class:$(["hover:bg-gray-50",{"bg-blue-50":$e(a.id),"bg-yellow-50":pe(a)}])},[e("td",ma,[e("input",{type:"checkbox",checked:$e(a.id),onChange:D=>_t(a),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,40,va)]),e("td",ga,[e("div",pa,[t[34]||(t[34]=e("span",{class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-green-100 text-green-800"}," Ref ",-1)),e("span",_a,r(((m=a.delivery_request)==null?void 0:m.reference_number)||`DR-${String(a.delivery_request_id||"").padStart(6,"0")}`),1)]),e("div",xa," ID: DO-"+r(String(a.delivery_request_id||"").padStart(6,"0")),1),pe(a)?(l(),n("div",fa,t[35]||(t[35]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1),g(" Missing Stickers ")]))):d("",!0)]),e("td",ha,[e("div",ya,r(((h=(f=a.delivery_request)==null?void 0:f.pick_up_region)==null?void 0:h.name)??"N/A"),1),e("div",ba,"→ "+r(((x=(_=a.delivery_request)==null?void 0:_.drop_off_region)==null?void 0:x.name)??"N/A"),1)]),e("td",ka,r(((w=(y=a.delivery_request)==null?void 0:y.packages)==null?void 0:w.length)||0),1),e("td",wa,r(G(Ae(((C=a.delivery_request)==null?void 0:C.packages)||[]))),1),e("td",Ca,r(J(Se(((A=a.delivery_request)==null?void 0:A.packages)||[]))),1),e("td",Aa,[M(Ot,{status:a.status,variant:zt(a.status)},{default:z(()=>[g(r(jt(a.status)),1)]),_:2},1032,["status","variant"])]),e("td",Sa,r(Rt(a.created_at)),1),e("td",Da,[M(re,{onClick:D=>Ve(a.delivery_request_id),size:"xs"},{default:z(()=>t[36]||(t[36]=[g(" Details ")])),_:2},1032,["onClick"])])],2)}),128))])])]),U.value.length===0?(l(),n("div",Ma,t[37]||(t[37]=[e("div",{class:"text-gray-400 mb-4"},[e("svg",{class:"h-12 w-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1),e("p",{class:"text-gray-500"},"No deliveries ready for assignment",-1)]))):d("",!0),c.value.meta&&c.value.meta.last_page>1?(l(),n("div",$a,[e("div",Va,[e("div",ja," Page "+r(c.value.meta.current_page)+" of "+r(c.value.meta.last_page),1),e("div",za,[e("button",{onClick:t[8]||(t[8]=a=>me(c.value.meta.current_page-1)),disabled:c.value.meta.current_page<=1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,qa),e("button",{onClick:t[9]||(t[9]=a=>me(c.value.meta.current_page+1)),disabled:c.value.meta.current_page>=c.value.meta.last_page,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,Ra)])])])):d("",!0)])])):u.value==="assigned"?(l(),n("div",Na,[e("div",Ba,[e("div",Ta,[e("table",Fa,[t[45]||(t[45]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Reference #"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Route"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Assigned To"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Truck"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Manifest Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Assigned At"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Ia,[(l(!0),n(P,null,Z(ct.value,a=>{var m,f,h,_,x,y,w,C,A,D,F,I,W,E,j;return l(),n("tr",{key:a.id,class:$(["hover:bg-gray-50",{"bg-blue-50":(m=a.driver_truck_assignment)==null?void 0:m.has_finalized_manifest}])},[e("td",Wa,[e("div",Pa,[t[38]||(t[38]=e("span",{class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-green-100 text-green-800"}," Ref ",-1)),e("span",La,r(((f=a.delivery_request)==null?void 0:f.reference_number)||`DR-${String(a.delivery_request_id||"").padStart(6,"0")}`),1)]),e("div",Ha," ID: DO-"+r(String(a.id||"").padStart(6,"0")),1)]),e("td",Ea,[e("div",Ua,r(((_=(h=a.delivery_request)==null?void 0:h.pick_up_region)==null?void 0:_.name)??"N/A"),1),e("div",Oa,"→ "+r(((y=(x=a.delivery_request)==null?void 0:x.drop_off_region)==null?void 0:y.name)??"N/A"),1)]),e("td",Ka,[e("div",Ga,[(w=a.driver_truck_assignment)!=null&&w.driver?(l(),n("div",Ja,[e("span",Qa,r(be(a.driver_truck_assignment.driver.name)),1)])):(l(),n("div",Xa,t[39]||(t[39]=[e("span",{class:"text-gray-400 font-medium text-xs"},"??",-1)]))),e("div",Ya,[e("div",Za,r(((A=(C=a.driver_truck_assignment)==null?void 0:C.driver)==null?void 0:A.name)??"N/A"),1)])])]),e("td",er,[e("div",null,r(((F=(D=a.driver_truck_assignment)==null?void 0:D.truck)==null?void 0:F.license_plate)??"N/A"),1),e("div",tr,r((I=a.driver_truck_assignment)!=null&&I.truck?`${a.driver_truck_assignment.truck.make} ${a.driver_truck_assignment.truck.model}`:"N/A"),1)]),e("td",sr,[(W=a.driver_truck_assignment)!=null&&W.has_finalized_manifest?(l(),n("span",ar,t[40]||(t[40]=[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})],-1),g(" Finalized ")]))):(l(),n("span",rr,t[41]||(t[41]=[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})],-1),g(" Not Finalized ")])))]),e("td",ir,r((E=a.driver_truck_assignment)!=null&&E.assigned_at?je(a.driver_truck_assignment.assigned_at):"N/A"),1),e("td",lr,[e("div",nr,[M(re,{onClick:ne=>Ve(a.delivery_request_id),size:"xs"},{default:z(()=>t[42]||(t[42]=[g(" Details ")])),_:2},1032,["onClick"]),(j=a.driver_truck_assignment)!=null&&j.has_finalized_manifest?(l(),n("span",or,t[44]||(t[44]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-3 h-3 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"})],-1),g(" Locked ")]))):(l(),_e(nt,{key:0,onClick:ne=>Ct(a),size:"xs",title:"Cancel Assignment"},{default:z(()=>t[43]||(t[43]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-3 h-3",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)])),_:2},1032,["onClick"]))])])],2)}),128))])])]),U.value.length===0?(l(),n("div",dr,t[46]||(t[46]=[e("div",{class:"text-gray-400 mb-4"},[e("svg",{class:"h-12 w-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1),e("p",{class:"text-gray-500"},"No assigned deliveries found",-1)]))):d("",!0),c.value.meta&&c.value.meta.last_page>1?(l(),n("div",ur,[e("div",cr,[e("div",mr," Page "+r(c.value.meta.current_page)+" of "+r(c.value.meta.last_page),1),e("div",vr,[e("button",{onClick:t[10]||(t[10]=a=>me(c.value.meta.current_page-1)),disabled:c.value.meta.current_page<=1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,gr),e("button",{onClick:t[11]||(t[11]=a=>me(c.value.meta.current_page+1)),disabled:c.value.meta.current_page>=c.value.meta.last_page,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,pr)])])])):d("",!0)])])):u.value==="active"?(l(),n("div",_r,[e("div",xr,[e("div",fr,[e("table",hr,[t[49]||(t[49]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Reference #"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Route"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Driver"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Truck"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Dispatched"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Est. Arrival"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",yr,[(l(!0),n(P,null,Z(U.value,a=>{var m,f,h,_,x,y,w,C,A,D,F,I,W,E;return l(),n("tr",{key:a.id,class:"hover:bg-gray-50"},[e("td",br,[e("div",kr,[t[47]||(t[47]=e("span",{class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-green-100 text-green-800"}," Ref ",-1)),e("span",wr,r(((m=a.delivery_request)==null?void 0:m.reference_number)||`DR-${String(a.delivery_request_id||"").padStart(6,"0")}`),1)]),e("div",Cr," ID: DO-"+r(String(a.delivery_request_id||"").padStart(6,"0")),1)]),e("td",Ar,[e("div",Sr,r(((h=(f=a.delivery_request)==null?void 0:f.pick_up_region)==null?void 0:h.name)??"N/A"),1),e("div",Dr,"→ "+r(((x=(_=a.delivery_request)==null?void 0:_.drop_off_region)==null?void 0:x.name)??"N/A"),1)]),e("td",Mr,[e("div",$r,[e("div",Vr,[e("span",jr,r(be((w=(y=a.driver_truck_assignment)==null?void 0:y.driver)==null?void 0:w.name)),1)]),e("div",zr,[e("div",qr,r(((A=(C=a.driver_truck_assignment)==null?void 0:C.driver)==null?void 0:A.name)??"N/A"),1),e("div",Rr,r(((F=(D=a.driver_truck_assignment)==null?void 0:D.driver)==null?void 0:F.employee_id)??"N/A"),1)])])]),e("td",Nr,[e("div",null,r(((W=(I=a.driver_truck_assignment)==null?void 0:I.truck)==null?void 0:W.license_plate)??"N/A"),1),e("div",Br,r((E=a.driver_truck_assignment)!=null&&E.truck?`${a.driver_truck_assignment.truck.make} ${a.driver_truck_assignment.truck.model}`:""),1)]),e("td",Tr,r(je(a.dispatched_at)),1),e("td",Fr,r(je(a.estimated_arrival)),1),e("td",Ir,[M(re,{onClick:j=>Ve(a.delivery_request_id),size:"xs"},{default:z(()=>t[48]||(t[48]=[g(" Track ")])),_:2},1032,["onClick"])])])}),128))])])]),U.value.length===0?(l(),n("div",Wr,t[50]||(t[50]=[e("div",{class:"text-gray-400 mb-4"},[e("svg",{class:"h-12 w-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1),e("p",{class:"text-gray-500"},"No active deliveries found",-1)]))):d("",!0),c.value.meta&&c.value.meta.last_page>1?(l(),n("div",Pr,[e("div",Lr,[e("div",Hr," Page "+r(c.value.meta.current_page)+" of "+r(c.value.meta.last_page),1),e("div",Er,[e("button",{onClick:t[12]||(t[12]=a=>me(c.value.meta.current_page-1)),disabled:c.value.meta.current_page<=1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,Ur),e("button",{onClick:t[13]||(t[13]=a=>me(c.value.meta.current_page+1)),disabled:c.value.meta.current_page>=c.value.meta.last_page,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,Or)])])])):d("",!0)])])):d("",!0)],64)),e("div",Kr,[e("div",Gr,[e("div",Jr,[e("div",Qr,[e("div",Xr,[e("h3",Yr," Selected Deliveries ("+r(o.value.length)+") ",1),o.value.length>0?(l(),n("button",{key:0,onClick:Ie,class:"text-sm text-red-500 hover:text-red-700"}," Clear All ")):d("",!0)]),e("div",Zr,[o.value.length>0?(l(!0),n(P,{key:0},Z(o.value,a=>{var m,f,h,_,x,y,w,C,A;return l(),n("div",{key:a.id,class:$(["p-3 border border-gray-200 rounded-lg hover:bg-gray-50",{"bg-yellow-50 border-yellow-200":pe(a),"bg-red-50 border-red-200":De(a)}])},[e("div",ei,[e("div",ti,[e("div",si,[t[51]||(t[51]=e("span",{class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-green-100 text-green-800"}," Ref ",-1)),e("span",ai,r(((m=a.delivery_request)==null?void 0:m.reference_number)||`DR-${(h=(f=a.delivery_request_id)==null?void 0:f.toString())==null?void 0:h.padStart(6,"0")}`),1)]),e("p",ri,r((x=(_=a.delivery_request)==null?void 0:_.pick_up_region)==null?void 0:x.name)+" → "+r((w=(y=a.delivery_request)==null?void 0:y.drop_off_region)==null?void 0:w.name),1),e("div",ii,[e("p",null,"Vol: "+r(G(Ae(((C=a.delivery_request)==null?void 0:C.packages)||[]))),1),e("p",null,"Wt: "+r(J(Se(((A=a.delivery_request)==null?void 0:A.packages)||[]))),1)]),pe(a)?(l(),n("div",li," ⚠️ Missing Stickers ")):d("",!0),De(a)?(l(),n("div",ni," ⚠️ Region Mismatch ")):d("",!0)]),e("button",{onClick:D=>xt(a.id),class:"text-red-500 hover:text-red-700 ml-2"},t[52]||(t[52]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,oi)])],2)}),128)):(l(),n("div",di,t[53]||(t[53]=[e("svg",{class:"h-8 w-8 mx-auto mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("p",{class:"text-sm"},"No deliveries selected",-1)])))]),o.value.length>0?(l(),n("div",ui,[e("div",ci,[t[54]||(t[54]=e("p",null,[e("strong",null,"Total Selected:")],-1)),e("p",null,"Volume: "+r(G(ue.value)),1),e("p",null,"Weight: "+r(J(ce.value)),1),Ne.value?(l(),n("div",mi," ⚠️ Some packages are missing stickers ")):d("",!0),Be.value?(l(),n("div",vi," ⚠️ Mixed assignment types (Regular + Backhaul) ")):d("",!0),mt.value?(l(),n("div",gi," ⚠️ Region mismatch in assignments ")):d("",!0)])])):d("",!0)])]),e("div",pi,[e("div",_i,[e("div",xi,[t[55]||(t[55]=e("h3",{class:"text-lg font-medium text-gray-900"}," Available Driver-Truck Sets ",-1)),e("div",fi,[(l(!0),n(P,null,Z(de.value,a=>(l(),n("button",{key:a.value,onClick:m=>Tt(a.value),class:$(["px-3 py-1 text-xs rounded border",X.value===a.value?"bg-blue-100 text-blue-800 border-blue-300":"bg-gray-100 text-gray-600 border-gray-300"])},r(a.label),11,hi))),128))])]),e("div",yi,[(l(!0),n(P,null,Z(Me.value,a=>{var m,f,h,_,x,y,w,C,A,D,F,I;return l(),n("div",{key:a.id,class:$(["border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",((m=v.value)==null?void 0:m.id)===a.id?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 bg-white"]),onClick:W=>ft(a)},[e("div",ki,[e("div",wi,[e("div",{class:$(["flex-shrink-0 h-10 w-10 rounded-full flex items-center justify-center",a.available_for_backhaul?"bg-purple-100":"bg-gray-100"])},[e("span",{class:$(["text-sm font-medium",a.available_for_backhaul?"text-purple-800":"text-gray-600"])},r(((f=a.driver)==null?void 0:f.initials)||be((h=a.driver)==null?void 0:h.name)),3)],2),e("div",Ci,[e("div",Ai,r(((_=a.driver)==null?void 0:_.name)||"Driver"),1),a.has_finalized_manifest?(l(),n("div",Si,t[56]||(t[56]=[e("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 border border-blue-300"},[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})]),g(" Manifest Finalized ")],-1)]))):Le(a)?(l(),n("div",Di,[e("span",Mi,[t[57]||(t[57]=e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)),g(" "+r(wt(a))+" assigned ",1)])])):d("",!0)])]),e("div",$i,[a.available_for_backhaul?(l(),n("span",Vi," Backhaul ")):d("",!0),Le(a)?(l(),_e(ke,{key:1,onClick:it(W=>bt(a),["stop"]),size:"xs",class:"mt-1"},{default:z(()=>t[58]||(t[58]=[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1),g(" Dispatch ")])),_:2},1032,["onClick"])):d("",!0)])]),e("div",ji,[e("div",zi,r(((x=a.truck)==null?void 0:x.license_plate)||"Truck"),1),e("div",qi,r((y=a.truck)==null?void 0:y.make)+" "+r((w=a.truck)==null?void 0:w.model),1)]),e("div",Ri,[e("div",null,[t[59]||(t[59]=e("div",{class:"text-gray-500 text-xs"},"Home Region",-1)),e("div",Ni,r(((C=a.region)==null?void 0:C.name)||"N/A"),1)]),e("div",null,[t[60]||(t[60]=e("div",{class:"text-gray-500 text-xs"},"Current Region",-1)),e("div",{class:$(a.available_for_backhaul?"text-purple-600 font-medium":"font-medium")},r(((A=a.current_region)==null?void 0:A.name)||((D=a.region)==null?void 0:D.name)||"N/A"),3)])]),e("div",Bi,[e("div",null,[e("div",Ti,[t[61]||(t[61]=e("span",null,"Volume Capacity",-1)),e("span",null,r(ve(a))+"%",1)]),e("div",Fi,[e("div",{class:$(["h-2 rounded-full",{"bg-green-500":ve(a)<=60,"bg-yellow-500":ve(a)>60&&ve(a)<=85,"bg-red-500":ve(a)>85}]),style:lt({width:`${ve(a)}%`})},null,6)]),e("div",Ii,r(G(a.current_volume||0))+" / "+r(G(((F=a.truck)==null?void 0:F.volume_capacity)||0)),1)]),e("div",null,[e("div",Wi,[t[62]||(t[62]=e("span",null,"Weight Capacity",-1)),e("span",null,r(ge(a))+"%",1)]),e("div",Pi,[e("div",{class:$(["h-2 rounded-full",{"bg-green-500":ge(a)<=60,"bg-yellow-500":ge(a)>60&&ge(a)<=85,"bg-red-500":ge(a)>85}]),style:lt({width:`${ge(a)}%`})},null,6)]),e("div",Li,r(J(a.current_weight||0))+" / "+r(J(((I=a.truck)==null?void 0:I.weight_capacity)||0)),1)])]),e("div",Hi,[e("div",null,"Available Volume: "+r(G(a.available_volume||0)),1),e("div",null,"Available Weight: "+r(J(a.available_weight||0)),1)]),M(ke,{onClick:it(W=>We(a),["stop"]),class:"w-full",disabled:!Ue(a)||o.value.length===0||a.has_finalized_manifest},{default:z(()=>[a.has_finalized_manifest?(l(),n(P,{key:0},[t[63]||(t[63]=e("svg",{class:"w-4 h-4 mr-1 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})],-1)),t[64]||(t[64]=g(" Manifest Finalized - Cannot Assign "))],64)):!Ue(a)&&o.value.length>0?(l(),n(P,{key:1},[g(" Cannot Assign - Capacity Issues ")],64)):o.value.length===0?(l(),n(P,{key:2},[g(" Assign Selected (0) ")],64)):(l(),n(P,{key:3},[g(" Assign Selected ("+r(o.value.length)+") ",1)],64))]),_:2},1032,["onClick","disabled"]),a.has_finalized_manifest?(l(),n("div",Ei,t[65]||(t[65]=[e("p",{class:"text-xs text-blue-600"},"Ready for dispatch",-1)]))):d("",!0)],10,bi)}),128))]),Me.value.length===0?(l(),n("div",Ui,[e("div",Oi,[M(It(Kt),{class:"h-12 w-12 mx-auto"})]),t[66]||(t[66]=e("p",{class:"text-gray-500"},"No available driver-truck sets found",-1))])):d("",!0)])])])])],64))]),M(Et,{show:k.value,onClose:ht,onConfirmed:yt,title:"Confirm Batch Assignment","confirm-text":"Assign Deliveries","confirm-disabled":!K.value.isValid,variant:"primary",size:"lg"},{default:z(()=>{var a,m,f,h,_,x,y,w,C,A,D,F,I,W,E;return[e("div",Ki,[e("div",{class:$(["p-3 rounded-lg border",{"border-green-200 bg-green-50 text-green-800":K.value.isValid,"border-red-200 bg-red-50 text-red-800":!K.value.isValid}])},[e("div",Gi,[e("div",Ji,[K.value.isValid?(l(),n("svg",Qi,t[67]||(t[67]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))):(l(),n("svg",Xi,t[68]||(t[68]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"},null,-1)])))]),e("div",Yi,[e("p",Zi,r(K.value.message),1),K.value.details&&K.value.details.length>0?(l(),n("ul",el,[(l(!0),n(P,null,Z(K.value.details,j=>(l(),n("li",{key:j,class:"flex items-start"},[t[69]||(t[69]=e("span",{class:"mr-2"},"•",-1)),e("span",null,r(j),1)]))),128))])):d("",!0)])])],2),e("div",tl,[e("div",sl,[t[75]||(t[75]=e("h3",{class:"text-sm font-medium text-gray-900 mb-2 flex items-center"},[e("svg",{class:"h-4 w-4 mr-1.5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})]),g(" Capacity Check ")],-1)),e("div",al,[e("div",rl,[t[70]||(t[70]=e("span",{class:"text-gray-600"},"Volume:",-1)),e("span",il,r(G(ue.value)),1)]),e("div",ll,[t[71]||(t[71]=e("span",{class:"text-gray-600"},"Available:",-1)),e("span",{class:$(ue.value>K.value.availableVolume?"text-red-600":"text-green-600")},r(G(K.value.availableVolume||0)),3)]),t[74]||(t[74]=e("div",{class:"border-t pt-2 mt-2"},null,-1)),e("div",nl,[t[72]||(t[72]=e("span",{class:"text-gray-600"},"Weight:",-1)),e("span",ol,r(J(ce.value)),1)]),e("div",dl,[t[73]||(t[73]=e("span",{class:"text-gray-600"},"Available:",-1)),e("span",{class:$(ce.value>K.value.availableWeight?"text-red-600":"text-green-600")},r(J(K.value.availableWeight||0)),3)])])]),e("div",ul,[t[76]||(t[76]=e("h3",{class:"text-sm font-medium text-gray-900 mb-2 flex items-center"},[e("svg",{class:"h-4 w-4 mr-1.5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})]),g(" Driver-Truck Set ")],-1)),e("div",cl,[e("div",{class:$(["flex-shrink-0 h-10 w-10 rounded-full flex items-center justify-center",(a=v.value)!=null&&a.available_for_backhaul?"bg-purple-100":"bg-gray-100"])},[e("span",{class:$(["text-sm font-medium",(m=v.value)!=null&&m.available_for_backhaul?"text-purple-800":"text-gray-600"])},r(((h=(f=v.value)==null?void 0:f.driver)==null?void 0:h.initials)||be((x=(_=v.value)==null?void 0:_.driver)==null?void 0:x.name)),3)],2),e("div",ml,[e("p",vl,r(((w=(y=v.value)==null?void 0:y.driver)==null?void 0:w.name)??"N/A"),1),e("p",gl,r(((A=(C=v.value)==null?void 0:C.truck)==null?void 0:A.license_plate)??"N/A"),1),e("div",pl,[e("span",_l,r((F=(D=v.value)==null?void 0:D.truck)==null?void 0:F.make)+" "+r((W=(I=v.value)==null?void 0:I.truck)==null?void 0:W.model),1),(E=v.value)!=null&&E.available_for_backhaul?(l(),n("span",xl," Backhaul ")):d("",!0)]),e("div",fl,[e("span",{class:$(["text-xs px-1.5 py-0.5 rounded",qt(v.value)])},r(Ee(v.value))+"% capacity ",3)])])])])]),e("div",hl,[e("div",yl,[e("h3",bl,[t[77]||(t[77]=e("svg",{class:"h-4 w-4 mr-1.5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),g(" Selected Deliveries ("+r(o.value.length)+") ",1)])]),e("div",kl,[(l(!0),n(P,null,Z(o.value,j=>{var ne,Ye,Ze,et,tt,st,at;return l(),n("div",{key:j.id,class:"px-3 py-2 border-b last:border-b-0 hover:bg-gray-50"},[e("div",wl,[e("div",Cl,[e("div",Al,[t[78]||(t[78]=e("span",{class:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-semibold bg-green-100 text-green-800"}," Ref ",-1)),e("span",Sl,r(((ne=j.delivery_request)==null?void 0:ne.reference_number)||`DR-${String(j.delivery_request_id||"").padStart(6,"0")}`),1)]),e("p",Dl,r(((Ze=(Ye=j.delivery_request)==null?void 0:Ye.pick_up_region)==null?void 0:Ze.name)??"N/A")+" → "+r(((tt=(et=j.delivery_request)==null?void 0:et.drop_region)==null?void 0:tt.name)??"N/A"),1),e("div",Ml,[e("span",null,"Vol: "+r(G(Ae(((st=j.delivery_request)==null?void 0:st.packages)||[]))),1),e("span",null,"Wt: "+r(J(Se(((at=j.delivery_request)==null?void 0:at.packages)||[]))),1)])]),e("div",$l,[pe(j)?(l(),n("span",Vl," ⚠️ ")):d("",!0),De(j)?(l(),n("span",jl," ❌ ")):d("",!0)])])])}),128))])]),t[79]||(t[79]=e("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-3"},[e("h3",{class:"text-sm font-medium text-blue-900 mb-2 flex items-center"},[e("svg",{class:"h-4 w-4 mr-1.5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),g(" Estimated Timeline ")]),e("div",{class:"text-xs text-blue-700 space-y-1"},[e("p",null,"• Departure: Within 1 hour of assignment"),e("p",null,"• Estimated arrival: Calculated based on route distance"),e("p",null,"• Delivery completion: Within 24-48 hours")])],-1))])]}),_:1},8,["show","confirm-disabled"]),M(ut,{show:!!T.value,onClose:He,"max-width":"md"},{default:z(()=>{var a,m,f,h,_,x,y,w,C,A,D,F,I,W,E;return[e("div",zl,[t[90]||(t[90]=e("h2",{class:"text-lg font-medium text-gray-900"},"Cancel Delivery Assignment",-1)),t[91]||(t[91]=e("p",{class:"mt-1 text-sm text-gray-600"}," Are you sure you want to cancel this delivery assignment? ",-1)),e("div",ql,[e("div",Rl,[t[85]||(t[85]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",Nl,[t[84]||(t[84]=e("h3",{class:"text-sm font-medium text-red-800"},"Delivery Information",-1)),e("div",Bl,[e("p",null,[t[80]||(t[80]=e("strong",null,"Reference:",-1)),g(" "+r(((m=(a=T.value)==null?void 0:a.delivery_request)==null?void 0:m.reference_number)||`DR-${String(((f=T.value)==null?void 0:f.delivery_request_id)||"").padStart(6,"0")}`),1)]),e("p",null,[t[81]||(t[81]=e("strong",null,"Route:",-1)),g(" "+r((x=(_=(h=T.value)==null?void 0:h.delivery_request)==null?void 0:_.pick_up_region)==null?void 0:x.name)+" → "+r((C=(w=(y=T.value)==null?void 0:y.delivery_request)==null?void 0:w.drop_off_region)==null?void 0:C.name),1)]),e("p",null,[t[82]||(t[82]=e("strong",null,"Driver:",-1)),g(" "+r(((F=(D=(A=T.value)==null?void 0:A.driver_truck_assignment)==null?void 0:D.driver)==null?void 0:F.name)||"N/A"),1)]),e("p",null,[t[83]||(t[83]=e("strong",null,"Truck:",-1)),g(" "+r(((E=(W=(I=T.value)==null?void 0:I.driver_truck_assignment)==null?void 0:W.truck)==null?void 0:E.license_plate)||"N/A"),1)])])])])]),e("div",Tl,[t[86]||(t[86]=e("label",{for:"cancellation_reason",class:"block text-sm font-medium text-gray-700"},"Reason for Cancellation",-1)),Wt(e("textarea",{id:"cancellation_reason","onUpdate:modelValue":t[14]||(t[14]=j=>H.value=j),rows:"3",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter reason for cancellation...",required:""},null,512),[[Pt,H.value]]),t[87]||(t[87]=e("p",{class:"mt-1 text-xs text-gray-500"},"This reason will be recorded in the delivery history.",-1))]),e("div",Fl,[M(re,{onClick:He},{default:z(()=>t[88]||(t[88]=[g(" Cancel ")])),_:1}),M(nt,{onClick:At,disabled:!H.value.trim(),loading:N.value},{default:z(()=>t[89]||(t[89]=[g(" Confirm Cancellation ")])),_:1},8,["disabled","loading"])])])]}),_:1},8,["show"]),M(ks,{show:xe.value,set:ie.value,onClose:Pe,onDispatched:kt},null,8,["show","set"])]}),_:1}))}};export{Yl as default};
