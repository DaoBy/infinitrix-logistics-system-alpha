import{c as i,o,b as e,i as x,C as B,d as S,w as g,e as a,n as f,t as r,a as c,u as l,P as v,f as y,F,r as V,s as A,J as C,N as M,K as T}from"./app-7ARdHXBa.js";import{E as $}from"./EmployeeLayout-CPjjj0VT.js";import{r as L}from"./InformationCircleIcon-OFv3E1Y7.js";import{r as D}from"./ExclamationTriangleIcon-BSpdFicH.js";import{r as U}from"./ArrowRightIcon-Bl_170VY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-DmzxVQVl.js";import"./DangerButton-CVW78upS.js";function z(s,m){return o(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})])}const O={class:"max-w-4xl mx-auto py-6 sm:px-6 lg:px-8"},G={class:"px-4 py-6 sm:px-0"},J={class:"mb-6"},K={class:"flex items-center justify-between"},W={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},H={class:"flex"},Q={class:"flex-shrink-0"},X={class:"ml-3"},Y={class:"mt-2 text-sm text-blue-700"},Z={key:0,class:"font-medium"},ee={key:1,class:"font-medium"},te={class:"mt-1 list-disc list-inside space-y-1"},se={key:0},oe={key:1},ie={key:0,class:"mb-6"},de={class:"rounded-md bg-yellow-50 p-4"},re={class:"flex"},ne={class:"flex-shrink-0"},le={class:"ml-3 flex-1 md:flex md:justify-between"},ae={class:"mt-1 text-sm text-yellow-700"},me={key:0},ue={key:1},ce={key:0,class:"mt-3 md:mt-0 md:ml-6"},xe={class:"bg-white shadow rounded-lg mb-6"},ge={class:"px-4 py-5 sm:p-6"},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-8"},fe={class:"space-y-3"},ve={class:"mt-1 text-sm text-gray-900"},pe={key:0},he={class:"mt-1 text-sm text-gray-900"},be={key:1},_e={class:"mt-1 text-sm text-gray-900"},we={class:"mt-1 text-sm text-gray-900"},ke={class:"space-y-3"},qe={class:"mt-1 text-sm text-gray-900"},Re={key:0},Se={class:"mt-1 text-sm text-gray-900"},Ce={key:1},De={class:"mt-1 text-sm text-gray-900"},Ee={class:"mt-1 text-sm text-gray-900"},Pe={class:"bg-white shadow rounded-lg mb-6"},Ie={class:"px-4 py-5 sm:px-6 border-b border-gray-200"},Ne={class:"flex justify-between items-center"},je={class:"text-sm text-gray-500"},Be={class:"px-4 py-5 sm:p-6"},Fe={class:"overflow-hidden"},Ve={class:"min-w-full divide-y divide-gray-200"},Ae={class:"bg-white divide-y divide-gray-200"},Me={class:"px-4 py-4 whitespace-nowrap"},Te={class:"text-sm font-medium text-gray-900"},$e={class:"text-sm text-gray-500"},Le={key:0,class:"text-xs text-gray-400 mt-1"},Ue={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-900"},ze={key:0},Oe={key:1,class:"text-gray-400"},Ge={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-900"},Je={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-900"},Ke={class:"px-4 py-4 whitespace-nowrap"},We={class:"bg-white shadow rounded-lg mb-6"},He={class:"px-4 py-5 sm:p-6"},Qe={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center"},Xe={class:"bg-green-50 p-4 rounded-lg"},Ye={class:"text-2xl font-bold text-green-600"},Ze={key:0,class:"bg-yellow-50 p-4 rounded-lg"},et={class:"text-2xl font-bold text-yellow-600"},tt={key:1,class:"bg-red-50 p-4 rounded-lg"},st={class:"text-2xl font-bold text-red-600"},ot={class:"bg-blue-50 p-4 rounded-lg"},it={class:"text-2xl font-bold text-blue-600 capitalize"},dt={key:0,class:"mt-6 p-4 bg-orange-50 border border-orange-200 rounded-md"},rt={class:"flex"},nt={class:"flex-shrink-0"},lt={class:"ml-3"},at={class:"mt-2 text-sm text-orange-700"},mt={key:0},ut={key:1},ct={class:"bg-white shadow rounded-lg"},xt={class:"px-4 py-5 sm:p-6"},gt={class:"flex items-start"},yt={class:"flex items-center h-5"},ft=["disabled"],vt={key:0,class:"mt-2 text-sm text-red-600"},pt={class:"mt-6"},ht=["disabled"],bt={class:"flex justify-end space-x-3 mt-6"},_t=["disabled"],wt={key:0},kt={key:1},Nt={__name:"CompletionForm",props:{order:Object,outcomeStats:Object,requiresRefund:Boolean,hasExistingRefund:Boolean,existingRefundStatus:String,existingRefundId:Number},setup(s){var b,_,w,k,q,R;const m=s,p=x(()=>{var d;return((d=m.order.delivery_request)==null?void 0:d.payment_type)==="postpaid"}),h=x(()=>{var d;return((d=m.order.delivery_request)==null?void 0:d.payment_type)==="prepaid"}),E=x(()=>m.order.status==="delivered"?"Complete Perfect Delivery":"Complete Delivery with Issues");x(()=>{var d,t;return((t=(d=m.order.delivery_request)==null?void 0:d.pick_up_region)==null?void 0:t.name)||"N/A"}),x(()=>{var d,t;return((t=(d=m.order.delivery_request)==null?void 0:d.drop_off_region)==null?void 0:t.name)||"N/A"});const P=x(()=>{const d="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50";return m.order.status==="delivered"?`${d} bg-green-600 hover:bg-green-700 focus:ring-green-500`:`${d} bg-orange-600 hover:bg-orange-700 focus:ring-orange-500`}),u=B({confirm_completion:!1,notes:"",receiver_name:((_=(b=m.order.delivery_request)==null?void 0:b.receiver)==null?void 0:_.name)||"",receiver_contact:((k=(w=m.order.delivery_request)==null?void 0:w.receiver)==null?void 0:k.phone)||"",release_packages:((R=(q=m.order.delivery_request)==null?void 0:q.packages)==null?void 0:R.map(d=>d.id))||[]});function I(){m.hasExistingRefund||(console.log("ðŸŸ¡ Form submitting...",{orderId:m.order.id,formData:u.data(),confirm_completion:u.confirm_completion}),u.post(route("delivery-completion.process",{order:m.order.id}),{onSuccess:()=>{console.log("âœ… Form submitted successfully")},onError:d=>{console.log("âŒ Form submission failed:",d)},onFinish:()=>{console.log("ðŸ Form submission finished")}}))}function N(d){return{delivered:"bg-green-100 text-green-800",needs_review:"bg-orange-100 text-orange-800",completed:"bg-blue-100 text-blue-800"}[d]||"bg-gray-100 text-gray-800"}function j(d){return{delivered:"bg-green-100 text-green-800",damaged_in_transit:"bg-red-100 text-red-800",lost_in_transit:"bg-gray-100 text-gray-800",in_transit:"bg-blue-100 text-blue-800",completed:"bg-blue-100 text-blue-800"}[d]||"bg-gray-100 text-gray-800"}return(d,t)=>(o(),S($,null,{default:g(()=>[e("div",O,[e("div",G,[e("div",J,[e("div",K,[t[2]||(t[2]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Delivery Completion"),e("p",{class:"mt-1 text-sm text-gray-600"}," Finalize delivery process and confirm package handover. ")],-1)),e("div",null,[e("span",{class:f([N(s.order.status),"inline-flex px-3 py-1 text-sm font-semibold leading-5 rounded-full"])},r(s.order.status.replace("_"," ").toUpperCase()),3)])])]),e("div",W,[e("div",H,[e("div",Q,[c(l(L),{class:"h-5 w-5 text-blue-400"})]),e("div",X,[t[6]||(t[6]=e("h3",{class:"text-sm font-medium text-blue-800"}," Process Guide ",-1)),e("div",Y,[s.order.status==="delivered"?(o(),i("p",Z,"âœ… Perfect Delivery")):(o(),i("p",ee,"âš ï¸ Delivery with Issues")),e("ul",te,[t[3]||(t[3]=e("li",null,"Review sender and receiver details",-1)),t[4]||(t[4]=e("li",null,"Verify package information below",-1)),t[5]||(t[5]=e("li",null,"Confirm delivery completion",-1)),s.order.status==="needs_review"&&h.value?(o(),i("li",se," System will create refund request for damaged/lost packages ")):s.order.status==="needs_review"&&p.value?(o(),i("li",oe," System will adjust invoice for damaged/lost packages ")):a("",!0)])])])])]),s.hasExistingRefund?(o(),i("div",ie,[e("div",de,[e("div",re,[e("div",ne,[c(l(D),{class:"h-5 w-5 text-yellow-400"})]),e("div",le,[e("div",null,[t[7]||(t[7]=e("p",{class:"text-sm font-medium text-yellow-800"}," Refund Request Already Exists ",-1)),e("p",ae,[s.existingRefundStatus==="pending"?(o(),i("span",me," A refund request is pending review. No need to complete delivery again. ")):s.existingRefundStatus==="processed"?(o(),i("span",ue," Refund has been processed. This delivery is complete. ")):a("",!0)])]),s.existingRefundId?(o(),i("div",ce,[c(l(v),{href:d.route("refunds.show",{refund:s.existingRefundId}),class:"inline-flex items-center text-sm font-medium text-yellow-800 hover:text-yellow-900"},{default:g(()=>[t[8]||(t[8]=y(" View Refund Details ")),c(l(U),{class:"ml-1 h-4 w-4"})]),_:1},8,["href"])])):a("",!0)])])])])):a("",!0),e("div",xe,[t[19]||(t[19]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium leading-6 text-gray-900"}," Delivery Parties ")],-1)),e("div",ge,[e("div",ye,[e("div",null,[t[13]||(t[13]=e("h4",{class:"text-sm font-medium text-gray-500 mb-4"},"Sender Information",-1)),e("dl",fe,[e("div",null,[t[9]||(t[9]=e("dt",{class:"text-xs font-medium text-gray-400"},"Name",-1)),e("dd",ve,r(s.order.delivery_request.sender.name),1)]),s.order.delivery_request.sender.phone?(o(),i("div",pe,[t[10]||(t[10]=e("dt",{class:"text-xs font-medium text-gray-400"},"Phone",-1)),e("dd",he,r(s.order.delivery_request.sender.phone),1)])):a("",!0),s.order.delivery_request.sender.email?(o(),i("div",be,[t[11]||(t[11]=e("dt",{class:"text-xs font-medium text-gray-400"},"Email",-1)),e("dd",_e,r(s.order.delivery_request.sender.email),1)])):a("",!0),e("div",null,[t[12]||(t[12]=e("dt",{class:"text-xs font-medium text-gray-400"},"Pick-up Region",-1)),e("dd",we,r(s.order.delivery_request.pick_up_region.name),1)])])]),e("div",null,[t[18]||(t[18]=e("h4",{class:"text-sm font-medium text-gray-500 mb-4"},"Receiver Information",-1)),e("dl",ke,[e("div",null,[t[14]||(t[14]=e("dt",{class:"text-xs font-medium text-gray-400"},"Name",-1)),e("dd",qe,r(s.order.delivery_request.receiver.name),1)]),s.order.delivery_request.receiver.phone?(o(),i("div",Re,[t[15]||(t[15]=e("dt",{class:"text-xs font-medium text-gray-400"},"Phone",-1)),e("dd",Se,r(s.order.delivery_request.receiver.phone),1)])):a("",!0),s.order.delivery_request.receiver.email?(o(),i("div",Ce,[t[16]||(t[16]=e("dt",{class:"text-xs font-medium text-gray-400"},"Email",-1)),e("dd",De,r(s.order.delivery_request.receiver.email),1)])):a("",!0),e("div",null,[t[17]||(t[17]=e("dt",{class:"text-xs font-medium text-gray-400"},"Delivery Region",-1)),e("dd",Ee,r(s.order.delivery_request.drop_off_region.name),1)])])])])])]),e("div",Pe,[e("div",Ie,[e("div",Ne,[t[20]||(t[20]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900"}," Package Details ",-1)),e("span",je,r(s.order.delivery_request.packages.length)+" packages total ",1)])]),e("div",Be,[e("div",Fe,[e("table",Ve,[t[21]||(t[21]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Dimensions"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Weight"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Value"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status")])],-1)),e("tbody",Ae,[(o(!0),i(F,null,V(s.order.delivery_request.packages,n=>(o(),i("tr",{key:n.id},[e("td",Me,[e("div",Te,r(n.item_name),1),e("div",$e,r(n.item_code),1),n.description?(o(),i("div",Le,r(n.description),1)):a("",!0)]),e("td",Ue,[n.height&&n.width&&n.length?(o(),i("span",ze,r(n.height)+" Ã— "+r(n.width)+" Ã— "+r(n.length)+" cm ",1)):(o(),i("span",Oe,"-"))]),e("td",Ge,r(n.weight)+" kg ",1),e("td",Je," â‚±"+r(n.value),1),e("td",Ke,[e("span",{class:f([j(n.status),"inline-flex px-2 text-xs font-semibold leading-5 rounded-full"])},r(n.status.replace("_"," ").toUpperCase()),3)])]))),128))])])])])]),e("div",We,[t[27]||(t[27]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium leading-6 text-gray-900"}," Delivery Summary ")],-1)),e("div",He,[e("div",Qe,[e("div",Xe,[e("div",Ye,r(s.outcomeStats.delivered_count),1),t[22]||(t[22]=e("div",{class:"text-sm text-green-800"},"Successfully Delivered",-1))]),s.outcomeStats.damaged_count>0?(o(),i("div",Ze,[e("div",et,r(s.outcomeStats.damaged_count),1),t[23]||(t[23]=e("div",{class:"text-sm text-yellow-800"},"Damaged",-1))])):a("",!0),s.outcomeStats.lost_count>0?(o(),i("div",tt,[e("div",st,r(s.outcomeStats.lost_count),1),t[24]||(t[24]=e("div",{class:"text-sm text-red-800"},"Lost",-1))])):a("",!0),e("div",ot,[e("div",it,r(s.order.delivery_request.payment_type),1),t[25]||(t[25]=e("div",{class:"text-sm text-blue-800"},"Payment Type",-1))])]),s.order.status==="needs_review"&&!s.hasExistingRefund?(o(),i("div",dt,[e("div",rt,[e("div",nt,[c(l(D),{class:"h-5 w-5 text-orange-400"})]),e("div",lt,[t[26]||(t[26]=e("h3",{class:"text-sm font-medium text-orange-800"}," Financial Action Required ",-1)),e("div",at,[h.value?(o(),i("p",mt," A refund request will be created for the damaged/lost packages. Customer will be contacted for negotiation. ")):p.value?(o(),i("p",ut," Invoice will be adjusted to exclude charges for damaged/lost packages. ")):a("",!0)])])])])):a("",!0)])]),e("form",{onSubmit:A(I,["prevent"])},[e("div",ct,[t[30]||(t[30]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium leading-6 text-gray-900"}," Final Confirmation ")],-1)),e("div",xt,[e("div",gt,[e("div",yt,[C(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>l(u).confirm_completion=n),id:"confirm_completion",name:"confirm_completion",type:"checkbox",disabled:s.hasExistingRefund,class:"focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded"},null,8,ft),[[M,l(u).confirm_completion]])]),t[28]||(t[28]=e("div",{class:"ml-3 text-sm"},[e("label",{for:"confirm_completion",class:"font-medium text-gray-700"}," I confirm that all information above has been verified and the delivery process is complete "),e("p",{class:"text-gray-500 mt-1"}," By checking this box, you confirm that package details, receiver information, and delivery outcomes have been properly reviewed. ")],-1))]),l(u).errors.confirm_completion?(o(),i("p",vt,r(l(u).errors.confirm_completion),1)):a("",!0),e("div",pt,[t[29]||(t[29]=e("label",{for:"notes",class:"block text-sm font-medium text-gray-700"}," Additional Notes (Optional) ",-1)),C(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=n=>l(u).notes=n),id:"notes",rows:"3",disabled:s.hasExistingRefund,class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm disabled:opacity-50",placeholder:"Any special notes about the delivery, handover process, or customer communication..."},null,8,ht),[[T,l(u).notes]])])])]),e("div",bt,[c(l(v),{href:d.route("delivery-completion.ready-for-completion"),class:"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:g(()=>t[31]||(t[31]=[y(" Back to List ")])),_:1},8,["href"]),s.hasExistingRefund?(o(),S(l(v),{key:1,href:d.route("refunds.show",{refund:s.existingRefundId}),class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"},{default:g(()=>t[33]||(t[33]=[y(" View Refund Details ")])),_:1},8,["href"])):(o(),i("button",{key:0,type:"submit",disabled:l(u).processing||!l(u).confirm_completion,class:f(P.value)},[l(u).processing?(o(),i("span",wt,[c(l(z),{class:"h-4 w-4 animate-spin mr-2"}),t[32]||(t[32]=y(" Processing... "))])):(o(),i("span",kt,r(E.value),1))],10,_t))])],32)])])]),_:1}))}};export{Nt as default};
