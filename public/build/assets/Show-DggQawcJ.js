import{E as de}from"./EmployeeLayout-BQLa5PLV.js";import{_ as ue}from"./PrimaryButton-z6gddSkS.js";import{_ as w}from"./SecondaryButton-BDpVYXxA.js";import{D as O}from"./DangerButton-DlTel5kP.js";import{_ as ce}from"./InputLabel-BebyH7Kw.js";import{_ as me}from"./TextArea-DUZFOSeU.js";import{M as B}from"./Modal-Oa0ozw3w.js";import{_ as ye}from"./DataTable-C_2NMP2T.js";import{g as u,i as xe,K as ge,d as j,o as a,w as n,b as t,a as c,c as o,e as d,t as l,f as y,n as W,F as ve,r as fe,W as p}from"./app-B0R_bMJi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-BchASNUp.js";const be={class:"flex justify-between items-center"},pe={class:"text-xl font-semibold leading-tight text-gray-800"},he={class:"flex space-x-2"},ke={class:"py-4"},we={class:"max-w-4xl mx-auto px-2 lg:px-4 space-y-4"},je={key:0,class:"mb-4 space-y-2"},Se={key:0,class:"p-3 bg-blue-100 text-blue-800 rounded"},Ce={key:1,class:"p-3 bg-green-100 text-green-800 rounded"},_e={key:2,class:"p-3 bg-red-100 text-red-800 rounded"},Ae={class:"bg-white shadow-sm rounded-lg border border-gray-200 mb-2"},Ne={class:"p-3 bg-indigo-50 border-b border-gray-200 flex flex-col md:flex-row md:items-center md:justify-between"},Re={class:"flex items-center gap-2"},De={class:"text-base font-bold text-indigo-900 tracking-wide"},Pe={class:"mt-1 text-xs text-gray-500"},Be={key:0},qe={class:"mt-2 md:mt-0 flex items-center gap-2"},Me={class:"font-medium text-gray-900"},Ve={class:"p-3 grid grid-cols-1 md:grid-cols-2 gap-3"},$e={class:"space-y-2"},Le={class:"mt-0.5 text-sm text-gray-900"},Ue={class:"mt-0.5 text-sm text-gray-900"},Fe={class:"mt-0.5 text-sm text-gray-900"},He={key:0},Ie={class:"mt-0.5 text-sm text-gray-900"},Ee={key:1},Te={class:"mt-0.5 text-sm text-gray-900"},ze={key:2},Oe={class:"mt-0.5 text-sm text-gray-900"},We={key:3},Ke={class:"mt-0.5 text-sm text-gray-900"},Ge={key:4},Je={class:"mt-0.5 text-sm text-gray-900 whitespace-pre-wrap"},Qe={class:"space-y-2"},Xe={class:"mt-0.5 text-sm text-gray-900"},Ye={class:"mt-0.5 text-sm text-gray-900 capitalize"},Ze={class:"mt-0.5"},et={class:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-2"},tt={class:"bg-white shadow-sm rounded-lg border border-gray-200 p-3"},st={class:"mt-0.5 text-sm text-gray-900"},rt={class:"mt-0.5 text-sm text-gray-900"},lt={class:"mt-0.5 text-sm text-gray-900"},at={class:"mt-0.5 text-sm text-gray-900"},it={class:"bg-white shadow-sm rounded-lg border border-gray-200 p-3"},ot={class:"mt-0.5 text-sm text-gray-900"},nt={class:"mt-0.5 text-sm text-gray-900"},dt={class:"mt-0.5 text-sm text-gray-900"},ut={class:"mt-0.5 text-sm text-gray-900"},ct={class:"bg-white shadow-sm rounded-lg border border-gray-200 p-3 mb-2"},mt={class:"text-base font-medium text-gray-900 mb-2"},yt=["src","onClick"],xt={key:1},gt={key:1,class:"text-gray-500"},vt={class:"p-6"},ft={class:"mt-4 space-y-4"},bt={class:"flex justify-between"},pt={class:"font-medium"},ht={class:"text-sm text-gray-500"},kt={class:"text-sm text-gray-600 mt-1"},wt={class:"text-xs text-gray-500 mt-1"},jt={class:"mt-6 flex justify-end"},St={class:"p-6"},Ct={class:"mt-4"},_t={class:"mt-6 flex justify-end space-x-4"},At={key:0},Nt={key:1},Rt={class:"p-4"},Dt=["src"],Et={__name:"Show",props:{delivery:{type:Object,required:!0,default:()=>({id:null,order_number:null,status:null,created_at:null,approved_at:null,approved_by:null,rejected_at:null,rejected_by:null,rejection_reason:null,total_price:0,payment_method:null,payment_status:null,sender:null,receiver:null,packages:[]})},packages:{type:Array,default:()=>[]},status:String,success:String,error:String},setup(s){const h=s,S=u(!1),g=u(""),v=u(!1),C=u(!1),_=u(""),A=u(!1),N=u([]),K=[{field:"item_name",header:"Item",sortable:!0},{field:"category",header:"Category",sortable:!0},{field:"dimensions",header:"Dimensions",sortable:!1},{field:"weight",header:"Weight (kg)",sortable:!0},{field:"value",header:"Value",sortable:!0},{field:"photo",header:"Photo",sortable:!1},{field:"status_history",header:"Status History",sortable:!1}],f=u("item_name"),R=u("asc"),G=xe(()=>h.delivery.packages?[...h.delivery.packages].sort((r,e)=>{if(!f.value)return 0;const m=R.value==="asc"?1:-1,x=q(r,f.value),b=q(e,f.value);return x<b?-1*m:x>b?1*m:0}):[]);function q(r,e){return e.split(".").reduce((m,x)=>m==null?void 0:m[x],r)}function k(r){return r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}function J(r){return r?new Date(r).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}function M(r){return r?[r.building_number,r.street,r.barangay,r.city,r.province,r.zip_code].filter(Boolean).join(", ")||"Address not specified":"N/A"}function Q(r){return(Number(r)||0).toFixed(2)}function X(){S.value=!0}function D(){S.value=!1,g.value=""}function Y(r){_.value=r,C.value=!0}function Z(){C.value=!1,_.value=""}function ee(r){N.value=r.status_history||[],A.value=!0}function V(){A.value=!1,N.value=[]}function te({field:r,direction:e}){f.value=r,R.value=e}async function se(){if(confirm("Are you sure you want to approve this delivery request?")){v.value=!0;try{await p.post(route("deliveries.approve",h.delivery.id),{},{preserveScroll:!0,onSuccess:()=>{p.reload()}})}catch(r){console.error("Failed to approve request:",r)}finally{v.value=!1}}}async function re(){if(g.value.trim()){v.value=!0;try{await p.post(route("deliveries.reject",h.delivery.id),{rejection_reason:g.value},{preserveScroll:!0,onSuccess:()=>{D(),p.reload()}})}catch(r){console.error("Failed to reject request:",r)}finally{v.value=!1}}}function le(r){if(!r)return"bg-gray-200 text-gray-700";const e=String(r).toLowerCase().trim();return e==="completed"||e==="complete"||e==="paid"?"bg-green-100 text-green-800":e==="pending"||e==="pending_payment"?"bg-yellow-100 text-yellow-800":e==="unpaid"||e==="uncollectible"?"bg-red-100 text-red-800":"bg-gray-200 text-gray-700"}function ae(r){if(!r||r===""||r==="N/A")return"N/A";const e=String(r).toLowerCase().trim();return e==="paid"?"Paid":e==="complete"?"Complete":e==="completed"?"Completed":e==="pending"?"Pending":e==="pending_payment"?"Pending Payment":e==="unpaid"?"Unpaid":e==="uncollectible"?"Uncollectible":r.charAt(0).toUpperCase()+r.slice(1)}function ie(r){if(!r)return"bg-gray-200 text-gray-700";const e=String(r).toLowerCase().trim();return e==="completed"||e==="complete"?"bg-green-100 text-green-800":e==="approved"?"bg-blue-100 text-blue-800":e==="pending"?"bg-yellow-100 text-yellow-800":e==="rejected"?"bg-red-100 text-red-800":"bg-gray-200 text-gray-700"}function oe(r){if(!r)return"N/A";const e=String(r).toLowerCase().trim();return e==="completed"?"Completed":e==="complete"?"Complete":e==="approved"?"Approved":e==="pending"?"Pending":e==="rejected"?"Rejected":r.charAt(0).toUpperCase()+r.slice(1)}ge(),u(document.referrer);function ne(){window.history.length>1?window.history.back():p.visit("/")}return(r,e)=>(a(),j(de,null,{header:n(()=>[t("div",be,[t("h2",pe," Delivery Request: "+l(s.delivery.reference_number||s.delivery.order_number||"#"+s.delivery.id),1),t("div",he,[c(w,{onClick:ne},{default:n(()=>e[1]||(e[1]=[y(" Back ")])),_:1}),s.delivery.status==="pending"?(a(),j(O,{key:0,onClick:X},{default:n(()=>e[2]||(e[2]=[y(" Reject Request ")])),_:1})):d("",!0),s.delivery.status==="pending"?(a(),j(ue,{key:1,onClick:se},{default:n(()=>e[3]||(e[3]=[y(" Approve Request ")])),_:1})):d("",!0)])])]),default:n(()=>{var m,x,b,$,L,U,F,H,I,E,T;return[t("div",ke,[t("div",we,[s.status||s.success||s.error?(a(),o("div",je,[s.status?(a(),o("div",Se,l(s.status),1)):d("",!0),s.success?(a(),o("div",Ce,l(s.success),1)):d("",!0),s.error?(a(),o("div",_e,l(s.error),1)):d("",!0)])):d("",!0),t("div",Ae,[t("div",Ne,[t("div",null,[t("div",Re,[e[4]||(e[4]=t("span",{class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-indigo-100 text-indigo-800"}," Reference # ",-1)),t("span",De,l(s.delivery.reference_number||s.delivery.order_number||"DR-"+String(s.delivery.id).padStart(6,"0")),1)]),t("div",Pe,[y(" Delivery ID: DO-"+l(String(s.delivery.id).padStart(6,"0"))+" ",1),s.delivery.created_at?(a(),o("span",Be," | Created: "+l(k(s.delivery.created_at)),1)):d("",!0)])]),t("div",qe,[t("span",Me," ₱"+l(Number(s.delivery.total_price).toFixed(2)),1),e[5]||(e[5]=t("span",{class:"text-xs text-gray-500"},"Total Amount",-1))])]),t("div",Ve,[t("section",$e,[e[15]||(e[15]=t("h3",{class:"text-base font-medium text-gray-900"},"Delivery Information",-1)),t("div",null,[e[6]||(e[6]=t("label",{class:"block text-xs font-medium text-gray-500"},"Status",-1)),t("span",{class:W(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold",ie(s.delivery.status)])},l(oe(s.delivery.status)),3)]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-xs font-medium text-gray-500"},"Reference Number",-1)),t("p",Le,l(s.delivery.reference_number||s.delivery.order_number||"DR-"+String(s.delivery.id).padStart(6,"0")),1)]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-xs font-medium text-gray-500"},"Order Number",-1)),t("p",Ue,l(s.delivery.order_number||"N/A"),1)]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-xs font-medium text-gray-500"},"Request Date",-1)),t("p",Fe,l(k(s.delivery.created_at)),1)]),s.delivery.approved_at?(a(),o("div",He,[e[10]||(e[10]=t("label",{class:"block text-xs font-medium text-gray-500"},"Approved Date",-1)),t("p",Ie,l(k(s.delivery.approved_at)),1)])):d("",!0),s.delivery.approved_by?(a(),o("div",Ee,[e[11]||(e[11]=t("label",{class:"block text-xs font-medium text-gray-500"},"Approved By",-1)),t("p",Te,l(s.delivery.approved_by),1)])):d("",!0),s.delivery.rejected_at?(a(),o("div",ze,[e[12]||(e[12]=t("label",{class:"block text-xs font-medium text-gray-500"},"Rejected Date",-1)),t("p",Oe,l(k(s.delivery.rejected_at)),1)])):d("",!0),s.delivery.rejected_by?(a(),o("div",We,[e[13]||(e[13]=t("label",{class:"block text-xs font-medium text-gray-500"},"Rejected By",-1)),t("p",Ke,l(s.delivery.rejected_by),1)])):d("",!0),s.delivery.rejection_reason?(a(),o("div",Ge,[e[14]||(e[14]=t("label",{class:"block text-xs font-medium text-gray-500"},"Rejection Reason",-1)),t("p",Je,l(s.delivery.rejection_reason),1)])):d("",!0)]),t("section",Qe,[e[19]||(e[19]=t("h3",{class:"text-base font-medium text-gray-900"},"Payment",-1)),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-xs font-medium text-gray-500"},"Total Amount",-1)),t("p",Xe,"₱"+l(s.delivery.total_price||"0.00"),1)]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-xs font-medium text-gray-500"},"Payment Method",-1)),t("p",Ye,l(s.delivery.payment_method||"N/A"),1)]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-xs font-medium text-gray-500"},"Payment Status",-1)),t("div",Ze,[t("span",{class:W(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold",le(s.delivery.payment_status)])},l(ae(s.delivery.payment_status)),3)])])])])]),t("div",et,[t("div",tt,[e[24]||(e[24]=t("h3",{class:"text-base font-medium text-gray-900 mb-1"},"Sender",-1)),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-xs font-medium text-gray-500"},"Name",-1)),t("p",st,l(((m=s.delivery.sender)==null?void 0:m.name)||((x=s.delivery.sender)==null?void 0:x.company_name)||"N/A"),1)]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-xs font-medium text-gray-500"},"Contact",-1)),t("p",rt,l(((b=s.delivery.sender)==null?void 0:b.phone)||(($=s.delivery.sender)==null?void 0:$.mobile)||"N/A"),1)]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-xs font-medium text-gray-500"},"Email",-1)),t("p",lt,l(((L=s.delivery.sender)==null?void 0:L.email)||"N/A"),1)]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-xs font-medium text-gray-500"},"Address",-1)),t("p",at,l(M(s.delivery.sender)),1)])]),t("div",it,[e[29]||(e[29]=t("h3",{class:"text-base font-medium text-gray-900 mb-1"},"Receiver",-1)),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-xs font-medium text-gray-500"},"Name",-1)),t("p",ot,l(((U=s.delivery.receiver)==null?void 0:U.name)||((F=s.delivery.receiver)==null?void 0:F.company_name)||"N/A"),1)]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-xs font-medium text-gray-500"},"Contact",-1)),t("p",nt,l(((H=s.delivery.receiver)==null?void 0:H.phone)||((I=s.delivery.receiver)==null?void 0:I.mobile)||"N/A"),1)]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-xs font-medium text-gray-500"},"Email",-1)),t("p",dt,l(((E=s.delivery.receiver)==null?void 0:E.email)||"N/A"),1)]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-xs font-medium text-gray-500"},"Address",-1)),t("p",ut,l(M(s.delivery.receiver)),1)])])]),t("div",ct,[t("h3",mt,"Packages ("+l(((T=s.delivery.packages)==null?void 0:T.length)||0)+")",1),s.delivery.packages&&s.delivery.packages.length?(a(),j(ye,{key:0,columns:K,data:G.value,"sort-field":f.value,"sort-direction":R.value,onSort:te},{dimensions:n(({row:i})=>[y(l(i.height)+" × "+l(i.width)+" × "+l(i.length)+" cm ",1)]),value:n(({row:i})=>[y(" ₱"+l(Q(i.value)),1)]),photo:n(({row:i})=>[i.photo_path?(a(),o("img",{key:0,src:`/storage/${i.photo_path}`,alt:"Package photo",class:"h-10 w-10 object-cover rounded cursor-pointer",onClick:P=>Y(`/storage/${i.photo_path}`)},null,8,yt)):(a(),o("span",xt,"No photo"))]),status_history:n(({row:i})=>[c(w,{class:"!px-2 !py-1 !text-xs !font-normal",onClick:P=>ee(i)},{default:n(()=>e[30]||(e[30]=[y(" View History ")])),_:2},1032,["onClick"])]),_:1},8,["data","sort-field","sort-direction"])):(a(),o("div",gt," No packages found for this delivery. "))])])]),c(B,{show:A.value,onClose:V,"max-width":"lg"},{default:n(()=>[t("div",vt,[e[32]||(e[32]=t("h2",{class:"text-lg font-medium text-gray-900"},"Status History",-1)),t("div",ft,[(a(!0),o(ve,null,fe(N.value,(i,P)=>{var z;return a(),o("div",{key:P,class:"border-l-4 border-blue-500 pl-4 py-2"},[t("div",bt,[t("span",pt,l(i.status),1),t("span",ht,l(J(i.created_at)),1)]),t("p",kt,l(i.notes||"No notes provided"),1),t("p",wt,"Updated by: "+l(((z=i.user)==null?void 0:z.name)||"System"),1)])}),128))]),t("div",jt,[c(w,{onClick:V},{default:n(()=>e[31]||(e[31]=[y(" Close ")])),_:1})])])]),_:1},8,["show"]),c(B,{show:S.value,onClose:D},{default:n(()=>[t("div",St,[e[34]||(e[34]=t("h2",{class:"text-lg font-medium text-gray-900"},"Reject Delivery Request?",-1)),e[35]||(e[35]=t("p",{class:"mt-1 text-sm text-gray-600"}," Are you sure you want to reject this delivery request? ",-1)),t("div",Ct,[c(ce,{for:"rejection_reason",value:"Reason for Rejection (Required)"}),c(me,{id:"rejection_reason",class:"mt-1 block w-full",modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=i=>g.value=i),rows:3,placeholder:"Enter reason for rejection...",required:""},null,8,["modelValue"])]),t("div",_t,[c(w,{onClick:D},{default:n(()=>e[33]||(e[33]=[y(" Cancel ")])),_:1}),c(O,{onClick:re,disabled:v.value||!g.value.trim()},{default:n(()=>[v.value?(a(),o("span",At,"Rejecting...")):(a(),o("span",Nt,"Reject"))]),_:1},8,["disabled"])])])]),_:1},8,["show"]),c(B,{show:C.value,onClose:Z,"max-width":"4xl"},{default:n(()=>[t("div",Rt,[t("img",{src:_.value,alt:"Package photo preview",class:"max-h-[80vh] mx-auto"},null,8,Dt)])]),_:1},8,["show"])]}),_:1}))}};export{Et as default};
