import{E as F}from"./EmployeeLayout-CIwV2LFp.js";import{M as v}from"./Modal-DnFLVV-w.js";import{_ as y}from"./PrimaryButton-H84cxS-1.js";import{_ as P}from"./SecondaryButton--u4JNCYW.js";import{M as T,i as f,g as b,h as I,j as L,d as w,o,w as l,b as e,a as g,c as d,f as n,t as s,n as O,F as h,r as _,e as p,W as M}from"./app-DfDxEqBg.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-Dm252fTo.js";import"./DangerButton-CCeglgOy.js";const A={key:0,class:"mb-4 p-3 bg-blue-50 text-blue-800 rounded"},H={class:"flex justify-between items-center px-6 print:hidden"},V={class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"},R={class:"flex space-x-2"},W={class:"px-6 py-4 print:p-0"},q={class:"printable-area bg-white dark:bg-gray-800 shadow-sm rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700 max-w-7xl mx-auto print:border-0 print:shadow-none"},U={class:"p-6 print:p-0"},X={class:"border-b border-gray-200 dark:border-gray-700 pb-4 mb-4 print:border-b-0"},G={class:"flex justify-between items-start"},K={class:"text-right"},J={class:"text-sm text-gray-500 dark:text-gray-400"},Q={class:"font-medium text-gray-900 dark:text-gray-100"},Y={class:"text-sm text-gray-500 dark:text-gray-400"},Z={class:"font-medium text-gray-900 dark:text-gray-100"},ee={class:"text-sm text-gray-500 dark:text-gray-400"},te={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},se={class:"bg-gray-50 dark:bg-gray-700 p-3 rounded"},ae={class:"text-sm text-gray-900 dark:text-gray-100"},re={class:"bg-gray-50 dark:bg-gray-700 p-3 rounded"},ie={class:"text-sm text-gray-900 dark:text-gray-100"},oe={key:0,class:"overflow-x-auto"},ne={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},le={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},de={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300"},me={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300"},xe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300"},ue={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300"},ce={key:1,class:"p-4 text-center text-gray-500"},ye={class:"p-8 flex flex-col items-center text-center"},fe={class:"text-sm text-gray-500 dark:text-gray-400 mb-4"},pe={key:0,class:"mt-2 mb-4 list-disc pl-5 text-sm text-gray-600 dark:text-gray-400 text-left w-full max-w-xl mx-auto"},be={class:"font-semibold"},ke={key:0},ve={class:"font-semibold"},we={class:"mt-4 flex justify-center w-full"},he={class:"p-8 flex flex-col items-center text-center"},_e={class:"text-sm text-gray-500 dark:text-gray-400 mb-4"},Me={class:"mt-4 flex justify-center w-full"},Ee={__name:"Show",props:{manifest:{type:Object,required:!0},truck:{type:Object,required:!0},driver:{type:Object,default:()=>({id:null,name:null,employee_id:null})},packages:{type:Array,default:()=>[]}},setup(i){const m=i,C=T(),k=f(()=>{var a;return((a=C.props.flash)==null?void 0:a.success)||null}),u=b(!1),x=b(!1),c=b({message:"",missing_packages:[]});I(k,a=>{a&&(x.value=!0)});const S=f(()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})),z=f(()=>{var a;return((a=m.driver)==null?void 0:a.name)||"Not assigned"}),j=f(()=>{var a;return((a=m.driver)==null?void 0:a.employee_id)||"N/A"}),N=a=>{const t="px-2 inline-flex text-xs leading-5 font-semibold rounded-full";switch(a){case"draft":return`${t} bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200`;case"finalized":return`${t} bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200`;default:return`${t} bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300`}},$=()=>{window.open(route("manifests.print",m.manifest.id),"_blank")},B=()=>{const a=m.packages.filter(t=>!t.waybill_number||t.waybill_number==="Pending");if(a.length>0){c.value={message:"Some packages are missing valid waybills. Please resolve before finalizing.",missing_packages:a.map(t=>({item_name:t.item_name,category:t.category,drop_off_region:t.drop_off_region,waybill_status:t.waybill_number||"none"}))},u.value=!0;return}M.post(route("manifests.finalize",m.manifest.id),{},{preserveScroll:!0,onSuccess:()=>{x.value=!0},onError:t=>{alert("Failed to finalize manifest. Please try again.")}})},D=()=>{M.visit(route("manifests.index"))};return L(()=>{}),(a,t)=>(o(),w(F,null,{header:l(()=>[a.$page.props.flash&&a.$page.props.flash.info?(o(),d("div",A,s(a.$page.props.flash.info),1)):p("",!0),e("div",H,[e("h2",V," Truck Manifest: "+s(i.manifest.manifest_number),1),e("div",R,[i.manifest.status==="draft"?(o(),w(y,{key:0,onClick:B,class:"inline-flex items-center"},{default:l(()=>t[4]||(t[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),n(" Finalize Manifest ")])),_:1})):p("",!0),g(y,{onClick:$,class:"inline-flex items-center"},{default:l(()=>t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})],-1),n(" Print Manifest ")])),_:1}),g(P,{onClick:D,class:"inline-flex items-center"},{default:l(()=>t[6]||(t[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z","clip-rule":"evenodd"})],-1),n(" Back to Manifests ")])),_:1})])])]),default:l(()=>[e("div",W,[e("div",q,[e("div",U,[e("div",X,[e("div",G,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},"INFINITRIX EXPRESS CARGO"),e("p",{class:"text-lg text-gray-600 dark:text-gray-300"},"TRUCK MANIFEST")],-1)),e("div",K,[e("p",J,[t[7]||(t[7]=n("Date: ")),e("span",Q,s(S.value),1)]),e("p",Y,[t[8]||(t[8]=n("Manifest #: ")),e("span",Z,s(i.manifest.manifest_number),1)]),e("p",ee,[t[9]||(t[9]=n("Status: ")),e("span",{class:O([N(i.manifest.status),"font-medium"])},s(i.manifest.status),3)])])])]),e("div",te,[e("div",se,[t[11]||(t[11]=e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Truck",-1)),e("p",ae,s(i.truck.make)+" "+s(i.truck.model)+" ("+s(i.truck.license_plate)+")",1)]),e("div",re,[t[12]||(t[12]=e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Driver",-1)),e("p",ie,s(z.value)+" (ID: "+s(j.value)+")",1)])]),i.packages.length>0?(o(),d("div",oe,[e("table",ne,[t[13]||(t[13]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," DO # "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Category "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Package Name "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Municipality "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Waybill # ")])],-1)),e("tbody",le,[(o(!0),d(h,null,_(i.packages,r=>(o(),d("tr",{key:r.id},[e("td",de," DO-"+s(r.delivery_order_id.toString().padStart(6,"0")),1),e("td",ge,s(r.category),1),e("td",me,s(r.item_name),1),e("td",xe,s(r.drop_off_region||"N/A"),1),e("td",ue,s(r.waybill_number||"Pending"),1)]))),128))])])])):(o(),d("div",ce," No packages assigned to this truck ")),t[14]||(t[14]=e("div",{class:"mt-8 pt-4 border-t border-gray-200 dark:border-gray-700 grid grid-cols-2 gap-4 print:border-t-0"},[e("div",null,[e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Driver's Signature"),e("div",{class:"mt-8 h-16 border-b border-gray-300 dark:border-gray-600"})]),e("div",{class:"text-right"},[e("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Dispatcher's Signature"),e("div",{class:"mt-8 h-16 border-b border-gray-300 dark:border-gray-600"})])],-1))])])]),g(v,{show:u.value,onClose:t[1]||(t[1]=r=>u.value=!1),"max-width":"md"},{default:l(()=>[e("div",ye,[t[17]||(t[17]=e("div",{class:"flex items-center justify-center w-16 h-16 rounded-full bg-red-100 mb-4"},[e("svg",{class:"w-8 h-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),t[18]||(t[18]=e("h2",{class:"text-2xl font-semibold text-red-700 dark:text-red-400 mb-2"},"Cannot Finalize Manifest",-1)),t[19]||(t[19]=e("p",{class:"text-base text-gray-700 dark:text-gray-300 mb-2"}," There was a problem finalizing this manifest. Please review the details below and resolve any issues before trying again. ",-1)),e("p",fe,s(c.value.message),1),c.value.missing_packages.length?(o(),d("ul",pe,[(o(!0),d(h,null,_(c.value.missing_packages,(r,E)=>(o(),d("li",{key:E},[e("span",be,s(r.item_name),1),n(" ("+s(r.category)+") - "+s(r.drop_off_region),1),r.waybill_status?(o(),d("span",ke,[t[15]||(t[15]=n(" - Waybill: ")),e("span",ve,s(r.waybill_status),1)])):p("",!0)]))),128))])):p("",!0),e("div",we,[g(y,{onClick:t[0]||(t[0]=r=>u.value=!1)},{default:l(()=>t[16]||(t[16]=[n("Close")])),_:1})])])]),_:1},8,["show"]),g(v,{show:x.value,onClose:t[3]||(t[3]=r=>x.value=!1),"max-width":"md"},{default:l(()=>[e("div",he,[t[21]||(t[21]=e("div",{class:"flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4"},[e("svg",{class:"w-8 h-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),t[22]||(t[22]=e("h2",{class:"text-2xl font-semibold text-green-700 mb-2"},"Manifest Finalized Successfully",-1)),t[23]||(t[23]=e("p",{class:"text-base text-gray-700 dark:text-gray-300 mb-2"}," The manifest has been finalized and is now ready for further processing. ",-1)),e("p",_e,s(k.value),1),e("div",Me,[g(y,{onClick:t[2]||(t[2]=r=>x.value=!1)},{default:l(()=>t[20]||(t[20]=[n("Close")])),_:1})])])]),_:1},8,["show"])]),_:1}))}};export{Ee as default};
