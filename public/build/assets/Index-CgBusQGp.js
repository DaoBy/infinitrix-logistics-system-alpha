import{g as p,W as k,h as J,j as G,d as w,o as l,w as a,b as t,c,e as v,t as o,F as j,r as F,k as N,a as g,u as K,J as I,L as V,f as _,s as Q,n as A,I as X}from"./app-7ARdHXBa.js";import{E as Y}from"./EmployeeLayout-CPjjj0VT.js";import{_ as S}from"./PrimaryButton-v78qpko7.js";import{_ as D}from"./SecondaryButton-CtLoK5i5.js";import{_ as P}from"./InputLabel-DWThjhuV.js";import{T as Z}from"./TextInput-DJiKnpoB.js";import{_ as ee}from"./DataTable-B34jkpRg.js";import{P as te}from"./Pagination-he4Q2J9p.js";import{l as se}from"./lodash-lR-vxHp4.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-DmzxVQVl.js";import"./DangerButton-CVW78upS.js";/* empty css                                                                  */const oe={class:"flex justify-between items-center"},ae={class:"flex space-x-2"},le={class:"px-6 sm:px-8"},re={key:0,class:"mb-6"},ne={key:0,class:"p-4 bg-blue-100 text-blue-800 rounded"},de={key:1,class:"p-4 bg-green-100 text-green-800 rounded"},ce={key:2,class:"p-4 bg-red-100 text-red-800 rounded"},ue={key:1,class:"mb-6 bg-white p-6 rounded-lg shadow-sm"},ge={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},me={class:"bg-blue-50 p-4 rounded-lg text-center"},fe={class:"text-2xl font-bold text-blue-600"},pe={class:"bg-green-50 p-4 rounded-lg text-center"},ve={class:"text-2xl font-bold text-green-600"},_e={class:"bg-yellow-50 p-4 rounded-lg text-center"},be={class:"text-2xl font-bold text-yellow-600"},ke={class:"bg-purple-50 p-4 rounded-lg text-center"},xe={class:"text-2xl font-bold text-purple-600"},he={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},ye={class:"flex items-center"},we={class:"text-sm"},Se={class:"text-sm font-semibold"},Pe={class:"mb-6 bg-white p-6 rounded-lg shadow-sm"},Ce={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},$e=["value"],je={class:"flex justify-between items-center mt-4"},Fe={class:"text-sm text-gray-600"},Ie={class:"flex space-x-2"},Ve={key:2,class:"mb-4 bg-yellow-50 p-4 rounded-lg"},De={class:"flex items-center justify-between"},Re={class:"text-yellow-800"},Ne={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Ae={class:"p-6 bg-white border-b border-gray-200"},Te=["onClick"],Ue={class:"font-mono text-sm"},Ee={class:"flex items-center"},Le={class:"truncate max-w-xs"},We={class:"flex items-center"},Be={class:"text-sm"},Oe={class:"font-medium"},Me={class:"text-gray-500 text-xs truncate max-w-xs"},qe={class:"text-sm text-gray-900"},ze={key:0,class:"text-sm"},He={class:"text-gray-500 text-xs"},Je={key:1,class:"text-gray-400"},Ge={__name:"Index",props:{packages:Object,regions:Array,filters:Object,status:String,success:String,error:String},setup(r){const x=r,n=p(!1),h=p(!1),f=p(null),u=p([]),C=p("created_at"),y=p("desc"),d=p({search:x.filters.search||"",sticker_status:x.filters.sticker_status||"not_printed",region_id:x.filters.region_id||"",per_page:x.filters.per_page||15}),R=[{field:"selection",header:"",sortable:!1,width:"w-12"},{field:"item_code",header:"Package ID",sortable:!0},{field:"item_name",header:"Item Name",sortable:!0},{field:"destination_region",header:"Destination",sortable:!0},{field:"receiver",header:"Receiver",sortable:!1},{field:"waybill_number",header:"Waybill",sortable:!0},{field:"sticker_status",header:"Status",sortable:!0},{field:"sticker_printed_at",header:"Printed At",sortable:!0},{field:"actions",header:"Actions",sortable:!1,width:"w-48"}],T=se.debounce(()=>{b()},500);function b(){k.get(route("stickers.index"),d.value,{preserveState:!0,preserveScroll:!0,replace:!0,onStart:()=>n.value=!0,onFinish:()=>n.value=!1})}function U(){b()}function E(){d.value={search:"",sticker_status:"not_printed",region_id:"",per_page:15},b()}function L(i){C.value===i?y.value=y.value==="asc"?"desc":"asc":(C.value=i,y.value="asc")}async function W(){try{const i=await fetch(route("stickers.statistics"));f.value=await i.json(),h.value=!0}catch(i){console.error("Failed to fetch statistics:",i)}}async function B(i){n.value=!0;try{const e=`package_ids[]=${i.id}`,s=window.open(`${route("stickers.bulk-print")}?${e}`,"_blank");s?(s.focus(),setTimeout(()=>{k.reload({only:["packages"],preserveState:!0,preserveScroll:!0,onFinish:()=>{n.value=!1}})},1500)):(window.location.href=`${route("stickers.bulk-print")}?${e}`,n.value=!1)}catch(e){console.error("Print error:",e),n.value=!1}}async function O(){if(u.value.length!==0){n.value=!0;try{const i=u.value.map(s=>`package_ids[]=${s}`).join("&"),e=window.open(`${route("stickers.bulk-print")}?${i}`,"_blank");e?(e.focus(),setTimeout(()=>{k.reload({only:["packages"],preserveState:!0,preserveScroll:!0,onSuccess:()=>{u.value=[],n.value=!1}})},1500)):(window.location.href=`${route("stickers.bulk-print")}?${i}`,n.value=!1,u.value=[])}catch(i){console.error("Bulk print error:",i),n.value=!1}}}function M(i){confirm("Are you sure you want to reset this sticker? This will allow it to be printed again.")&&(n.value=!0,k.post(route("stickers.reset",i.id),{},{preserveScroll:!0,onSuccess:()=>{k.reload({only:["packages"]})},onFinish:()=>n.value=!1}))}function q(i){const e=u.value.indexOf(i);e===-1?u.value.push(i):u.value.splice(e,1)}function z(i){return new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}const H=i=>{u.value=i.map(e=>e.id)};return J(d,i=>{const e=new URLSearchParams;Object.entries(i).forEach(([s,m])=>{m&&e.set(s,m)}),window.history.replaceState({},"",`${window.location.pathname}?${e}`)},{deep:!0}),G(()=>{const i=new URLSearchParams(window.location.search);Object.keys(d.value).forEach(e=>{i.has(e)&&(d.value[e]=i.get(e))})}),(i,e)=>(l(),w(Y,null,{header:a(()=>[t("div",oe,[e[8]||(e[8]=t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Sticker Management",-1)),t("div",ae,[h.value?(l(),w(D,{key:1,onClick:e[0]||(e[0]=s=>h.value=!1)},{default:a(()=>e[7]||(e[7]=[_(" Hide Statistics ")])),_:1})):(l(),w(S,{key:0,onClick:W},{default:a(()=>e[6]||(e[6]=[_(" View Statistics ")])),_:1}))])])]),default:a(()=>[t("div",le,[r.status||r.success||r.error?(l(),c("div",re,[r.status?(l(),c("div",ne,o(r.status),1)):v("",!0),r.success?(l(),c("div",de,o(r.success),1)):v("",!0),r.error?(l(),c("div",ce,o(r.error),1)):v("",!0)])):v("",!0),h.value&&f.value?(l(),c("div",ue,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold mb-4"},"Sticker Statistics",-1)),t("div",ge,[t("div",me,[t("div",fe,o(f.value.total_packages),1),e[9]||(e[9]=t("div",{class:"text-sm text-blue-800"},"Total Packages",-1))]),t("div",pe,[t("div",ve,o(f.value.printed_packages),1),e[10]||(e[10]=t("div",{class:"text-sm text-green-800"},"Printed",-1))]),t("div",_e,[t("div",be,o(f.value.not_printed_packages),1),e[11]||(e[11]=t("div",{class:"text-sm text-yellow-800"},"Not Printed",-1))]),t("div",ke,[t("div",xe,o(f.value.print_rate)+"%",1),e[12]||(e[12]=t("div",{class:"text-sm text-purple-800"},"Print Rate",-1))])]),e[14]||(e[14]=t("h4",{class:"text-md font-semibold mb-3"},"Packages by Region",-1)),t("div",he,[(l(!0),c(j,null,F(f.value.packages_by_region,s=>(l(),c("div",{key:s.region_name,class:"flex items-center justify-between p-3 border rounded-lg"},[t("div",ye,[t("div",{class:"w-4 h-4 rounded-full mr-2 border",style:N({backgroundColor:s.color_hex})},null,4),t("span",we,o(s.region_name),1)]),t("span",Se,o(s.package_count),1)]))),128))])])):v("",!0),t("div",Pe,[t("div",Ce,[t("div",null,[g(P,{for:"search",value:"Search Packages"}),g(Z,{id:"search",modelValue:d.value.search,"onUpdate:modelValue":e[1]||(e[1]=s=>d.value.search=s),placeholder:"Package ID, Item, Waybill, Receiver...",class:"w-full mt-1",onInput:K(T)},null,8,["modelValue","onInput"])]),t("div",null,[g(P,{for:"sticker_status",value:"Sticker Status"}),I(t("select",{id:"sticker_status","onUpdate:modelValue":e[2]||(e[2]=s=>d.value.sticker_status=s),class:"w-full mt-1 border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",onChange:b},e[15]||(e[15]=[t("option",{value:"all"},"All Status",-1),t("option",{value:"not_printed"},"Not Printed",-1),t("option",{value:"printed"},"Printed",-1)]),544),[[V,d.value.sticker_status]])]),t("div",null,[g(P,{for:"region_id",value:"Destination Region"}),I(t("select",{id:"region_id","onUpdate:modelValue":e[3]||(e[3]=s=>d.value.region_id=s),class:"w-full mt-1 border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",onChange:b},[e[16]||(e[16]=t("option",{value:""},"All Regions",-1)),(l(!0),c(j,null,F(r.regions,s=>(l(),c("option",{key:s.id,value:s.id},o(s.name),9,$e))),128))],544),[[V,d.value.region_id]])]),t("div",null,[g(P,{for:"per_page",value:"Items per page"}),I(t("select",{id:"per_page","onUpdate:modelValue":e[4]||(e[4]=s=>d.value.per_page=s),class:"w-full mt-1 border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",onChange:b},e[17]||(e[17]=[t("option",{value:"10"},"10 items",-1),t("option",{value:"15"},"15 items",-1),t("option",{value:"25"},"25 items",-1),t("option",{value:"50"},"50 items",-1)]),544),[[V,d.value.per_page]])])]),t("div",je,[t("div",Fe," Showing "+o(r.packages.from)+" to "+o(r.packages.to)+" of "+o(r.packages.total)+" results ",1),t("div",Ie,[g(D,{onClick:E},{default:a(()=>e[18]||(e[18]=[_("Clear Filters")])),_:1}),g(S,{onClick:U,disabled:n.value},{default:a(()=>e[19]||(e[19]=[_(" Apply Filters ")])),_:1},8,["disabled"])])])]),u.value.length>0?(l(),c("div",Ve,[t("div",De,[t("span",Re,o(u.value.length)+" package(s) selected ",1),g(S,{onClick:O,disabled:n.value},{default:a(()=>e[20]||(e[20]=[_(" Print Selected ")])),_:1},8,["disabled"])])])):v("",!0),t("div",Ne,[t("div",Ae,[g(ee,{columns:R,data:r.packages.data,"sort-field":C.value,"sort-direction":y.value,onSort:L,class:"w-full",selectable:"",onSelectionChange:H},{row:a(({row:s,index:m})=>[t("tr",{class:A(["cursor-pointer transition-colors",u.value.includes(s.id)?"bg-indigo-50 hover:bg-indigo-100":m%2===0?"bg-white hover:bg-gray-50":"bg-gray-50 hover:bg-gray-100"])},[(l(),c(j,null,F(R,$=>t("td",{key:$.field,class:"px-4 py-3 whitespace-nowrap",onClick:Ke=>$.field==="actions"?null:q(s.id)},[X(i.$slots,$.field,{row:s},void 0,!0)],8,Te)),64))],2)]),item_code:a(({row:s})=>[t("span",Ue,o(s.item_code),1)]),item_name:a(({row:s})=>[t("div",Ee,[t("span",Le,o(s.item_name),1)])]),destination_region:a(({row:s})=>[t("div",We,[t("div",{class:"w-4 h-4 rounded-full mr-2 border border-gray-300",style:N({backgroundColor:s.destination_region.color_hex})},null,4),t("span",null,o(s.destination_region.name),1)])]),receiver:a(({row:s})=>[t("div",Be,[t("div",Oe,o(s.receiver.name),1),t("div",Me,o(s.receiver.address),1)])]),waybill_number:a(({row:s})=>{var m;return[t("span",qe,o(((m=s.waybill)==null?void 0:m.waybill_number)||"N/A"),1)]}),sticker_status:a(({row:s})=>[t("span",{class:A([[s.sticker_printed_at?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"],"px-2 py-1 text-xs font-medium rounded-full"])},o(s.sticker_printed_at?"Printed":"Not Printed"),3)]),sticker_printed_at:a(({row:s})=>[s.sticker_printed_at?(l(),c("div",ze,[t("div",null,o(z(s.sticker_printed_at)),1),t("div",He," by "+o(s.sticker_printed_by||"System"),1)])):(l(),c("span",Je,"-"))]),actions:a(({row:s})=>[t("div",{class:"flex space-x-2 justify-end",onClick:e[5]||(e[5]=Q(()=>{},["stop"]))},[g(S,{onClick:m=>B(s),disabled:n.value,class:"text-xs py-1 px-2 min-w-[60px]"},{default:a(()=>e[21]||(e[21]=[_(" Print ")])),_:2},1032,["onClick","disabled"]),s.sticker_printed_at?(l(),w(D,{key:0,onClick:m=>M(s),disabled:n.value,class:"text-xs py-1 px-2 min-w-[60px]"},{default:a(()=>e[22]||(e[22]=[_(" Reset ")])),_:2},1032,["onClick","disabled"])):v("",!0)])]),_:3},8,["data","sort-field","sort-direction"]),g(te,{links:r.packages.links,class:"mt-6"},null,8,["links"])])])])]),_:3}))}},dt=ie(Ge,[["__scopeId","data-v-70ffaef0"]]);export{dt as default};
