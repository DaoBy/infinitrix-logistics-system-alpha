import{E as ie}from"./EmployeeLayout-D01AghRc.js";import{_ as w}from"./PrimaryButton-7U4Qu6md.js";import{_ as S}from"./SecondaryButton-BoCxbQ9w.js";import{_ as ce}from"./SearchInput-g_WCWFPT.js";import{S as W}from"./SelectInput-BaEQ9Gfo.js";import{_ as me}from"./DataTable-C5A94wxb.js";import{P as H}from"./Pagination-D3KPnYBN.js";import{p as fe,g as G,i as h,d as _,o as l,w as a,b as s,t as d,a as m,f,c as u,e as i,u as j,P as k,n as J,W as v}from"./app-BOCrhSfO.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-DsrNUkqS.js";import"./DangerButton-CBhu99um.js";const ge={class:"flex justify-between items-center w-full px-6 md:px-8"},xe={class:"flex gap-2"},_e={class:"px-6 py-4"},ye={class:"grid grid-cols-1 gap-5 sm:grid-cols-3 mb-6"},he={class:"bg-white overflow-hidden shadow rounded-lg"},ve={class:"px-4 py-5 sm:p-6"},be={class:"mt-1 text-3xl font-semibold text-gray-900"},je={class:"bg-white overflow-hidden shadow rounded-lg"},ke={class:"px-4 py-5 sm:p-6"},Ae={class:"mt-1 text-3xl font-semibold text-gray-900"},Ce={class:"bg-white overflow-hidden shadow rounded-lg"},we={class:"px-4 py-5 sm:p-6"},Se={class:"mt-1 text-3xl font-semibold text-gray-900"},Ve={class:"mb-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3"},Ne={class:"w-full sm:w-96"},Pe={class:"flex items-center gap-3"},De={class:"text-sm text-gray-500 bg-blue-50 px-3 py-1 rounded border border-blue-100 whitespace-nowrap"},Re={key:0,class:"ml-1"},qe={class:"justify-center flex items-center"},Be={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-full max-w-[98vw]"},Ie={class:"p-4 bg-white border-b border-gray-200"},Te={class:"flex items-center space-x-2"},Oe={class:"font-bold text-green-700 tracking-wide text-sm"},Fe={class:"text-xs text-gray-500 mt-1"},Le={key:0},Me={key:0},Ue={class:"text-sm font-medium text-gray-900 mb-1"},ze={class:"text-xs text-gray-500 space-y-1"},Ee={key:0,class:"flex items-center gap-1"},$e={key:1,class:"flex items-center gap-1"},We={key:2,class:"text-gray-400"},He={key:1,class:"text-sm text-gray-500"},Ge={class:"text-sm text-gray-900"},Je={class:"text-sm text-gray-900"},Ke={key:0},Qe={key:1,class:"text-gray-400"},Xe={class:"text-sm text-gray-900"},Ye={key:0},Ze={key:1,class:"text-gray-400"},et={class:"text-sm text-gray-500"},tt={class:"flex space-x-2"},st={class:"text-center py-8"},nt={class:"bg-gray-50 rounded-lg p-6 max-w-md mx-auto"},at={class:"text-gray-500 mb-3"},dt={class:"mt-4 flex justify-between items-center"},rt={__name:"Index",props:{refunds:Object,needsAdjustment:Object,stats:{type:Object,default:()=>({pending_refunds:0,pending_adjustments:0,needs_adjustment:0})},filters:Object},setup(c){var q,B,I;const o=c,r=fe({search:((q=o.filters)==null?void 0:q.search)||"",type:((B=o.filters)==null?void 0:B.type)||"",status:((I=o.filters)==null?void 0:I.status)||""}),V=G("created_at"),N=G("desc"),K=[{field:"type",header:"Type",sortable:!0},{field:"reference",header:"Reference",sortable:!0},{field:"sender",header:"Sender",sortable:!1},{field:"original_amount",header:"Original Amount",sortable:!0},{field:"refund_amount",header:"Adjustment/Refund",sortable:!0},{field:"adjusted_amount",header:"New Amount Due",sortable:!0},{field:"status",header:"Status",sortable:!0},{field:"created_at",header:"Created",sortable:!0},{field:"actions",header:"Actions",sortable:!1}],Q=[{value:"",text:"All Types"},{value:"refund",text:"Refund"},{value:"adjustment",text:"Adjustment"},{value:"needs_adjustment",text:"Needs Adjustment"}],X=[{value:"",text:"All Statuses"},{value:"pending",text:"Pending Refund"},{value:"pending_adjustment",text:"Pending Adjustment"},{value:"processed",text:"Processed Refund"},{value:"adjusted",text:"Adjusted Invoice"},{value:"needs_adjustment",text:"Needs Adjustment"}],P=h(()=>{var n,t,g,x;return(((t=(n=o.refunds)==null?void 0:n.data)==null?void 0:t.length)||0)+(((x=(g=o.needsAdjustment)==null?void 0:g.data)==null?void 0:x.length)||0)}),Y=h(()=>{var n;return((n=o.refunds)==null?void 0:n.current_page)||1}),Z=h(()=>{var n;return((n=o.refunds)==null?void 0:n.last_page)||1}),ee=h(()=>{var n,t;return((n=o.refunds)==null?void 0:n.total)>((t=o.refunds)==null?void 0:t.per_page)}),te=h(()=>{var g,x,y,e;const n=((x=(g=o.refunds)==null?void 0:g.data)==null?void 0:x.map(p=>({...p,isRefund:!0})))||[],t=((e=(y=o.needsAdjustment)==null?void 0:y.data)==null?void 0:e.map(p=>({...p,type:null,status:"needs_adjustment",status_label:"Awaiting Action"})))||[];return[...n,...t]});function A(n){return n&&(n.mobile||n.phone)||null}function C(n){return n&&n.email||null}function D(n){return n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}function b(){const n={...r,page:1};v.visit(route("refunds.index"),{data:n,preserveState:!0,preserveScroll:!0,replace:!0})}let R=null;function se(){clearTimeout(R),R=setTimeout(()=>{b()},500)}function ne(){r.search="",r.type="",r.status="",b()}function ae(n){V.value=n.field,N.value=n.direction;const t={...r,sort:n.field,direction:n.direction};v.visit(route("refunds.index"),{data:t,preserveState:!0,preserveScroll:!0,replace:!0})}function de(n){const t={...r,page:n};v.visit(route("refunds.index"),{data:t,preserveState:!0,preserveScroll:!0,replace:!0})}function re(n){const t={...r,adjustment_page:n};v.visit(route("refunds.index"),{data:t,preserveState:!0,preserveScroll:!0,replace:!0})}function le(){v.reload()}function oe(n){return{refund:"bg-purple-100 text-purple-800",adjustment:"bg-orange-100 text-orange-800"}[n]||"bg-orange-100 text-orange-800"}function ue(n){return{pending:"bg-yellow-100 text-yellow-800",pending_adjustment:"bg-yellow-100 text-yellow-800",processed:"bg-green-100 text-green-800",adjusted:"bg-green-100 text-green-800",needs_adjustment:"bg-yellow-100 text-yellow-800"}[n]||"bg-gray-100 text-gray-800"}return(n,t)=>(l(),_(ie,null,{header:a(()=>[s("div",ge,[t[5]||(t[5]=s("div",null,[s("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Refunds & Adjustments"),s("p",{class:"mt-1 text-sm text-gray-500"}," Manage customer refunds and invoice adjustments for delivery issues. ")],-1)),s("div",xe,[m(S,{onClick:le},{default:a(()=>t[3]||(t[3]=[f("Refresh Data")])),_:1}),m(j(k),{href:n.route("refunds.create")},{default:a(()=>[m(w,null,{default:a(()=>t[4]||(t[4]=[f(" Create Refund/Adjustment ")])),_:1})]),_:1},8,["href"])])])]),default:a(()=>{var g,x,y;return[s("div",_e,[s("div",ye,[s("div",he,[s("div",ve,[t[6]||(t[6]=s("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Pending Refunds",-1)),s("dd",be,d(((g=c.stats)==null?void 0:g.pending_refunds)||0),1)])]),s("div",je,[s("div",ke,[t[7]||(t[7]=s("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Pending Adjustments",-1)),s("dd",Ae,d(((x=c.stats)==null?void 0:x.pending_adjustments)||0),1)])]),s("div",Ce,[s("div",we,[t[8]||(t[8]=s("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Needs Adjustment",-1)),s("dd",Se,d(((y=c.stats)==null?void 0:y.needs_adjustment)||0),1)])])]),s("div",Ve,[s("div",Ne,[m(ce,{modelValue:r.search,"onUpdate:modelValue":t[0]||(t[0]=e=>r.search=e),placeholder:"Search by reference number or sender...",class:"w-full",onInput:se},null,8,["modelValue"])]),s("div",Pe,[m(W,{modelValue:r.type,"onUpdate:modelValue":t[1]||(t[1]=e=>r.type=e),options:Q,"option-value":"value","option-label":"text",placeholder:"All Types",class:"w-full sm:w-48",onChange:b},null,8,["modelValue"]),m(W,{modelValue:r.status,"onUpdate:modelValue":t[2]||(t[2]=e=>r.status=e),options:X,"option-value":"value","option-label":"text",placeholder:"All Statuses",class:"w-full sm:w-48",onChange:b},null,8,["modelValue"]),s("div",De,[f(" ðŸ“¦ Showing "+d(P.value)+" "+d(P.value===1?"item":"items")+" ",1),ee.value?(l(),u("span",Re," (Page "+d(Y.value)+" of "+d(Z.value)+") ",1)):i("",!0)])])]),s("div",qe,[s("div",Be,[s("div",Ie,[m(me,{columns:K,data:te.value,"sort-field":V.value,"sort-direction":N.value,onSort:ae,class:"w-full"},{type:a(({row:e})=>[s("span",{class:J([oe(e.type),"inline-flex px-2 text-xs font-semibold leading-5 rounded-full"])},d(e.type_label||"Needs Adjustment"),3)]),reference:a(({row:e})=>{var p;return[s("div",Te,[t[9]||(t[9]=s("span",{class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-green-100 text-green-800"}," Ref ",-1)),s("span",Oe,d(((p=e.delivery_request)==null?void 0:p.reference_number)||e.reference_number),1)]),s("div",Fe,[f(" ID: DR-"+d(String(e.delivery_request_id||e.id).padStart(6,"0"))+" ",1),e.created_at||e.updated_at?(l(),u("span",Le," | "+d(e.type?"Created":"Updated")+": "+d(D(e.created_at||e.updated_at)),1)):i("",!0)])]}),sender:a(({row:e})=>{var p,T,O,F,L,M,U,z,E,$;return[(p=e.delivery_request)!=null&&p.sender||e.sender?(l(),u("div",Me,[s("div",Ue,d(((O=(T=e.delivery_request)==null?void 0:T.sender)==null?void 0:O.name)||((F=e.sender)==null?void 0:F.name)||"N/A"),1),s("div",ze,[A(((L=e.delivery_request)==null?void 0:L.sender)||e.sender)?(l(),u("div",Ee,[t[10]||(t[10]=s("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),f(" "+d(A(((M=e.delivery_request)==null?void 0:M.sender)||e.sender)),1)])):i("",!0),C(((U=e.delivery_request)==null?void 0:U.sender)||e.sender)?(l(),u("div",$e,[t[11]||(t[11]=s("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),f(" "+d(C(((z=e.delivery_request)==null?void 0:z.sender)||e.sender)),1)])):i("",!0),!A(((E=e.delivery_request)==null?void 0:E.sender)||e.sender)&&!C((($=e.delivery_request)==null?void 0:$.sender)||e.sender)?(l(),u("div",We," No contact info ")):i("",!0)])])):(l(),u("div",He,"No sender info"))]}),original_amount:a(({row:e})=>[s("span",Ge," â‚±"+d(e.original_amount||e.total_price),1)]),refund_amount:a(({row:e})=>[s("span",Je,[e.refund_amount?(l(),u("span",Ke,"â‚±"+d(e.refund_amount),1)):(l(),u("span",Qe,"â€”"))])]),adjusted_amount:a(({row:e})=>[s("span",Xe,[e.adjusted_amount?(l(),u("span",Ye,"â‚±"+d(e.adjusted_amount),1)):(l(),u("span",Ze,"â€”"))])]),status:a(({row:e})=>[s("span",{class:J([ue(e.status),"inline-flex px-2 text-xs font-semibold leading-5 rounded-full"])},d(e.status_label||"Awaiting Action"),3)]),created_at:a(({row:e})=>[s("span",et,d(D(e.created_at||e.updated_at)),1)]),actions:a(({row:e})=>[s("div",tt,[e.type?(l(),_(j(k),{key:0,href:n.route("refunds.show",{refund:e.id})},{default:a(()=>[m(S,{class:"text-xs py-1 px-2"},{default:a(()=>t[12]||(t[12]=[f(" View ")])),_:1})]),_:2},1032,["href"])):i("",!0),e.type&&(e.status==="pending"||e.status==="pending_adjustment")?(l(),_(j(k),{key:1,href:n.route("refunds.edit",{refund:e.id})},{default:a(()=>[m(w,{class:"text-xs py-1 px-2"},{default:a(()=>[f(d(e.type==="adjustment"?"Adjust":"Negotiate"),1)]),_:2},1024)]),_:2},1032,["href"])):i("",!0),e.type?i("",!0):(l(),_(j(k),{key:2,href:n.route("refunds.create",{delivery_request_id:e.id})},{default:a(()=>[m(w,{class:"text-xs py-1 px-2"},{default:a(()=>t[13]||(t[13]=[f(" Create Adjustment ")])),_:1})]),_:2},1032,["href"]))])]),empty:a(()=>[s("div",st,[s("div",nt,[t[15]||(t[15]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-10 w-10 text-gray-400 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),t[16]||(t[16]=s("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No refunds or adjustments found",-1)),s("p",at,d(r.search||r.type||r.status?"Try adjusting your search terms or filters":"No refunds or adjustments are currently being processed"),1),r.search||r.type||r.status?(l(),_(S,{key:0,onClick:ne,class:"mt-2"},{default:a(()=>t[14]||(t[14]=[f(" Clear Filters ")])),_:1})):i("",!0)])])]),_:1},8,["data","sort-field","sort-direction"]),s("div",dt,[c.refunds.data&&c.refunds.data.length>0?(l(),_(H,{key:0,pagination:c.refunds,onPageChanged:de},null,8,["pagination"])):i("",!0),c.needsAdjustment.data&&c.needsAdjustment.data.length>0?(l(),_(H,{key:1,pagination:c.needsAdjustment,onPageChanged:re},null,8,["pagination"])):i("",!0)])])])])])]}),_:1}))}},yt=pe(rt,[["__scopeId","data-v-432cb467"]]);export{yt as default};
