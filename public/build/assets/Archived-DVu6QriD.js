import{g as n,h as I,W as f,d as N,o as i,w as l,b as s,a as o,c as p,e as R,f as a,t as r,F,r as W,u as z,P as G,n as J}from"./app-DSvpKds8.js";import{E as K}from"./EmployeeLayout-41rkCMFi.js";import{_ as A}from"./SecondaryButton-BMk3kL1H.js";import{D as M}from"./DangerButton-Bd5m9G75.js";import{_ as Q}from"./SearchInput-BdZpY5qg.js";import{S as L}from"./SelectInput-CJKTp_P8.js";import{_ as X}from"./DataTable-Bq8Hbpmy.js";import{M as Y}from"./Modal-CPqIeUsw.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-B7vUiQXa.js";const ee={class:"flex justify-between items-center px-6"},te={class:"flex space-x-2"},se={class:"px-6 sm:px-8"},le={class:"mb-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 w-full mx-auto"},ae={class:"flex flex-wrap gap-2 w-full md:w-auto"},oe={class:"justify-center flex items-center"},re={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-center"},ne={class:"p-5 bg-white border-b border-gray-200"},ie={class:"truncate block w-48"},ue={class:"truncate block w-48"},ce={class:"truncate block w-48"},de={class:"flex space-x-2 min-w-[200px]"},me={key:0,class:"mt-4 flex justify-center"},fe={class:"flex flex-wrap -mb-1"},pe=["innerHTML"],ve={class:"p-6"},ye={class:"mt-1 text-sm text-gray-600"},_e={class:"mt-6 flex justify-end space-x-4"},xe={key:0},he={key:1},ge={__name:"Archived",props:{customers:Object,status:String,success:String,error:String},setup(x){var k,D,S,V,T;const v=x,C=n(!1),c=n(null),y=n(!1),h=n(((k=v.customers.filters)==null?void 0:k.search)||""),g=n(((D=v.customers.filters)==null?void 0:D.customer_category)||""),b=n(((S=v.customers.filters)==null?void 0:S.frequency_type)||""),_=n(((V=v.customers.filters)==null?void 0:V.sort_field)||"archived_at"),d=n(((T=v.customers.filters)==null?void 0:T.sort_direction)||"desc"),j=[{value:"",text:"All Types"},{value:"individual",text:"Individual"},{value:"company",text:"Company"}],O=[{value:"",text:"All Frequencies"},{value:"regular",text:"Regular"},{value:"occasional",text:"Occasional"}],P=[{field:"name",header:"Name",sortable:!0},{field:"company_name",header:"Company",sortable:!0},{field:"email",header:"Email",sortable:!0},{field:"mobile",header:"Mobile",sortable:!1},{field:"customer_category",header:"Type",sortable:!0},{field:"frequency_type",header:"Frequency",sortable:!0},{field:"total_orders",header:"Orders",sortable:!0},{field:"archived_at",header:"Archived On",sortable:!0},{field:"status",header:"Status",sortable:!0},{field:"actions",header:"Actions",sortable:!1}],B=u=>{_.value===u?d.value=d.value==="asc"?"desc":"asc":(_.value=u,d.value="asc")},U=u=>{c.value=u,C.value=!0},w=()=>{C.value=!1,setTimeout(()=>{c.value=null,y.value=!1},300)},$=async()=>{if(c.value){y.value=!0;try{await f.delete(route("admin.customers.destroy",c.value.id),{preserveScroll:!0}),w(),f.reload({only:["customers"]})}catch{w(),alert("Failed to delete customer. Please try again.")}finally{y.value=!1}}},E=u=>{f.put(route("admin.customers.restore",u.id),{},{preserveScroll:!0,onSuccess:()=>{f.reload()}})},H=()=>f.get(route("admin.customers.index"));return I([h,g,b,_,d],()=>{f.get(route("admin.customers.archived"),{search:h.value,customer_category:g.value,frequency_type:b.value,sort_field:_.value,sort_direction:d.value,page:1},{preserveState:!0,replace:!0})},{deep:!0}),(u,t)=>(i(),N(K,null,{header:l(()=>[s("div",ee,[t[4]||(t[4]=s("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Archived Customers",-1)),s("div",te,[o(A,{onClick:H},{default:l(()=>t[3]||(t[3]=[a("View Active Customers")])),_:1})])])]),default:l(()=>{var q;return[s("div",se,[s("div",le,[o(Q,{modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=e=>h.value=e),placeholder:"Search archived customers...",class:"w-full md:w-72"},null,8,["modelValue"]),s("div",ae,[o(L,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=e=>g.value=e),options:j,"option-value":"value","option-label":"text",placeholder:"All Types",class:"w-full md:w-48"},null,8,["modelValue"]),o(L,{modelValue:b.value,"onUpdate:modelValue":t[2]||(t[2]=e=>b.value=e),options:O,"option-value":"value","option-label":"text",placeholder:"All Frequencies",class:"w-full md:w-48"},null,8,["modelValue"])])]),s("div",oe,[s("div",re,[s("div",ne,[o(X,{columns:P,data:x.customers.data,"sort-field":_.value,"sort-direction":d.value,onSort:B,class:"w-full"},{name:l(({row:e})=>[s("span",ie,r(e.name),1)]),company_name:l(({row:e})=>[s("span",ue,r(e.company_name||"N/A"),1)]),email:l(({row:e})=>[s("span",ce,r(e.email||"N/A"),1)]),mobile:l(({row:e})=>[a(r(e.mobile||"N/A"),1)]),customer_category:l(({row:e})=>[a(r(e.customer_category?e.customer_category.charAt(0).toUpperCase()+e.customer_category.slice(1):"N/A"),1)]),frequency_type:l(({row:e})=>[a(r(e.frequency_type?e.frequency_type.charAt(0).toUpperCase()+e.frequency_type.slice(1):"N/A"),1)]),total_orders:l(({row:e})=>[a(r(e.total_orders||0),1)]),archived_at:l(({row:e})=>[a(r(e.archived_at?new Date(e.archived_at).toLocaleDateString():"N/A"),1)]),status:l(({row:e})=>t[5]||(t[5]=[s("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"}," Archived ",-1)])),actions:l(({row:e})=>[s("div",de,[o(A,{onClick:m=>E(e)},{default:l(()=>t[6]||(t[6]=[a("Restore")])),_:2},1032,["onClick"]),o(M,{onClick:m=>U(e)},{default:l(()=>t[7]||(t[7]=[a("Delete Permanently")])),_:2},1032,["onClick"])])]),_:1},8,["data","sort-field","sort-direction"]),((q=x.customers.links)==null?void 0:q.length)>3?(i(),p("div",me,[s("div",fe,[(i(!0),p(F,null,W(x.customers.links,(e,m)=>(i(),p(F,{key:m},[e.url?(i(),N(z(G),{key:1,class:J(["mr-1 mb-1 px-4 py-3 text-sm leading-4 border rounded hover:bg-white focus:border-indigo-500 focus:text-indigo-500",{"bg-blue-700 text-white":e.active}]),href:e.url,innerHTML:e.label},null,8,["class","href","innerHTML"])):(i(),p("div",{key:0,class:"mr-1 mb-1 px-4 py-3 text-sm leading-4 text-gray-400 border rounded",innerHTML:e.label},null,8,pe))],64))),128))])])):R("",!0)])])])]),o(Y,{show:C.value,onClose:w},{default:l(()=>{var e,m;return[s("div",ve,[t[11]||(t[11]=s("h2",{class:"text-lg font-medium text-gray-900"},"Delete Customer Permanently?",-1)),s("p",ye,[t[8]||(t[8]=a(" Are you sure you want to permanently delete ")),s("strong",null,r(((e=c.value)==null?void 0:e.name)||((m=c.value)==null?void 0:m.company_name)),1),t[9]||(t[9]=a("? This action cannot be undone. "))]),s("div",_e,[o(A,{onClick:w},{default:l(()=>t[10]||(t[10]=[a("Cancel")])),_:1}),o(M,{onClick:$,disabled:y.value},{default:l(()=>[y.value?(i(),p("span",xe,"Deleting...")):(i(),p("span",he,"Delete Permanently"))]),_:1},8,["disabled"])])])]}),_:1},8,["show"])]}),_:1}))}},Ne=Z(ge,[["__scopeId","data-v-a9a58c5b"]]);export{Ne as default};
