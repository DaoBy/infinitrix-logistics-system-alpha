import{_ as U}from"./DataTable-BArupUOg.js";import{_ as q}from"./SecondaryButton-f4DzqSLc.js";import{P as z}from"./Pagination-clkSGD3h.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{g as h,i as L,c as _,o as p,a as C,d as S,e as D,w as i,b as u,f as N,t as o,n as P}from"./app-BllHWhcy.js";const O={class:"font-medium"},Y={key:1,class:"inline-block px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},G={class:"font-medium"},J={class:"flex items-center justify-start space-x-2 w-full overflow-hidden"},K={__name:"TransactionHistoryTable",props:{transactions:Object},emits:["view-request","view-payment"],setup(y){const a=h("delivery_date"),c=h("desc"),T=[{field:"reference_number",header:"Reference #",sortable:!0},{field:"receiver",header:"Receiver",sortable:!0},{field:"pickup",header:"Pickup Branch",sortable:!0},{field:"dropoff",header:"Dropoff Branch",sortable:!0},{field:"delivery_date",header:"Delivery Date",sortable:!0},{field:"payment_status",header:"Payment Status",sortable:!0},{field:"status",header:"Delivery Status",sortable:!0},{field:"total_amount",header:"Total",sortable:!0},{field:"actions",header:"Actions",sortable:!1,style:"width: 200px;"}],B=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"completed":case"delivered":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";case"in_transit":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},V=e=>e==="paid"?"text-green-800 bg-green-100":e==="rejected"?"text-red-800 bg-red-100":e==="pending_verification"?"text-blue-800 bg-blue-100":e==="pending_payment"?"text-yellow-800 bg-yellow-100":"text-gray-800 bg-gray-100",$=L(()=>{var e;return(e=y.transactions)!=null&&e.data?y.transactions.data.slice().sort((r,l)=>{var n,s,f,m,g,b,x,k;if(!a.value)return 0;const t=c.value==="asc"?1:-1;return a.value==="reference_number"?(r.reference_number||"").localeCompare(l.reference_number||"")*t:a.value==="pickup"?(((s=(n=r.delivery_request)==null?void 0:n.pick_up_region)==null?void 0:s.name)||"").localeCompare(((m=(f=l.delivery_request)==null?void 0:f.pick_up_region)==null?void 0:m.name)||"")*t:a.value==="dropoff"?(((b=(g=r.delivery_request)==null?void 0:g.drop_off_region)==null?void 0:b.name)||"").localeCompare(((k=(x=l.delivery_request)==null?void 0:x.drop_off_region)==null?void 0:k.name)||"")*t:a.value==="payment_status"?(d(r)||"").localeCompare(d(l)||"")*t:r[a.value]<l[a.value]?-1*t:r[a.value]>l[a.value]?1*t:0}):[]});function j(e){a.value===e?c.value=c.value==="asc"?"desc":"asc":(a.value=e,c.value="asc")}const I=e=>!e||Number(e)===0?"0.00":Number(e).toFixed(2),A=e=>{if(!e)return"—";const r=new Date(e);return isNaN(r.getTime())||r.getFullYear()===1970?"—":r.toLocaleDateString()},F=e=>!e||typeof e!="string"?"":e==="completed"?"Completed":e==="delivered"?"Delivered":e.charAt(0).toUpperCase()+e.slice(1),H=e=>!e||typeof e!="string"?"":e.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase());function d(e){return e.payment_status?e.payment_status:e.payment&&e.payment.status?e.payment.status:e.delivery_request&&e.delivery_request.payment_status?e.delivery_request.payment_status:e.delivery_request&&e.delivery_request.payment&&e.delivery_request.payment.status?e.delivery_request.payment.status:e.payment&&e.payment.rejected_by?"rejected":""}const R=e=>{const r=d(e);return v(e)&&["pending_verification","paid"].includes(r)},v=e=>e.payment&&e.payment.id?e.payment.id:e.delivery_request&&e.delivery_request.payment&&e.delivery_request.payment.id?e.delivery_request.payment.id:null;return(e,r)=>{var l;return p(),_("div",null,[C(U,{columns:T,data:$.value,"sort-field":a.value,"sort-direction":c.value,onSort:j,class:"w-full"},{reference_number:i(({row:t})=>[u("span",O,o(t.reference_number||`#${t.id.toString().padStart(6,"0")}`),1)]),receiver:i(({row:t})=>{var n,s,f,m;return[u("span",null,o(((s=(n=t.delivery_request)==null?void 0:n.receiver)==null?void 0:s.name)||((m=(f=t.delivery_request)==null?void 0:f.receiver)==null?void 0:m.company_name)||"Not specified"),1)]}),pickup:i(({row:t})=>{var n,s;return[u("span",null,o(((s=(n=t.delivery_request)==null?void 0:n.pick_up_region)==null?void 0:s.name)||"Not specified"),1)]}),dropoff:i(({row:t})=>{var n,s;return[u("span",null,o(((s=(n=t.delivery_request)==null?void 0:n.drop_off_region)==null?void 0:s.name)||"Not specified"),1)]}),delivery_date:i(({row:t})=>[u("span",null,o(A(t.delivery_date)),1)]),payment_status:i(({row:t})=>[d(t)?(p(),_("span",{key:0,class:P(["inline-block px-3 py-1 rounded-full text-xs font-medium",V(d(t))])}," Payment: "+o(H(d(t))),3)):(p(),_("span",Y,"N/A"))]),status:i(({row:t})=>[u("span",{class:P(["inline-block px-3 py-1 rounded-full text-xs font-medium",B(t.status)])},o(F(t.status)),3)]),total_amount:i(({row:t})=>[u("span",G," ₱"+o(I(t.total_amount)),1)]),actions:i(({row:t})=>[u("div",J,[C(q,{class:"!px-3 !py-1.5 text-xs",onClick:n=>e.$emit("view-request",t.delivery_request.id)},{default:i(()=>r[0]||(r[0]=[N(" View Delivery ")])),_:2},1032,["onClick"]),R(t)?(p(),S(q,{key:0,class:"!px-3 !py-1.5 text-xs",onClick:n=>e.$emit("view-payment",v(t))},{default:i(()=>r[1]||(r[1]=[N(" View Payment ")])),_:2},1032,["onClick"])):D("",!0)])]),_:1},8,["data","sort-field","sort-direction"]),((l=y.transactions.links)==null?void 0:l.length)>3?(p(),S(z,{key:0,links:y.transactions.links,class:"mt-4"},null,8,["links"])):D("",!0)])}}},w=E(K,[["__scopeId","data-v-f35b4ef0"]]);export{w as T};
