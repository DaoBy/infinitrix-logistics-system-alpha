import{i as te,C as se,g as ae,h as oe,j as ie,d as de,o as p,w as x,b as l,c as b,e as k,t as y,s as ne,a as s,F as Z,r as G,n as v,u as r,v as me,L as ce,f as F,W as J}from"./app-BOCrhSfO.js";import{E as ue}from"./EmployeeLayout-D01AghRc.js";import{_ as K}from"./PrimaryButton-7U4Qu6md.js";import{_ as $}from"./SecondaryButton-BoCxbQ9w.js";import{_ as d}from"./InputLabel-ByB8oFns.js";import{T as c}from"./TextInput-fgBIPllX.js";import{_ as ge}from"./TextArea-B3xnA6tu.js";import{S as ve}from"./SelectInput-BaEQ9Gfo.js";import{_ as n}from"./InputError-D12BKN4o.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-DsrNUkqS.js";import"./DangerButton-CBhu99um.js";/* empty css                                                                  */const pe={class:"flex justify-between items-center w-full px-6 md:px-8"},ye={class:"text-xl font-semibold leading-tight text-gray-800"},be={class:"flex gap-2"},_e={key:0},fe={key:1},he={class:"px-6 py-4"},Ve={key:0,class:"mb-6"},xe={key:0,class:"p-4 bg-blue-100 text-blue-800 rounded"},ke={key:1,class:"p-4 bg-green-100 text-green-800 rounded"},we={key:2,class:"p-4 bg-red-100 text-red-800 rounded"},Ue={class:"bg-gray-50 border border-gray-200 rounded-lg p-6"},Ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},Fe={class:"text-gray-900"},$e={class:"text-gray-900 capitalize"},Ee={class:"text-gray-900"},Se={class:"text-gray-900"},Pe={class:"bg-white shadow-sm rounded-lg p-6"},Me={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Ne={class:"grid grid-cols-2 gap-4 mt-2"},Ie=["value"],Re={class:"text-sm font-medium text-gray-900"},Be={key:0},De={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6"},je={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6"},ze={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-6"},Te={class:"mt-6"},Ae={class:"bg-white shadow-sm rounded-lg p-6"},Le={class:"flex justify-between items-center mb-4"},Oe={class:"flex items-center justify-between"},We={class:"text-md font-medium text-gray-900"},qe=["onClick"],He={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ze={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Je={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-4 mt-6"},Ke={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},Qe={class:"font-semibold text-green-800"},Xe={class:"font-semibold text-green-800"},Ye={class:"font-semibold text-green-800"},el={class:"font-semibold text-green-800"},ll={class:"mt-3 pt-3 border-t border-green-200"},rl={class:"flex justify-between items-center"},tl={class:"text-xl font-bold text-green-800"},sl={class:"flex justify-end space-x-4 pt-6"},al={key:0},ol={key:1},hl={__name:"EditRequest",props:{delivery:Object,regions:Array,categories:Array,priceMatrix:Object,status:String,success:String,error:String},setup(g){var P,M,N,I,R,B,D,j,z,T,A,L,O,W,q,H;const o=g,Q=te(()=>o.categories.map(i=>({value:i,text:i.charAt(0).toUpperCase()+i.slice(1)}))),e=se({_method:"PUT",receiver:{customer_category:((P=o.delivery.receiver)==null?void 0:P.customer_category)||"individual",first_name:((M=o.delivery.receiver)==null?void 0:M.first_name)||"",middle_name:((N=o.delivery.receiver)==null?void 0:N.middle_name)||"",last_name:((I=o.delivery.receiver)==null?void 0:I.last_name)||"",company_name:((R=o.delivery.receiver)==null?void 0:R.company_name)||"",email:((B=o.delivery.receiver)==null?void 0:B.email)||"",mobile:((D=o.delivery.receiver)==null?void 0:D.mobile)||"",phone:((j=o.delivery.receiver)==null?void 0:j.phone)||"",building_number:((z=o.delivery.receiver)==null?void 0:z.building_number)||"",street:((T=o.delivery.receiver)==null?void 0:T.street)||"",barangay:((A=o.delivery.receiver)==null?void 0:A.barangay)||"",city:((L=o.delivery.receiver)==null?void 0:L.city)||"",province:((O=o.delivery.receiver)==null?void 0:O.province)||"",zip_code:((W=o.delivery.receiver)==null?void 0:W.zip_code)||"",notes:((q=o.delivery.receiver)==null?void 0:q.notes)||""},packages:((H=o.delivery.packages)==null?void 0:H.map(i=>({id:i.id||null,item_name:i.item_name||"",description:i.description||"",category:i.category||"",height:parseFloat(i.height)||0,width:parseFloat(i.width)||0,length:parseFloat(i.length)||0,weight:parseFloat(i.weight)||0,value:parseFloat(i.value)||0,photo_url:i.photo_url||""})))||[],pick_up_region_id:o.delivery.pick_up_region_id,drop_off_region_id:o.delivery.drop_off_region_id,payment_method:o.delivery.payment_method}),f=ae(null),X=[{value:"individual",label:"Individual"},{value:"company",label:"Company"}],Y=()=>{e.packages.push({item_name:"",description:"",category:"",height:0,width:0,length:0,weight:0,value:0,photo_url:""})},ee=i=>{e.packages.length>1&&(e.packages.splice(i,1),C())},C=()=>{if(!o.priceMatrix)return;const i=parseFloat(o.priceMatrix.base_fee)||0;let t=0,h=0,_=0;e.packages.forEach(V=>{const a=parseFloat(V.height)||0,m=parseFloat(V.width)||0,u=parseFloat(V.length)||0,le=parseFloat(V.weight)||0,re=a/100*(m/100)*(u/100);t+=re*(parseFloat(o.priceMatrix.volume_rate)||0),h+=le*(parseFloat(o.priceMatrix.weight_rate)||0),_+=parseFloat(o.priceMatrix.package_rate)||0});const U=i+t+h+_;f.value={base_fee:w(i),volume_fee:w(t),weight_fee:w(h),package_fee:w(_),total_price:w(U)}},w=i=>Math.round((i+Number.EPSILON)*100)/100,E=()=>{const i={...e.data(),packages:e.packages.map(t=>{const{photo_url:h,..._}=t;return _})};e.put(route("deliveries.update",o.delivery.id),i,{preserveScroll:!0,onSuccess:()=>{J.visit(route("deliveries.pending"))},onError:t=>{console.log("Form errors:",t)}})},S=()=>{J.visit(route("deliveries.pending"))};return oe(()=>e.packages,()=>{C()},{deep:!0}),ie(()=>{C()}),(i,t)=>(p(),de(ue,null,{header:x(()=>[l("div",pe,[l("div",null,[l("h2",ye," Edit Delivery Request #DR-"+y(String(g.delivery.id).padStart(6,"0")),1),t[14]||(t[14]=l("p",{class:"mt-1 text-sm text-gray-500"}," Update receiver information and package details ",-1))]),l("div",be,[s($,{onClick:S},{default:x(()=>t[15]||(t[15]=[F(" Cancel ")])),_:1}),s(K,{onClick:E,disabled:r(e).processing},{default:x(()=>[r(e).processing?(p(),b("span",_e,"Saving...")):(p(),b("span",fe,"Save Changes"))]),_:1},8,["disabled"])])])]),default:x(()=>{var h,_,U,V;return[l("div",he,[g.status||g.success||g.error?(p(),b("div",Ve,[g.status?(p(),b("div",xe,y(g.status),1)):k("",!0),g.success?(p(),b("div",ke,y(g.success),1)):k("",!0),g.error?(p(),b("div",we,y(g.error),1)):k("",!0)])):k("",!0),l("form",{onSubmit:ne(E,["prevent"]),class:"space-y-8"},[l("div",Ue,[t[20]||(t[20]=l("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Request Information (Read-only)",-1)),l("div",Ce,[l("div",null,[t[16]||(t[16]=l("label",{class:"font-medium text-gray-700"},"Sender:",-1)),l("p",Fe,y(((h=g.delivery.sender)==null?void 0:h.name)||((_=g.delivery.sender)==null?void 0:_.company_name)),1)]),l("div",null,[t[17]||(t[17]=l("label",{class:"font-medium text-gray-700"},"Payment Method:",-1)),l("p",$e,y(g.delivery.payment_method),1)]),l("div",null,[t[18]||(t[18]=l("label",{class:"font-medium text-gray-700"},"Pick-up Region:",-1)),l("p",Ee,y((U=g.delivery.pick_up_region)==null?void 0:U.name),1)]),l("div",null,[t[19]||(t[19]=l("label",{class:"font-medium text-gray-700"},"Drop-off Region:",-1)),l("p",Se,y((V=g.delivery.drop_off_region)==null?void 0:V.name),1)])])]),l("div",Pe,[t[21]||(t[21]=l("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Receiver Information",-1)),l("div",Me,[l("div",null,[s(d,{value:"Customer Category *"}),l("div",Ne,[(p(),b(Z,null,G(X,a=>l("label",{key:a.value,class:v(["border rounded-lg p-3 cursor-pointer transition-all duration-200 text-center",r(e).receiver.customer_category===a.value?"border-green-500 bg-green-50 ring-2 ring-green-200":"border-gray-300 hover:border-gray-400"])},[me(l("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=m=>r(e).receiver.customer_category=m),value:a.value,class:"sr-only"},null,8,Ie),[[ce,r(e).receiver.customer_category]]),l("span",Re,y(a.label),1)],2)),64))]),s(n,{message:r(e).errors["receiver.customer_category"]},null,8,["message"])]),r(e).receiver.customer_category==="company"?(p(),b("div",Be,[s(d,{value:"Company Name *"}),s(c,{modelValue:r(e).receiver.company_name,"onUpdate:modelValue":t[1]||(t[1]=a=>r(e).receiver.company_name=a),type:"text",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors["receiver.company_name"]}]),placeholder:"Enter company name"},null,8,["modelValue","class"]),s(n,{message:r(e).errors["receiver.company_name"]},null,8,["message"])])):k("",!0)]),l("div",De,[l("div",null,[s(d,{value:"First Name *"}),s(c,{modelValue:r(e).receiver.first_name,"onUpdate:modelValue":t[2]||(t[2]=a=>r(e).receiver.first_name=a),type:"text",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors["receiver.first_name"]}]),placeholder:"Enter first name"},null,8,["modelValue","class"]),s(n,{message:r(e).errors["receiver.first_name"]},null,8,["message"])]),l("div",null,[s(d,{value:"Middle Name"}),s(c,{modelValue:r(e).receiver.middle_name,"onUpdate:modelValue":t[3]||(t[3]=a=>r(e).receiver.middle_name=a),type:"text",class:"mt-1 block w-full",placeholder:"Enter middle name"},null,8,["modelValue"]),s(n,{message:r(e).errors["receiver.middle_name"]},null,8,["message"])]),l("div",null,[s(d,{value:"Last Name *"}),s(c,{modelValue:r(e).receiver.last_name,"onUpdate:modelValue":t[4]||(t[4]=a=>r(e).receiver.last_name=a),type:"text",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors["receiver.last_name"]}]),placeholder:"Enter last name"},null,8,["modelValue","class"]),s(n,{message:r(e).errors["receiver.last_name"]},null,8,["message"])])]),l("div",je,[l("div",null,[s(d,{value:"Email Address *"}),s(c,{modelValue:r(e).receiver.email,"onUpdate:modelValue":t[5]||(t[5]=a=>r(e).receiver.email=a),type:"email",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors["receiver.email"]}]),placeholder:"receiver.email@example.com"},null,8,["modelValue","class"]),s(n,{message:r(e).errors["receiver.email"]},null,8,["message"])]),l("div",null,[s(d,{value:"Mobile Number *"}),s(c,{modelValue:r(e).receiver.mobile,"onUpdate:modelValue":t[6]||(t[6]=a=>r(e).receiver.mobile=a),type:"tel",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors["receiver.mobile"]}]),placeholder:"09123456789"},null,8,["modelValue","class"]),s(n,{message:r(e).errors["receiver.mobile"]},null,8,["message"])])]),l("div",ze,[l("div",null,[s(d,{value:"Building Number"}),s(c,{modelValue:r(e).receiver.building_number,"onUpdate:modelValue":t[7]||(t[7]=a=>r(e).receiver.building_number=a),type:"text",class:"mt-1 block w-full",placeholder:"e.g., 123"},null,8,["modelValue"]),s(n,{message:r(e).errors["receiver.building_number"]},null,8,["message"])]),l("div",null,[s(d,{value:"Street *"}),s(c,{modelValue:r(e).receiver.street,"onUpdate:modelValue":t[8]||(t[8]=a=>r(e).receiver.street=a),type:"text",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors["receiver.street"]}]),placeholder:"e.g., Main Street"},null,8,["modelValue","class"]),s(n,{message:r(e).errors["receiver.street"]},null,8,["message"])]),l("div",null,[s(d,{value:"Barangay"}),s(c,{modelValue:r(e).receiver.barangay,"onUpdate:modelValue":t[9]||(t[9]=a=>r(e).receiver.barangay=a),type:"text",class:"mt-1 block w-full",placeholder:"Enter barangay"},null,8,["modelValue"]),s(n,{message:r(e).errors["receiver.barangay"]},null,8,["message"])]),l("div",null,[s(d,{value:"City *"}),s(c,{modelValue:r(e).receiver.city,"onUpdate:modelValue":t[10]||(t[10]=a=>r(e).receiver.city=a),type:"text",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors["receiver.city"]}]),placeholder:"Enter city"},null,8,["modelValue","class"]),s(n,{message:r(e).errors["receiver.city"]},null,8,["message"])]),l("div",null,[s(d,{value:"Province *"}),s(c,{modelValue:r(e).receiver.province,"onUpdate:modelValue":t[11]||(t[11]=a=>r(e).receiver.province=a),type:"text",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors["receiver.province"]}]),placeholder:"Enter province"},null,8,["modelValue","class"]),s(n,{message:r(e).errors["receiver.province"]},null,8,["message"])]),l("div",null,[s(d,{value:"ZIP Code *"}),s(c,{modelValue:r(e).receiver.zip_code,"onUpdate:modelValue":t[12]||(t[12]=a=>r(e).receiver.zip_code=a),type:"text",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors["receiver.zip_code"]}]),placeholder:"e.g., 1000",maxlength:"4"},null,8,["modelValue","class"]),s(n,{message:r(e).errors["receiver.zip_code"]},null,8,["message"])])]),l("div",Te,[s(d,{value:"Notes (Optional)"}),s(ge,{modelValue:r(e).receiver.notes,"onUpdate:modelValue":t[13]||(t[13]=a=>r(e).receiver.notes=a),class:"mt-1 block w-full",rows:3,placeholder:"Additional notes or special instructions..."},null,8,["modelValue"]),s(n,{message:r(e).errors["receiver.notes"]},null,8,["message"])])]),l("div",Ae,[l("div",Le,[t[23]||(t[23]=l("h3",{class:"text-lg font-semibold text-gray-900"},"Package Information",-1)),s($,{onClick:Y,type:"button",class:"text-sm"},{default:x(()=>t[22]||(t[22]=[F(" + Add Package ")])),_:1})]),(p(!0),b(Z,null,G(r(e).packages,(a,m)=>(p(),b("div",{key:m,class:"border border-gray-200 rounded-lg p-6 space-y-4 mb-6"},[l("div",Oe,[l("h4",We,"Package "+y(m+1),1),r(e).packages.length>1?(p(),b("button",{key:0,onClick:u=>ee(m),type:"button",class:"text-red-600 hover:text-red-700 text-sm font-medium"}," Remove ",8,qe)):k("",!0)]),l("div",He,[l("div",null,[s(d,{value:"Item Name *"}),s(c,{modelValue:a.item_name,"onUpdate:modelValue":u=>a.item_name=u,type:"text",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors[`packages.${m}.item_name`]}]),placeholder:"e.g., Documents, Electronics, Clothes"},null,8,["modelValue","onUpdate:modelValue","class"]),s(n,{message:r(e).errors[`packages.${m}.item_name`]},null,8,["message"])]),l("div",null,[s(d,{value:"Description"}),s(c,{modelValue:a.description,"onUpdate:modelValue":u=>a.description=u,type:"text",class:"mt-1 block w-full",placeholder:"Item description"},null,8,["modelValue","onUpdate:modelValue"]),s(n,{message:r(e).errors[`packages.${m}.description`]},null,8,["message"])])]),l("div",Ze,[l("div",null,[s(d,{value:"Length (cm) *"}),s(c,{modelValue:a.length,"onUpdate:modelValue":u=>a.length=u,type:"number",step:"0.1",min:"0.1",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors[`packages.${m}.length`]}]),placeholder:"0.0"},null,8,["modelValue","onUpdate:modelValue","class"]),s(n,{message:r(e).errors[`packages.${m}.length`]},null,8,["message"])]),l("div",null,[s(d,{value:"Height (cm) *"}),s(c,{modelValue:a.height,"onUpdate:modelValue":u=>a.height=u,type:"number",step:"0.1",min:"0.1",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors[`packages.${m}.height`]}]),placeholder:"0.0"},null,8,["modelValue","onUpdate:modelValue","class"]),s(n,{message:r(e).errors[`packages.${m}.height`]},null,8,["message"])]),l("div",null,[s(d,{value:"Width (cm) *"}),s(c,{modelValue:a.width,"onUpdate:modelValue":u=>a.width=u,type:"number",step:"0.1",min:"0.1",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors[`packages.${m}.width`]}]),placeholder:"0.0"},null,8,["modelValue","onUpdate:modelValue","class"]),s(n,{message:r(e).errors[`packages.${m}.width`]},null,8,["message"])]),l("div",null,[s(d,{value:"Weight (kg) *"}),s(c,{modelValue:a.weight,"onUpdate:modelValue":u=>a.weight=u,type:"number",step:"0.1",min:"0.1",class:v(["mt-1 block w-full",{"border-red-500":r(e).errors[`packages.${m}.weight`]}]),placeholder:"0.0"},null,8,["modelValue","onUpdate:modelValue","class"]),s(n,{message:r(e).errors[`packages.${m}.weight`]},null,8,["message"])])]),l("div",Ge,[l("div",null,[s(d,{value:"Category *"}),s(ve,{modelValue:a.category,"onUpdate:modelValue":u=>a.category=u,class:v(["mt-1 block w-full",{"border-red-500":r(e).errors[`packages.${m}.category`]}]),options:Q.value},null,8,["modelValue","onUpdate:modelValue","class","options"]),s(n,{message:r(e).errors[`packages.${m}.category`]},null,8,["message"])]),l("div",null,[s(d,{value:"Value (₱)"}),s(c,{modelValue:a.value,"onUpdate:modelValue":u=>a.value=u,type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",placeholder:"0.00"},null,8,["modelValue","onUpdate:modelValue"]),s(n,{message:r(e).errors[`packages.${m}.value`]},null,8,["message"])])])]))),128)),f.value?(p(),b("div",Je,[t[29]||(t[29]=l("h4",{class:"text-md font-semibold text-green-800 mb-3"},"Updated Price Estimate",-1)),l("div",Ke,[l("div",null,[t[24]||(t[24]=l("p",{class:"text-green-600"},"Base Fee",-1)),l("p",Qe,"₱"+y(f.value.base_fee),1)]),l("div",null,[t[25]||(t[25]=l("p",{class:"text-green-600"},"Volume Fee",-1)),l("p",Xe,"₱"+y(f.value.volume_fee),1)]),l("div",null,[t[26]||(t[26]=l("p",{class:"text-green-600"},"Weight Fee",-1)),l("p",Ye,"₱"+y(f.value.weight_fee),1)]),l("div",null,[t[27]||(t[27]=l("p",{class:"text-green-600"},"Package Fee",-1)),l("p",el,"₱"+y(f.value.package_fee),1)])]),l("div",ll,[l("div",rl,[t[28]||(t[28]=l("p",{class:"text-lg font-semibold text-green-800"},"Total Estimated Cost",-1)),l("p",tl,"₱"+y(f.value.total_price),1)])])])):k("",!0)]),l("div",sl,[s($,{onClick:S,type:"button"},{default:x(()=>t[30]||(t[30]=[F(" Cancel ")])),_:1}),s(K,{type:"submit",disabled:r(e).processing},{default:x(()=>[r(e).processing?(p(),b("span",al,"Saving Changes...")):(p(),b("span",ol,"Save Changes"))]),_:1},8,["disabled"])])],32)])]}),_:1}))}};export{hl as default};
