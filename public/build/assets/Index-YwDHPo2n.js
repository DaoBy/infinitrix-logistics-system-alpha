import{g,i as ae,h as oe,W as y,d as le,o as c,w as l,b as s,a as n,c as f,e as b,t as r,f as d,u as re,n as P}from"./app-xrBi3RtB.js";import{E as ne}from"./EmployeeLayout-DIT5z9wE.js";import{_ as q}from"./PrimaryButton-C_K9q06y.js";import{_ as L}from"./SecondaryButton-BolX5WPO.js";import{D as U}from"./DangerButton-C4ke1hY1.js";import{_ as ie}from"./SearchInput-BlX_e4xM.js";import{S as B}from"./SelectInput-CqVYJRU0.js";import{_ as ue}from"./DataTable-DLSq4y8x.js";import{M as ce}from"./Modal-BzGLoRAP.js";import{P as de}from"./Pagination-CsoGEKcO.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as fe}from"./UserGroupIcon-D81B5f3l.js";import"./NavLink-BuzuRvoY.js";const ve={class:"flex justify-between items-center w-full px-6 md:px-8"},ge={class:"flex gap-2"},ye={class:"zoom-content"},pe={class:"px-6 py-4"},xe={key:0,class:"mb-4"},_e={key:0,class:"p-3 bg-blue-100 text-blue-800 rounded"},he={key:1,class:"p-3 bg-green-100 text-green-800 rounded"},be={key:2,class:"p-3 bg-red-100 text-red-800 rounded"},Ce={class:"mb-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3"},we={class:"w-full sm:w-96"},ke={class:"flex items-center gap-3"},Ae={class:"text-sm text-gray-500 bg-blue-50 px-3 py-1 rounded border border-blue-100 whitespace-nowrap"},Se={key:0,class:"ml-1"},Ve={class:"justify-center flex items-center"},qe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-full max-w-[95vw]"},Le={class:"p-4 bg-white border-b border-gray-200"},De={class:"flex items-center"},Fe={class:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center mr-3"},Te={class:"text-sm font-medium text-gray-700"},Ne={class:"font-medium text-gray-900 block"},$e={key:0,class:"text-xs text-gray-500 block"},je={class:"text-gray-700"},Ee={class:"text-gray-700"},Ie={class:"font-medium text-gray-900"},Me={class:"flex space-x-2"},Pe={class:"text-center py-8"},Ue={class:"bg-gray-50 rounded-lg p-6 max-w-md mx-auto"},Be={class:"text-gray-500 mb-3"},Oe={key:0,class:"mt-4"},ze={class:"p-5"},We={class:"mt-1 text-sm text-gray-600"},Ge={class:"mt-4 flex justify-end space-x-3"},Re={key:0},He={key:1},Je={__name:"Index",props:{customers:Object,status:String,success:String,error:String},setup(a){var F,T,N,$,j;const C=a,S=g(!1),w=g(null),A=g(!1),i=g(((F=C.customers.filters)==null?void 0:F.search)||""),p=g(((T=C.customers.filters)==null?void 0:T.customer_category)||""),x=g(((N=C.customers.filters)==null?void 0:N.frequency_type)||""),_=g((($=C.customers.filters)==null?void 0:$.sort_field)||"first_name"),k=g(((j=C.customers.filters)==null?void 0:j.sort_direction)||"asc"),O=[{value:"",text:"All Types"},{value:"individual",text:"Individual"},{value:"company",text:"Company"}],z=[{value:"",text:"All Frequencies"},{value:"regular",text:"Regular"},{value:"occasional",text:"Occasional"}],W={individual:"bg-purple-100 text-purple-800",company:"bg-blue-100 text-blue-800"},G={regular:"bg-green-100 text-green-800",occasional:"bg-yellow-100 text-yellow-800"},R=[{field:"name",header:"Customer Name",sortable:!0},{field:"email",header:"Email",sortable:!0},{field:"mobile",header:"Phone",sortable:!1},{field:"customer_category",header:"Type",sortable:!0},{field:"frequency_type",header:"Frequency",sortable:!0},{field:"total_orders",header:"Total Orders",sortable:!0},{field:"actions",header:"Actions",sortable:!1}];ae(()=>(C.customers.data||[]).filter(e=>{var t,v,E,I,M;const m=i.value===""||((t=e.first_name)==null?void 0:t.toLowerCase().includes(i.value.toLowerCase()))||((v=e.last_name)==null?void 0:v.toLowerCase().includes(i.value.toLowerCase()))||((E=e.email)==null?void 0:E.toLowerCase().includes(i.value.toLowerCase()))||((I=e.company_name)==null?void 0:I.toLowerCase().includes(i.value.toLowerCase()))||((M=e.mobile)==null?void 0:M.toLowerCase().includes(i.value.toLowerCase())),h=!p.value||e.customer_category===p.value,u=!x.value||e.frequency_type===x.value;return m&&h&&u}).sort((e,m)=>{const h=k.value==="asc"?1:-1;let u=e[_.value],t=m[_.value];return u==null&&(u=""),t==null&&(t=""),u=String(u).toLowerCase(),t=String(t).toLowerCase(),u<t?-1*h:u>t?1*h:0}));const H=(o,e,m)=>o&&e?`${o.charAt(0)}${e.charAt(0)}`.toUpperCase():m?m.substring(0,2).toUpperCase():"CU",J=o=>W[o]||"bg-gray-100 text-gray-800",K=o=>G[o]||"bg-gray-100 text-gray-800",Q=o=>{_.value=o.field,k.value=o.direction},X=o=>{y.get(route("admin.customers.index"),{page:o,search:i.value,customer_category:p.value,frequency_type:x.value,sort_field:_.value,sort_direction:k.value},{preserveState:!0,preserveScroll:!0,replace:!0})},Y=o=>{w.value=o,S.value=!0},V=()=>{S.value=!1,w.value=null,A.value=!1},Z=()=>{w.value&&(A.value=!0,y.put(route("admin.customers.archive",w.value.id),{},{preserveScroll:!0,onSuccess:()=>y.reload({only:["customers"]}),onError:()=>alert("Failed to disable customer"),onFinish:()=>V()}))},D=()=>y.get(route("admin.customers.create")),ee=o=>y.get(route("admin.customers.show",o)),te=o=>y.get(route("admin.customers.edit",o)),se=()=>y.get(route("admin.customers.archived"));return oe([i,p,x,_,k],()=>{y.get(route("admin.customers.index"),{search:i.value,customer_category:p.value,frequency_type:x.value,sort_field:_.value,sort_direction:k.value,page:1},{preserveState:!0,replace:!0})},{deep:!0}),(o,e)=>(c(),le(ne,null,{header:l(()=>[s("div",ve,[e[5]||(e[5]=s("div",null,[s("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Customer Management"),s("p",{class:"mt-1 text-sm text-gray-500"}," Manage active customers and their information ")],-1)),s("div",ge,[n(L,{onClick:se},{default:l(()=>e[3]||(e[3]=[d("View Disabled Customers")])),_:1}),n(q,{onClick:D},{default:l(()=>e[4]||(e[4]=[d("Add New Customer")])),_:1})])])]),default:l(()=>{var m,h,u;return[s("div",ye,[s("div",pe,[a.status||a.success||a.error?(c(),f("div",xe,[a.status?(c(),f("div",_e,r(a.status),1)):b("",!0),a.success?(c(),f("div",he,r(a.success),1)):b("",!0),a.error?(c(),f("div",be,r(a.error),1)):b("",!0)])):b("",!0),s("div",Ce,[s("div",we,[n(ie,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=t=>i.value=t),placeholder:"Search customers by name, email, or company...",class:"w-full"},null,8,["modelValue"])]),s("div",ke,[n(B,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=t=>p.value=t),options:O,"option-value":"value","option-label":"text",placeholder:"All Types",class:"w-full sm:w-48"},null,8,["modelValue"]),n(B,{modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=t=>x.value=t),options:z,"option-value":"value","option-label":"text",placeholder:"All Frequencies",class:"w-full sm:w-48"},null,8,["modelValue"]),s("div",Ae,[d(" ðŸ“‹ Showing "+r(((m=a.customers.data)==null?void 0:m.length)||0)+" active "+r(((h=a.customers.data)==null?void 0:h.length)===1?"customer":"customers")+" ",1),a.customers.data&&a.customers.data.length<a.customers.total?(c(),f("span",Se," (Page "+r(a.customers.current_page)+" of "+r(a.customers.last_page)+") ",1)):b("",!0)])])]),s("div",Ve,[s("div",qe,[s("div",Le,[n(ue,{columns:R,data:a.customers.data||[],"sort-field":_.value,"sort-direction":k.value,onSort:Q,class:"w-full"},{name:l(({row:t})=>[s("div",De,[s("div",Fe,[s("span",Te,r(H(t.first_name,t.last_name,t.company_name)),1)]),s("div",null,[s("span",Ne,r(t.first_name)+" "+r(t.last_name),1),t.company_name?(c(),f("span",$e,r(t.company_name),1)):b("",!0)])])]),email:l(({row:t})=>[s("span",je,r(t.email||"No email"),1)]),mobile:l(({row:t})=>[s("span",Ee,r(t.mobile||"No phone"),1)]),customer_category:l(({row:t})=>[s("span",{class:P(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize",J(t.customer_category)])},r(t.customer_category||"N/A"),3)]),frequency_type:l(({row:t})=>[s("span",{class:P(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize",K(t.frequency_type)])},r(t.frequency_type||"N/A"),3)]),total_orders:l(({row:t})=>[s("span",Ie,r(t.total_orders||0),1)]),actions:l(({row:t})=>[s("div",Me,[n(L,{onClick:v=>ee(t.id),class:"text-xs py-1 px-2"},{default:l(()=>e[6]||(e[6]=[d("View")])),_:2},1032,["onClick"]),n(q,{onClick:v=>te(t.id),class:"text-xs py-1 px-2"},{default:l(()=>e[7]||(e[7]=[d("Edit")])),_:2},1032,["onClick"]),n(U,{onClick:v=>Y(t),class:"text-xs py-1 px-2"},{default:l(()=>e[8]||(e[8]=[d("Disable")])),_:2},1032,["onClick"])])]),empty:l(()=>[s("div",Pe,[s("div",Ue,[n(re(fe),{class:"h-10 w-10 text-gray-400 mx-auto mb-3"}),e[10]||(e[10]=s("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No active customers found",-1)),s("p",Be,r(i.value?"Try adjusting your search terms":"Get started by adding your first customer"),1),n(q,{onClick:D},{default:l(()=>e[9]||(e[9]=[d("Add New Customer")])),_:1})])])]),_:1},8,["data","sort-field","sort-direction"]),((u=a.customers.links)==null?void 0:u.length)>3?(c(),f("div",Oe,[n(de,{pagination:a.customers,onPageChanged:X},null,8,["pagination"])])):b("",!0)])])])])]),n(ce,{show:S.value,onClose:V},{default:l(()=>{var t,v;return[s("div",ze,[e[14]||(e[14]=s("h2",{class:"text-lg font-medium text-gray-900"},"Disable Customer?",-1)),s("p",We,[e[11]||(e[11]=d(" Are you sure you want to disable ")),s("strong",null,r((t=w.value)==null?void 0:t.first_name)+" "+r((v=w.value)==null?void 0:v.last_name),1),e[12]||(e[12]=d("? This will move them to the disabled customers list. "))]),s("div",Ge,[n(L,{onClick:V},{default:l(()=>e[13]||(e[13]=[d("Cancel")])),_:1}),n(U,{onClick:Z,disabled:A.value},{default:l(()=>[A.value?(c(),f("span",Re,"Processing...")):(c(),f("span",He,"Disable Customer"))]),_:1},8,["disabled"])])])]}),_:1},8,["show"])]}),_:1}))}},it=me(Je,[["__scopeId","data-v-f69bd2ec"]]);export{it as default};
