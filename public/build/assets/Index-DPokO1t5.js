import{E as T}from"./EmployeeLayout-DIT5z9wE.js";import{_ as A}from"./PrimaryButton-C_K9q06y.js";import{_ as R}from"./SecondaryButton-BolX5WPO.js";import{_ as W}from"./SearchInput-BlX_e4xM.js";import{S as G}from"./SelectInput-CqVYJRU0.js";import{_ as J}from"./DataTable-DLSq4y8x.js";import{P as K}from"./Pagination-CsoGEKcO.js";import{g as _,h as Q,W as f,d as z,o as d,w as r,b as e,c as n,e as i,t as a,a as m,f as y,n as X}from"./app-xrBi3RtB.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-BuzuRvoY.js";import"./DangerButton-C4ke1hY1.js";const Z={class:"flex justify-between items-center w-full px-6 md:px-8"},ee={class:"flex gap-2"},te={class:"zoom-content"},se={class:"px-6 py-4"},oe={key:0,class:"mb-4"},le={key:0,class:"p-3 bg-blue-100 text-blue-800 rounded"},ae={key:1,class:"p-3 bg-green-100 text-green-800 rounded"},re={key:2,class:"p-3 bg-red-100 text-red-800 rounded"},de={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},ie={class:"bg-white p-4 rounded-lg shadow-sm border"},ne={class:"flex items-center"},ue={class:"ml-4"},ce={class:"text-2xl font-semibold text-gray-900"},me={class:"bg-white p-4 rounded-lg shadow-sm border"},ge={class:"flex items-center"},xe={class:"ml-4"},fe={class:"text-2xl font-semibold text-gray-900"},pe={class:"bg-white p-4 rounded-lg shadow-sm border"},ve={class:"flex items-center"},he={class:"ml-4"},be={class:"text-2xl font-semibold text-gray-900"},_e={class:"bg-white p-4 rounded-lg shadow-sm border"},ye={class:"flex items-center"},we={class:"ml-4"},ke={class:"text-2xl font-semibold text-gray-900"},qe={class:"mb-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3"},Ce={class:"w-full sm:w-96"},je={class:"flex items-center gap-3"},Se={class:"text-sm text-gray-500 bg-blue-50 px-3 py-1 rounded border border-blue-100 whitespace-nowrap"},Ve={key:0,class:"ml-1"},Ae={class:"justify-center flex items-center"},Re={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-full max-w-[95vw]"},ze={class:"p-4 bg-white border-b border-gray-200"},Be={class:"flex items-center space-x-2"},Fe={class:"font-medium text-gray-900"},Me={key:0,class:"px-1.5 py-0.5 text-xs bg-blue-100 text-blue-800 rounded-full",title:"Has delivery history"},Ne={key:1,class:"px-1.5 py-0.5 text-xs bg-amber-100 text-amber-800 rounded-full",title:"Critical fields locked"},Le={class:"text-gray-700"},Pe={class:"text-sm"},$e={key:0,class:"text-xs text-amber-600 mt-1"},De={class:"text-sm text-gray-900"},Ee={class:"flex space-x-2"},Ie={class:"text-center py-8"},He={class:"bg-gray-50 rounded-lg p-6 max-w-md mx-auto"},Oe={class:"text-gray-500 mb-3"},Ue={key:0,class:"mt-4"},Te={__name:"Index",props:{requests:Object,filters:Object,stats:Object,status:String,success:String,error:String},setup(s){var w,k,q,C;const b=s,g=_(((w=b.filters)==null?void 0:w.search)||""),p=_(((k=b.filters)==null?void 0:k.status)||""),v=_(((q=b.filters)==null?void 0:q.sort_field)||"created_at"),h=_(((C=b.filters)==null?void 0:C.sort_direction)||"desc"),B=[{value:"",text:"All Statuses"},{value:"pending",text:"Pending"},{value:"approved",text:"Approved"},{value:"rejected",text:"Rejected"}],F=[{field:"customer_name",header:"Customer",sortable:!0},{field:"email",header:"Email",sortable:!0},{field:"changed_fields",header:"Changed Fields",sortable:!1},{field:"status",header:"Status",sortable:!0},{field:"created_at",header:"Submitted",sortable:!0},{field:"actions",header:"Actions",sortable:!1}],M=o=>{var x;return(x=o.customer)!=null&&x.critical_fields_locked?["first_name","last_name","email","mobile","building_number","street","barangay","city","province","zip_code"].some(u=>o[u]!==null):!1},N=o=>{v.value=o.field,h.value=o.direction},L=o=>{f.get(route("admin.customer-update-requests.index"),{page:o,search:g.value,status:p.value,sort_field:v.value,sort_direction:h.value},{preserveState:!0,preserveScroll:!0,replace:!0})},P=o=>{const t=[];return["first_name","middle_name","last_name","email","mobile","phone","building_number","street","barangay","city","province","zip_code"].forEach(u=>{o[u]!==null&&t.push(u.replace("_"," "))}),t.join(", ")||"No changes"},$=o=>({pending:"Pending Review",approved:"Approved",rejected:"Rejected"})[o]||o,D=o=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"})[o]||"bg-gray-100 text-gray-800",E=o=>new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),I=o=>{f.get(route("admin.customer-update-requests.show",o))},H=()=>{f.get(route("admin.customer-audit-logs.index"))},O=o=>{f.get(route("admin.customers.audit-logs",o))},U=()=>{f.reload({only:["requests","stats"]})};return Q([g,p,v,h],()=>{f.get(route("admin.customer-update-requests.index"),{search:g.value,status:p.value,sort_field:v.value,sort_direction:h.value,page:1},{preserveState:!0,replace:!0})},{deep:!0}),(o,t)=>(d(),z(T,null,{header:r(()=>[e("div",Z,[t[4]||(t[4]=e("div",null,[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Customer Update Requests"),e("p",{class:"mt-1 text-sm text-gray-500"}," Review and manage customer profile update requests ")],-1)),e("div",ee,[m(R,{onClick:H,class:"flex items-center space-x-2"},{default:r(()=>t[2]||(t[2]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("span",null,"View Audit Logs",-1)])),_:1}),m(A,{onClick:U},{default:r(()=>t[3]||(t[3]=[y("Refresh")])),_:1})])])]),default:r(()=>{var x,u,j;return[e("div",te,[e("div",se,[s.status||s.success||s.error?(d(),n("div",oe,[s.status?(d(),n("div",le,a(s.status),1)):i("",!0),s.success?(d(),n("div",ae,a(s.success),1)):i("",!0),s.error?(d(),n("div",re,a(s.error),1)):i("",!0)])):i("",!0),e("div",de,[e("div",ie,[e("div",ne,[t[6]||(t[6]=e("div",{class:"p-2 bg-blue-100 rounded-lg"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",ue,[t[5]||(t[5]=e("p",{class:"text-sm font-medium text-gray-600"},"Pending Requests",-1)),e("p",ce,a(s.stats.pending||0),1)])])]),e("div",me,[e("div",ge,[t[8]||(t[8]=e("div",{class:"p-2 bg-green-100 rounded-lg"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",xe,[t[7]||(t[7]=e("p",{class:"text-sm font-medium text-gray-600"},"Approved",-1)),e("p",fe,a(s.stats.approved||0),1)])])]),e("div",pe,[e("div",ve,[t[10]||(t[10]=e("div",{class:"p-2 bg-red-100 rounded-lg"},[e("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",he,[t[9]||(t[9]=e("p",{class:"text-sm font-medium text-gray-600"},"Rejected",-1)),e("p",be,a(s.stats.rejected||0),1)])])]),e("div",_e,[e("div",ye,[t[12]||(t[12]=e("div",{class:"p-2 bg-purple-100 rounded-lg"},[e("svg",{class:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),e("div",we,[t[11]||(t[11]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Requests",-1)),e("p",ke,a(s.stats.total||0),1)])])])]),e("div",qe,[e("div",Ce,[m(W,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=l=>g.value=l),placeholder:"Search customers by name, email, or company...",class:"w-full"},null,8,["modelValue"])]),e("div",je,[m(G,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=l=>p.value=l),options:B,"option-value":"value","option-label":"text",placeholder:"All Statuses",class:"w-full sm:w-48"},null,8,["modelValue"]),e("div",Se,[y(" ðŸ“‹ Showing "+a(((x=s.requests.data)==null?void 0:x.length)||0)+" "+a(((u=s.requests.data)==null?void 0:u.length)===1?"request":"requests")+" ",1),s.requests.data&&s.requests.data.length<s.requests.total?(d(),n("span",Ve," (Page "+a(s.requests.current_page)+" of "+a(s.requests.last_page)+") ",1)):i("",!0)])])]),e("div",Ae,[e("div",Re,[e("div",ze,[m(J,{columns:F,data:s.requests.data||[],"sort-field":v.value,"sort-direction":h.value,onSort:N,class:"w-full"},{customer_name:r(({row:l})=>{var c,S,V;return[e("div",Be,[e("span",Fe,a(((c=l.customer)==null?void 0:c.name)||"N/A"),1),(S=l.customer)!=null&&S.has_delivery_history?(d(),n("span",Me," ðŸ“¦ ")):i("",!0),(V=l.customer)!=null&&V.critical_fields_locked?(d(),n("span",Ne," ðŸ”’ ")):i("",!0)])]}),email:r(({row:l})=>{var c;return[e("span",Le,a(((c=l.customer)==null?void 0:c.email)||"N/A"),1)]}),changed_fields:r(({row:l})=>[e("div",null,[e("span",Pe,a(P(l)),1),M(l)?(d(),n("div",$e," Includes locked fields ")):i("",!0)])]),status:r(({row:l})=>[e("span",{class:X(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize",D(l.status)])},a($(l.status)),3)]),created_at:r(({row:l})=>[e("div",De,a(E(l.created_at)),1)]),actions:r(({row:l})=>[e("div",Ee,[m(A,{onClick:c=>I(l.id),class:"text-xs py-1 px-2"},{default:r(()=>t[13]||(t[13]=[y(" Review ")])),_:2},1032,["onClick"]),l.customer?(d(),z(R,{key:0,onClick:c=>O(l.customer.id),class:"text-xs py-1 px-2",title:"View customer audit logs"},{default:r(()=>t[14]||(t[14]=[y(" Logs ")])),_:2},1032,["onClick"])):i("",!0)])]),empty:r(()=>[e("div",Ie,[e("div",He,[t[15]||(t[15]=e("svg",{class:"h-10 w-10 text-gray-400 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t[16]||(t[16]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No update requests found",-1)),e("p",Oe,a(g.value?"Try adjusting your search terms":"All customer update requests are processed"),1)])])]),_:1},8,["data","sort-field","sort-direction"]),((j=s.requests.links)==null?void 0:j.length)>3?(d(),n("div",Ue,[m(K,{pagination:s.requests,onPageChanged:L},null,8,["pagination"])])):i("",!0)])])])])])]}),_:1}))}},ot=Y(Te,[["__scopeId","data-v-4573c1e4"]]);export{ot as default};
