import{g,p as P,i as k,j as re,a3 as ie,c as r,o as i,b as t,e as N,a2 as W,s as U,a as l,v as w,x as M,w as m,f as b,F as ne,r as de,k as $,t as u,O as ue,W as _,n as ce}from"./app-BOCrhSfO.js";import{_ as x}from"./PrimaryButton-7U4Qu6md.js";import{_ as T}from"./SecondaryButton-BoCxbQ9w.js";import{S as O}from"./SelectInput-BaEQ9Gfo.js";import{_ as d}from"./InputLabel-ByB8oFns.js";import{T as F}from"./TextInput-fgBIPllX.js";import{_ as ge}from"./TextArea-B3xnA6tu.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                  */const pe={class:"space-y-6"},me={class:"bg-white shadow rounded-lg border border-gray-200"},ve={class:"px-6 py-4"},fe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ye={class:"flex justify-end"},be={key:0},xe={key:1},he={class:"bg-white shadow rounded-lg border border-gray-200"},ke={class:"px-6 py-4 border-b border-gray-200"},we={class:"flex justify-between items-center"},_e={class:"px-6 py-4"},Ce={key:0,class:"text-center py-8"},Se={key:1,class:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg"},Ve={class:"mt-6"},Me={key:2,class:"space-y-4"},Fe={class:"flex items-center justify-between"},ze={class:"flex items-center space-x-4 flex-1"},je=["onMousedown"],Pe={class:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center"},Ue=["src","alt"],Oe={key:1,class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Le={class:"flex-1"},Be={class:"flex items-center space-x-2"},Ee={class:"text-lg font-medium text-gray-900"},De={class:"text-sm text-gray-500 mt-1"},qe={class:"flex items-center space-x-4 mt-2 text-xs text-gray-600"},Ne={key:0},We={key:1,class:"text-orange-600"},$e={class:"flex items-center space-x-2"},Te=["onClick"],Ae=["onClick"],He={key:0,class:"flex justify-end pt-4 border-t border-gray-200"},Ie={key:0},Re={key:1},Ge={class:"bg-white shadow rounded-lg border border-gray-200"},Je={class:"px-6 py-4"},Ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Qe={class:"border-t pt-4 border-gray-200"},Xe={class:"p-4 border rounded-lg bg-gray-50"},Ye={class:"space-y-2"},Ze={class:"text-xs text-gray-600"},et={class:"flex justify-end space-x-3"},tt={key:0},st={key:1},ot={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},lt={class:"relative top-20 mx-auto p-4 border w-full max-w-md shadow-lg rounded-md bg-white"},at={class:"mt-3"},rt={class:"text-lg font-medium text-gray-900 mb-4"},it={class:"grid grid-cols-3 gap-3"},nt={class:"flex items-center"},dt={class:"flex justify-end space-x-3 pt-4"},ut={key:0},ct={key:1},kt={__name:"SettingsSection",props:{priceMatrix:Object},setup(A){const{preferences:H,saveGlobalPreferences:I}=ie(),C=g(!1),S=g(!1),z=g(!1),f=g(!1),h=g(!1),y=g([]),L=g([]),V=g(!1),v=g(!1),a=P({name:"",code:"",description:"",length:"",height:"",width:"",is_active:!0,image:null}),j=g(null),c=P({base_fee:0,volume_rate:0,weight_rate:0,package_rate:0}),n=P({font_style:"inter",font_size:"medium"}),R=k(()=>[{value:"piece",label:"Piece"},{value:"carton",label:"Carton"},{value:"sack",label:"Sack"},{value:"roll",label:"Roll"},{value:"bundle",label:"Bundle"},{value:"custom",label:"Custom Size"}]),G=k(()=>[{value:"inter",label:"Inter (Modern)"},{value:"arial",label:"Arial (Classic)"},{value:"roboto",label:"Roboto (Clean)"}]),J=k(()=>[{value:"small",label:"Small"},{value:"medium",label:"Medium"},{value:"large",label:"Large"}]),B=k(()=>{const o=n.font_style==="inter"?'"Inter", sans-serif':n.font_style==="roboto"?'"Roboto", sans-serif':"Arial, sans-serif",e=n.font_size==="small"?"14px":n.font_size==="large"?"18px":"16px";return{fontFamily:o,fontSize:e}}),K=k(()=>JSON.stringify(y.value.map(o=>o.id))!==JSON.stringify(L.value));re(async()=>{Object.assign(n,H.value),D.priceMatrix&&Object.assign(c,D.priceMatrix),await Q()});const Q=async()=>{z.value=!0;try{const e=await(await fetch("/admin/utilities/package-categories")).json();y.value=e.categories||[],L.value=y.value.map(s=>s.id)}catch(o){console.error("Error loading package categories:",o)}finally{z.value=!1}},X=()=>{S.value=!0,_.post("/admin/utilities/price-matrix",c,{preserveScroll:!0,onSuccess:()=>{window.location.reload()},onFinish:()=>{S.value=!1}})},E=async()=>{C.value=!0;try{await I(n),window.location.reload()}catch(o){console.error("Error saving preferences:",o)}finally{C.value=!1}},Y=()=>{n.font_style="inter",n.font_size="medium",E()},Z=o=>{console.log("Start dragging:",o.name)},ee=o=>{var e,s,p;Object.assign(a,{name:o.name,code:o.code,description:o.description||"",length:((e=o.dimensions)==null?void 0:e.length)||"",height:((s=o.dimensions)==null?void 0:s.height)||"",width:((p=o.dimensions)==null?void 0:p.width)||"",is_active:o.is_active,image:null}),j.value=o.id,v.value=!0},te=async o=>{if(confirm(`Are you sure you want to delete "${o.name}"? This action cannot be undone.`))try{_.post(`/admin/utilities/package-categories/${o.id}/delete`,{},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{window.location.reload()},onError:e=>{alert("Failed to delete category: "+(e.message||"Unknown error"))}})}catch(e){console.error("Error deleting category:",e),alert("Error deleting category: "+e.message)}},se=o=>{const e=o.target.files[0];e&&(a.image=e)},oe=async()=>{f.value=!0;const o={name:a.name,code:a.code,description:a.description,length:a.length||null,height:a.height||null,width:a.width||null,is_active:a.is_active,image:a.image},e=v.value?`/admin/utilities/package-categories/${j.value}`:"/admin/utilities/package-categories";try{v.value?_.post(e,{...o,_method:"PUT"},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{window.location.reload()},onError:s=>{console.error("Form errors:",s);const p=Object.values(s).flat().join(", ");alert("Failed to save category: "+p)},onFinish:()=>{f.value=!1}}):_.post(e,o,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{window.location.reload()},onError:s=>{console.error("Form errors:",s);const p=Object.values(s).flat().join(", ");alert("Failed to save category: "+p)},onFinish:()=>{f.value=!1}})}catch(s){console.error("Error saving category:",s),alert("Error saving category: "+s.message),f.value=!1}},le=()=>{V.value=!1,v.value=!1,j.value=null,Object.assign(a,{name:"",code:"",description:"",length:"",height:"",width:"",is_active:!0,image:null})},ae=async()=>{h.value=!0;try{_.post("/admin/utilities/package-categories/reorder",{categories:y.value.map((o,e)=>({id:o.id,sort_order:e}))},{preserveScroll:!0,onSuccess:()=>{window.location.reload()},onError:o=>{alert("Failed to save order: "+(o.message||"Unknown error"))},onFinish:()=>{h.value=!1}})}catch(o){console.error("Error saving category order:",o),alert("Error saving category order"),h.value=!1}},D=A;return(o,e)=>(i(),r("div",pe,[t("div",me,[e[16]||(e[16]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Price Matrix"),t("p",{class:"mt-1 text-sm text-gray-500"}," Configure pricing rates for calculations ")],-1)),t("div",ve,[e[15]||(e[15]=W('<div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-blue-600" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div><div class="ml-3"><h3 class="text-sm font-medium text-blue-800"> How Pricing Works </h3><div class="mt-2 text-sm text-blue-700 space-y-2"><p><strong>Total Price = Base Fee + Volume Fee + Weight Fee + Package Fee</strong></p><div class="space-y-1"><p>• <strong>Base Fee</strong>: Fixed cost applied to every shipment</p><p>• <strong>Volume Fee</strong>: (Height × Width × Length in meters) × Volume Rate</p><p>• <strong>Weight Fee</strong>: Package Weight (kg) × Weight Rate</p><p>• <strong>Package Fee</strong>: Fixed fee per package</p></div><p class="text-xs"><strong>Note:</strong> Dimensions converted from cm to m. Limits: Volume ≤ 10m³, Weight ≤ 100kg per package.</p></div></div></div></div>',1)),t("form",{onSubmit:U(X,["prevent"]),class:"space-y-6"},[t("div",fe,[t("div",null,[l(d,{value:"Base Fee (₱)",class:"mb-2"}),w(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.base_fee=s),type:"number",step:"0.01",min:"0",class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",required:""},null,512),[[M,c.base_fee]])]),t("div",null,[l(d,{value:"Volume Rate (₱ per m³)",class:"mb-2"}),w(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>c.volume_rate=s),type:"number",step:"0.0001",min:"0",class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",required:""},null,512),[[M,c.volume_rate]])]),t("div",null,[l(d,{value:"Weight Rate (₱ per kg)",class:"mb-2"}),w(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>c.weight_rate=s),type:"number",step:"0.01",min:"0",class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",required:""},null,512),[[M,c.weight_rate]])]),t("div",null,[l(d,{value:"Package Rate (₱ per package)",class:"mb-2"}),w(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>c.package_rate=s),type:"number",step:"0.01",min:"0",class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500",required:""},null,512),[[M,c.package_rate]])])]),t("div",ye,[l(x,{type:"submit",disabled:S.value,class:"px-4 py-2"},{default:m(()=>[S.value?(i(),r("span",be,"Saving...")):(i(),r("span",xe,"Save Price Matrix"))]),_:1},8,["disabled"])])],32)])]),t("div",he,[t("div",ke,[t("div",we,[e[18]||(e[18]=t("div",null,[t("h3",{class:"text-lg font-medium text-gray-900"},"Package Categories"),t("p",{class:"mt-1 text-sm text-gray-500"}," Manage package types and their default dimensions ")],-1)),l(x,{onClick:e[4]||(e[4]=s=>V.value=!0),class:"px-4 py-2"},{default:m(()=>e[17]||(e[17]=[b(" + Add Category ")])),_:1})])]),t("div",_e,[e[30]||(e[30]=W('<div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-green-600" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div><div class="ml-3"><h3 class="text-sm font-medium text-green-800"> Package Categories Guide </h3><div class="mt-2 text-sm text-green-700 space-y-2"><p><strong>Categories define the package types customers can select in delivery requests.</strong></p><div class="space-y-1"><p>• <strong>Name</strong>: Display name shown to customers</p><p>• <strong>Code</strong>: Unique identifier used in the system</p><p>• <strong>Dimensions</strong>: Default measurements (in centimeters)</p><p>• <strong>Image</strong>: Visual representation of the package type</p></div><p class="text-xs"><strong>Note:</strong> Categories with dimensions will auto-fill measurements. &quot;Custom Size&quot; allows manual entry.</p></div></div></div></div>',1)),z.value?(i(),r("div",Ce,e[19]||(e[19]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500"},"Loading categories...",-1)]))):y.value.length===0?(i(),r("div",Se,[e[21]||(e[21]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1)),e[22]||(e[22]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No package categories",-1)),e[23]||(e[23]=t("p",{class:"mt-1 text-sm text-gray-500"},"Get started by creating your first package category.",-1)),t("div",Ve,[l(x,{onClick:e[5]||(e[5]=s=>V.value=!0)},{default:m(()=>e[20]||(e[20]=[b(" + Add Category ")])),_:1})])])):(i(),r("div",Me,[(i(!0),r(ne,null,de(y.value,s=>{var p;return i(),r("div",{key:s.id,class:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors duration-200"},[t("div",Fe,[t("div",ze,[t("button",{type:"button",class:"cursor-move text-gray-400 hover:text-gray-600",onMousedown:q=>Z(s)},e[24]||(e[24]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8h16M4 16h16"})],-1)]),40,je),t("div",Pe,[s.image_url?(i(),r("img",{key:0,src:s.image_url,alt:s.name,class:"w-10 h-10 object-contain"},null,8,Ue)):(i(),r("svg",Oe,e[25]||(e[25]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"},null,-1)])))]),t("div",Le,[t("div",Be,[t("h4",Ee,u(s.name),1),t("span",{class:ce(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",s.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"])},u(s.is_active?"Active":"Inactive"),3)]),t("p",De,u(s.description),1),t("div",qe,[t("span",null,[e[26]||(e[26]=t("strong",null,"Code:",-1)),b(" "+u(s.code),1)]),(p=s.dimensions)!=null&&p.length?(i(),r("span",Ne,[e[27]||(e[27]=t("strong",null,"Dimensions:",-1)),b(" L"+u(s.dimensions.length)+" × H"+u(s.dimensions.height)+" × W"+u(s.dimensions.width)+"cm ",1)])):(i(),r("span",We,"Custom dimensions"))])])]),t("div",$e,[t("button",{onClick:q=>ee(s),class:"text-indigo-600 hover:text-indigo-900 p-2 rounded-lg hover:bg-indigo-50 transition-colors duration-200",title:"Edit category"},e[28]||(e[28]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,Te),t("button",{onClick:q=>te(s),class:"text-red-600 hover:text-red-900 p-2 rounded-lg hover:bg-red-50 transition-colors duration-200",title:"Delete category"},e[29]||(e[29]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Ae)])])])}),128)),K.value?(i(),r("div",He,[l(x,{onClick:ae,disabled:h.value,class:"px-4 py-2"},{default:m(()=>[h.value?(i(),r("span",Ie,"Saving Order...")):(i(),r("span",Re,"Save Category Order"))]),_:1},8,["disabled"])])):N("",!0)]))])]),t("div",Ge,[e[33]||(e[33]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-medium text-gray-900"},"Font Preferences"),t("p",{class:"mt-1 text-sm text-gray-500"}," Customize your font style and size ")],-1)),t("div",Je,[t("form",{onSubmit:U(E,["prevent"]),class:"space-y-6"},[t("div",Ke,[t("div",null,[l(d,{value:"",class:"mb-2"}),l(O,{modelValue:n.font_style,"onUpdate:modelValue":e[6]||(e[6]=s=>n.font_style=s),options:G.value,"option-value":"value","option-label":"label",placeholder:"Select font style",class:"w-full"},null,8,["modelValue","options"])]),t("div",null,[l(d,{value:"",class:"mb-2"}),l(O,{modelValue:n.font_size,"onUpdate:modelValue":e[7]||(e[7]=s=>n.font_size=s),options:J.value,"option-value":"value","option-label":"label",placeholder:"Select font size",class:"w-full"},null,8,["modelValue","options"])])]),t("div",Qe,[e[31]||(e[31]=t("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"Live Preview",-1)),t("div",Xe,[t("div",Ye,[t("p",{class:"font-bold",style:$(B.value)},"This is a heading with your font settings",4),t("p",{class:"text-sm",style:$(B.value)},"This is regular text with your chosen font style and size. The quick brown fox jumps over the lazy dog.",4),t("p",Ze,"Current: "+u(n.font_style)+" • "+u(n.font_size),1)])])]),t("div",et,[l(T,{type:"button",onClick:Y,class:"px-4 py-2"},{default:m(()=>e[32]||(e[32]=[b(" Reset to Default ")])),_:1}),l(x,{type:"submit",disabled:C.value,class:"px-4 py-2"},{default:m(()=>[C.value?(i(),r("span",tt,"Saving...")):(i(),r("span",st,"Save Font Preferences"))]),_:1},8,["disabled"])])],32)])]),V.value||v.value?(i(),r("div",ot,[t("div",lt,[t("div",at,[t("h3",rt,u(v.value?"Edit Package Category":"Add Package Category"),1),t("form",{onSubmit:U(oe,["prevent"]),class:"space-y-4"},[t("div",null,[l(d,{value:"Category Name *"}),l(F,{modelValue:a.name,"onUpdate:modelValue":e[8]||(e[8]=s=>a.name=s),type:"text",class:"mt-1 block w-full",placeholder:"e.g., Small Box, Large Sack",required:""},null,8,["modelValue"])]),t("div",null,[l(d,{value:"Category Code *"}),l(O,{modelValue:a.code,"onUpdate:modelValue":e[9]||(e[9]=s=>a.code=s),options:R.value,"option-value":"value","option-label":"label",placeholder:"Select category code",class:"mt-1 block w-full",required:""},null,8,["modelValue","options"]),e[34]||(e[34]=t("p",{class:"text-xs text-gray-500 mt-1"},"Unique identifier for the package type",-1))]),t("div",null,[l(d,{value:"Description"}),l(ge,{modelValue:a.description,"onUpdate:modelValue":e[10]||(e[10]=s=>a.description=s),class:"mt-1 block w-full",placeholder:"Brief description of this package type...",rows:3},null,8,["modelValue"])]),t("div",it,[t("div",null,[l(d,{value:"Length (cm)"}),l(F,{modelValue:a.length,"onUpdate:modelValue":e[11]||(e[11]=s=>a.length=s),type:"number",step:"0.1",min:"0",class:"mt-1 block w-full",placeholder:"0.0"},null,8,["modelValue"])]),t("div",null,[l(d,{value:"Height (cm)"}),l(F,{modelValue:a.height,"onUpdate:modelValue":e[12]||(e[12]=s=>a.height=s),type:"number",step:"0.1",min:"0",class:"mt-1 block w-full",placeholder:"0.0"},null,8,["modelValue"])]),t("div",null,[l(d,{value:"Width (cm)"}),l(F,{modelValue:a.width,"onUpdate:modelValue":e[13]||(e[13]=s=>a.width=s),type:"number",step:"0.1",min:"0",class:"mt-1 block w-full",placeholder:"0.0"},null,8,["modelValue"])])]),t("div",null,[l(d,{value:"Category Image"}),t("input",{type:"file",onChange:se,accept:"image/*",class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"},null,32),e[35]||(e[35]=t("p",{class:"text-xs text-gray-500 mt-1"},"Optional: Upload an image representing this package type",-1))]),t("div",nt,[w(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>a.is_active=s),type:"checkbox",class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[ue,a.is_active]]),l(d,{value:"Active Category",class:"ml-2"})]),t("div",dt,[l(T,{type:"button",onClick:le,class:"px-4 py-2"},{default:m(()=>e[36]||(e[36]=[b(" Cancel ")])),_:1}),l(x,{type:"submit",disabled:f.value,class:"px-4 py-2"},{default:m(()=>[f.value?(i(),r("span",ut,"Saving...")):(i(),r("span",ct,u(v.value?"Update":"Create")+" Category",1))]),_:1},8,["disabled"])])],32)])])])):N("",!0)]))}};export{kt as default};
