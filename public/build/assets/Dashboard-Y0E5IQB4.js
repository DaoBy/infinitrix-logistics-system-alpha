import{c as n,o as r,I as G,D as X,g as C,i as Y,C as Z,d as P,w as d,b as e,a as l,e as m,f as c,t as i,u as _,F as N,r as $,P as ee,J as te,L as se,s as ae,q as ie,W as b}from"./app-xrBi3RtB.js";import{E as re}from"./EmployeeLayout-DIT5z9wE.js";import{_ as oe}from"./SearchInput-BlX_e4xM.js";import{P as D}from"./Pagination-CsoGEKcO.js";import{_ as M}from"./StatusBadge-QxGUXwEo.js";import{_ as U}from"./PrimaryButton-C_K9q06y.js";import{_ as L}from"./SecondaryButton-BolX5WPO.js";import{M as ne}from"./Modal-BzGLoRAP.js";import{_ as le}from"./TextArea-Ba7Ie-8h.js";import{_ as de}from"./InputError-Z1G11hlP.js";import{D as ce}from"./DangerButton-C4ke1hY1.js";import{r as ue}from"./CheckCircleIcon-B0G0i9Ys.js";import{r as pe}from"./ArchiveBoxIcon-H6bW9hwP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-BuzuRvoY.js";const T={__name:"TabButton",props:{active:{type:Boolean,default:!1}},setup(o){return(w,u)=>(r(),n("button",X({class:["px-4 py-2 text-sm font-medium rounded-t-md border-b-2 transition-colors duration-200",o.active?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"]},w.$attrs),[G(w.$slots,"default")],16))}},me={class:"flex justify-between items-center"},ye={class:"flex items-center space-x-4"},xe={class:"py-6"},ve={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},fe={class:"flex space-x-1 mb-6 border-b border-gray-200"},ge={class:"ml-2 bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs font-medium"},he={class:"ml-2 bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium"},_e={class:"ml-2 bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium"},be={key:0,class:"space-y-6"},we={class:"bg-white shadow rounded-lg"},ke={class:"px-4 py-5 sm:p-6"},Pe={key:0,class:"text-center py-8"},Se={key:1,class:"overflow-x-auto"},je={class:"min-w-full divide-y divide-gray-200"},Ce={class:"bg-white divide-y divide-gray-200"},Re={class:"px-6 py-4 whitespace-nowrap"},Ve={class:"text-sm font-medium text-gray-900"},Ne={class:"text-sm text-gray-500 capitalize"},$e={key:0},De={class:"px-6 py-4 whitespace-nowrap"},Ae={class:"text-sm font-medium text-gray-900"},qe={class:"text-sm text-gray-500"},Fe={class:"text-xs"},Me={class:"px-6 py-4 whitespace-nowrap"},Te={class:"text-sm text-gray-900 capitalize"},Be={class:"text-sm text-gray-500"},Oe={class:"text-xs"},Ue={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Le={class:"flex justify-end space-x-2"},ze=["onClick"],Ee={key:1,class:"space-y-6"},He={class:"flex space-x-4 mb-4"},Ie={key:0,class:"bg-white shadow rounded-lg"},Ke={class:"px-4 py-5 sm:p-6"},We={key:0,class:"text-center py-4 text-sm text-gray-500"},Je={key:1,class:"overflow-x-auto"},Qe={class:"min-w-full divide-y divide-gray-200"},Ge={class:"bg-white divide-y divide-gray-200"},Xe={class:"px-6 py-4 whitespace-nowrap"},Ye={class:"text-sm font-medium text-gray-900"},Ze={class:"text-sm text-gray-500"},et={class:"px-6 py-4 whitespace-nowrap"},tt={class:"text-sm font-medium text-gray-900 capitalize"},st={class:"text-sm text-gray-500"},at={class:"px-6 py-4 whitespace-nowrap"},it={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},rt={key:1,class:"bg-white shadow rounded-lg mt-6"},ot={class:"px-4 py-5 sm:p-6"},nt={key:0,class:"text-center py-4 text-sm text-gray-500"},lt={key:1,class:"overflow-x-auto"},dt={class:"min-w-full divide-y divide-gray-200"},ct={class:"bg-white divide-y divide-gray-200"},ut={class:"px-6 py-4 whitespace-nowrap"},pt={class:"text-sm font-medium text-gray-900"},mt={class:"text-sm text-gray-500"},yt={class:"px-6 py-4 whitespace-nowrap"},xt={class:"text-sm font-medium text-gray-900"},vt={class:"px-6 py-4 whitespace-nowrap"},ft={class:"text-sm text-gray-900"},gt={class:"text-sm text-gray-500"},ht={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},_t={key:1,class:"text-xs text-gray-500"},bt={key:2,class:"space-y-6"},wt={class:"bg-white shadow rounded-lg"},kt={class:"px-4 py-5 sm:p-6"},Pt={key:0,class:"text-center py-8"},St={key:1,class:"overflow-x-auto"},jt={class:"min-w-full divide-y divide-gray-200"},Ct={class:"bg-white divide-y divide-gray-200"},Rt={class:"px-6 py-4 whitespace-nowrap"},Vt={class:"text-sm font-medium text-gray-900"},Nt={class:"text-sm text-gray-500"},$t={class:"px-6 py-4 whitespace-nowrap"},Dt={class:"text-sm text-gray-900 capitalize"},At={class:"text-sm text-gray-500"},qt={class:"px-6 py-4 whitespace-nowrap"},Ft={class:"text-sm text-gray-500 mt-1"},Mt={class:"px-6 py-4 whitespace-nowrap"},Tt={class:"text-sm text-gray-900"},Bt={class:"p-6"},Ot={class:"mt-6 flex justify-end space-x-3"},ss={__name:"Dashboard",props:{activeTab:{type:String,default:"verification"},verificationPayments:{type:Object,default:()=>({data:[]})},prepaidRequests:{type:Object,default:()=>({data:[]})},postpaidRequests:{type:Object,default:()=>({data:[]})},historyPayments:{type:Object,default:()=>({data:[]})},stats:{type:Object,default:()=>({})},filters:{type:Object,default:()=>({})}},setup(o){const w=o,u=C(w.activeTab),x=C(w.filters.search||""),h=C(w.filters.collection_type||"all"),S=C(!1),R=C(null),z=Y(()=>{switch(u.value){case"verification":return"Search payments...";case"collection":return"Search deliveries...";case"history":return"Search history...";default:return"Search..."}}),k=Z({rejection_reason:""}),A=a=>{u.value=a,x.value="",b.get(route("staff.payments.dashboard"),{tab:a},{preserveState:!0,preserveScroll:!0,replace:!0})},B=()=>{const a={tab:u.value};x.value&&(u.value==="collection"?a.collection_search=x.value:u.value==="history"?a.history_search=x.value:a.search=x.value),b.get(route("staff.payments.dashboard"),a,{preserveState:!0,preserveScroll:!0})},E=()=>{b.get(route("staff.payments.dashboard"),{tab:"collection",collection_type:h.value,collection_search:x.value},{preserveState:!0,preserveScroll:!0})},V=(a,t)=>{const s={tab:u.value};t==="verification"?s.verification_page=a:t==="prepaid"?s.prepaid_page=a:t==="postpaid"?s.postpaid_page=a:t==="history"&&(s.history_page=a),b.get(route("staff.payments.dashboard"),s,{preserveState:!0,preserveScroll:!0})},H=a=>{R.value=a,S.value=!0},I=()=>{R.value&&k.post(route("staff.payments.reject",R.value.id),{preserveScroll:!0,onSuccess:()=>{S.value=!1,k.reset(),R.value=null,b.reload({only:["verificationPayments","stats"]})}})},K=(a,t)=>{b.visit(route("staff.payments.create",{delivery_id:a}))},W=a=>{b.visit(route("staff.payments.show",a))},q=a=>{var t,s;return(t=a.payment)!=null&&t.verified_by?"verified":(s=a.payment)!=null&&s.rejected_by?"rejected":a.payment?"pending_verification":a.payment_status||"unpaid"},J=a=>{switch(q(a)){case"verified":return"success";case"rejected":return"danger";case"pending_verification":return"warning";default:return"secondary"}},Q=a=>{switch(q(a)){case"verified":return"Verified";case"rejected":return"Rejected";case"pending_verification":return"Pending Verification";default:return"Unpaid"}},O=a=>a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A";return(a,t)=>(r(),P(re,null,{header:d(()=>[e("div",me,[t[13]||(t[13]=e("div",null,[e("h2",{class:"text-xl font-semibold text-gray-800"}," Payment Management "),e("p",{class:"text-sm text-gray-600 mt-1"}," Manage all payment activities in one place ")],-1)),e("div",ye,[l(oe,{modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=s=>x.value=s),placeholder:z.value,class:"w-64",onKeyup:ie(B,["enter"])},null,8,["modelValue","placeholder"]),l(U,{onClick:B},{default:d(()=>t[12]||(t[12]=[c(" Search ")])),_:1})])])]),default:d(()=>[e("div",xe,[e("div",ve,[e("div",fe,[l(T,{active:u.value==="verification",onClick:t[1]||(t[1]=s=>A("verification")),class:"flex items-center"},{default:d(()=>[t[14]||(t[14]=c(" â³ Verification Queue ")),e("span",ge,i(o.stats.pending_verification||0),1)]),_:1},8,["active"]),l(T,{active:u.value==="collection",onClick:t[2]||(t[2]=s=>A("collection")),class:"flex items-center"},{default:d(()=>[t[15]||(t[15]=c(" ðŸ’° Collection Management ")),e("span",he,i(o.stats.needs_collection||0),1)]),_:1},8,["active"]),l(T,{active:u.value==="history",onClick:t[3]||(t[3]=s=>A("history")),class:"flex items-center"},{default:d(()=>[t[16]||(t[16]=c(" ðŸ“‹ Payment History ")),e("span",_e,i(o.stats.verified_today||0)+" today ",1)]),_:1},8,["active"])]),u.value==="verification"?(r(),n("div",be,[e("div",we,[t[21]||(t[21]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"}," Payments Needing Verification "),e("p",{class:"mt-1 text-sm text-gray-500"}," Review online payments and collector submissions. Verify or reject with reasons. ")],-1)),e("div",ke,[o.verificationPayments.data.length===0?(r(),n("div",Pe,[l(_(ue),{class:"mx-auto h-12 w-12 text-green-500"}),t[17]||(t[17]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"All caught up!",-1)),t[18]||(t[18]=e("p",{class:"mt-1 text-sm text-gray-500"},"No payments pending verification.",-1))])):(r(),n("div",Se,[e("table",je,[t[20]||(t[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reference & Method "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Customer & Amount "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Source & Submitted "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",Ce,[(r(!0),n(N,null,$(o.verificationPayments.data,s=>{var p,y,v,f,g,j;return r(),n("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Re,[e("div",Ve,i(((p=s.delivery_request)==null?void 0:p.reference_number)||"N/A"),1),e("div",Ne,[c(i(s.method)+" ",1),s.reference_number?(r(),n("span",$e,"#"+i(s.reference_number),1)):m("",!0)])]),e("td",De,[e("div",Ae,i(((v=(y=s.delivery_request)==null?void 0:y.sender)==null?void 0:v.name)||"N/A"),1),e("div",qe,[c(" â‚±"+i(parseFloat(s.amount||0).toFixed(2))+" ",1),e("span",Fe,"(Due: â‚±"+i(((f=s.delivery_request)==null?void 0:f.total_price)||"0.00")+")",1)])]),e("td",Me,[e("div",Te,i(((g=s.source)==null?void 0:g.replace(/_/g," "))||"N/A"),1),e("div",Be,[c(i(O(s.created_at))+" ",1),e("span",Oe,"by "+i(((j=s.submitted_by)==null?void 0:j.name)||"System"),1)])]),e("td",Ue,[e("div",Le,[l(_(ee),{href:a.route("staff.payments.verify",s.id),class:"text-blue-600 hover:text-blue-900 px-3 py-1 border border-blue-600 rounded text-xs"},{default:d(()=>t[19]||(t[19]=[c(" Review ")])),_:2},1032,["href"]),e("button",{onClick:F=>H(s),class:"text-red-600 hover:text-red-900 px-3 py-1 border border-red-600 rounded text-xs"}," Reject ",8,ze)])])])}),128))])])])),o.verificationPayments.meta&&o.verificationPayments.meta.last_page>1?(r(),P(D,{key:2,pagination:o.verificationPayments.meta,onPageChanged:t[4]||(t[4]=s=>V(s,"verification")),class:"mt-6"},null,8,["pagination"])):m("",!0)])])])):m("",!0),u.value==="collection"?(r(),n("div",Ee,[e("div",He,[te(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>h.value=s),onChange:E,class:"border-gray-300 rounded-md shadow-sm"},t[22]||(t[22]=[e("option",{value:"all"},"All Types",-1),e("option",{value:"prepaid"},"Prepaid Deliveries",-1),e("option",{value:"postpaid"},"Postpaid Deliveries",-1)]),544),[[se,h.value]])]),h.value==="all"||h.value==="prepaid"?(r(),n("div",Ie,[t[25]||(t[25]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"}," Prepaid Deliveries Needing Payment "),e("p",{class:"mt-1 text-sm text-gray-500"}," Record cash payments or track online payment status for prepaid deliveries. ")],-1)),e("div",Ke,[o.prepaidRequests.data.length===0?(r(),n("div",We," No prepaid deliveries needing payment. ")):(r(),n("div",Je,[e("table",Qe,[t[24]||(t[24]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reference & Sender "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Payment Method & Amount "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",Ge,[(r(!0),n(N,null,$(o.prepaidRequests.data,s=>{var p;return r(),n("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Xe,[e("div",Ye,i(s.reference_number||`DR-${String(s.id).padStart(6,"0")}`),1),e("div",Ze,i(((p=s.sender)==null?void 0:p.name)||"N/A"),1)]),e("td",et,[e("div",tt,i(s.payment_method),1),e("div",st," â‚±"+i(parseFloat(s.total_price||0).toFixed(2)),1)]),e("td",at,[l(M,{status:q(s),variant:J(s)},{default:d(()=>[c(i(Q(s)),1)]),_:2},1032,["status","variant"])]),e("td",it,[l(U,{onClick:y=>K(s.id,"prepaid"),class:"text-xs"},{default:d(()=>t[23]||(t[23]=[c(" Record Payment ")])),_:2},1032,["onClick"])])])}),128))])])])),o.prepaidRequests.meta&&o.prepaidRequests.meta.last_page>1?(r(),P(D,{key:2,pagination:o.prepaidRequests.meta,onPageChanged:t[6]||(t[6]=s=>V(s,"prepaid")),class:"mt-6"},null,8,["pagination"])):m("",!0)])])):m("",!0),h.value==="all"||h.value==="postpaid"?(r(),n("div",rt,[t[28]||(t[28]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"}," Postpaid Deliveries Needing Collection "),e("p",{class:"mt-1 text-sm text-gray-500"}," Track postpaid deliveries that require payment collection after delivery. ")],-1)),e("div",ot,[o.postpaidRequests.data.length===0?(r(),n("div",nt," No postpaid deliveries needing collection. ")):(r(),n("div",lt,[e("table",dt,[t[27]||(t[27]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Order & Sender "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Amount & Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Delivery Info "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",ct,[(r(!0),n(N,null,$(o.postpaidRequests.data,s=>{var p,y,v,f,g,j,F;return r(),n("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",ut,[e("div",pt,i(((p=s.delivery_request)==null?void 0:p.reference_number)||`DR-${String((y=s.delivery_request)==null?void 0:y.id).padStart(6,"0")}`),1),e("div",mt,i(((f=(v=s.delivery_request)==null?void 0:v.sender)==null?void 0:f.name)||"N/A"),1)]),e("td",yt,[e("div",xt," â‚±"+i(parseFloat(((g=s.delivery_request)==null?void 0:g.total_price)||0).toFixed(2)),1),l(M,{status:s.payment_status,variant:s.payment_status==="collected"?"info":"warning",class:"mt-1"},{default:d(()=>[c(i(s.payment_status==="collected"?"Collected":"Uncollected"),1)]),_:2},1032,["status","variant"])]),e("td",vt,[e("div",ft,i(s.status),1),e("div",gt,i(((j=s.driver)==null?void 0:j.name)||"No driver"),1)]),e("td",ht,[s.payment_status==="collected"&&((F=s.delivery_request)!=null&&F.payment)?(r(),P(L,{key:0,onClick:Ut=>W(s.delivery_request.payment.id),class:"text-xs"},{default:d(()=>t[26]||(t[26]=[c(" View Payment ")])),_:2},1032,["onClick"])):(r(),n("span",_t," Awaiting collection "))])])}),128))])])])),o.postpaidRequests.meta&&o.postpaidRequests.meta.last_page>1?(r(),P(D,{key:2,pagination:o.postpaidRequests.meta,onPageChanged:t[7]||(t[7]=s=>V(s,"postpaid")),class:"mt-6"},null,8,["pagination"])):m("",!0)])])):m("",!0)])):m("",!0),u.value==="history"?(r(),n("div",bt,[e("div",wt,[t[32]||(t[32]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"}," Payment History "),e("p",{class:"mt-1 text-sm text-gray-500"}," View all processed payments - verified, rejected, and historical records. ")],-1)),e("div",kt,[o.historyPayments.data.length===0?(r(),n("div",Pt,[l(_(pe),{class:"mx-auto h-12 w-12 text-gray-400"}),t[29]||(t[29]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No payment history",-1)),t[30]||(t[30]=e("p",{class:"mt-1 text-sm text-gray-500"},"Processed payments will appear here.",-1))])):(r(),n("div",St,[e("table",jt,[t[31]||(t[31]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reference & Customer "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Method & Amount "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status & Verifier "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date Processed ")])],-1)),e("tbody",Ct,[(r(!0),n(N,null,$(o.historyPayments.data,s=>{var p,y,v,f,g;return r(),n("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Rt,[e("div",Vt,i(((p=s.delivery_request)==null?void 0:p.reference_number)||"N/A"),1),e("div",Nt,i(((v=(y=s.delivery_request)==null?void 0:y.sender)==null?void 0:v.name)||"N/A"),1)]),e("td",$t,[e("div",Dt,i(s.method),1),e("div",At," â‚±"+i(parseFloat(s.amount||0).toFixed(2)),1)]),e("td",qt,[l(M,{status:s.status,variant:s.status==="verified"?"success":"danger"},{default:d(()=>[c(i(s.status==="verified"?"Verified":"Rejected"),1)]),_:2},1032,["status","variant"]),e("div",Ft," by "+i(((f=s.verified_by)==null?void 0:f.name)||((g=s.rejected_by)==null?void 0:g.name)||"System"),1)]),e("td",Mt,[e("div",Tt,i(O(s.verified_at||s.rejected_at||s.updated_at)),1)])])}),128))])])])),o.historyPayments.meta&&o.historyPayments.meta.last_page>1?(r(),P(D,{key:2,pagination:o.historyPayments.meta,onPageChanged:t[8]||(t[8]=s=>V(s,"history")),class:"mt-6"},null,8,["pagination"])):m("",!0)])])])):m("",!0)])]),l(ne,{show:S.value,onClose:t[11]||(t[11]=s=>S.value=!1)},{default:d(()=>[e("div",Bt,[t[35]||(t[35]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Reject Payment ",-1)),e("form",{onSubmit:ae(I,["prevent"])},[l(le,{modelValue:_(k).rejection_reason,"onUpdate:modelValue":t[9]||(t[9]=s=>_(k).rejection_reason=s),placeholder:"Enter rejection reason...",rows:"4",class:"w-full"},null,8,["modelValue"]),l(de,{message:_(k).errors.rejection_reason,class:"mt-2"},null,8,["message"]),e("div",Ot,[l(L,{onClick:t[10]||(t[10]=s=>S.value=!1)},{default:d(()=>t[33]||(t[33]=[c(" Cancel ")])),_:1}),l(ce,{type:"submit",disabled:_(k).processing},{default:d(()=>t[34]||(t[34]=[c(" Confirm Reject ")])),_:1},8,["disabled"])])],32)])]),_:1},8,["show"])]),_:1}))}};export{ss as default};
