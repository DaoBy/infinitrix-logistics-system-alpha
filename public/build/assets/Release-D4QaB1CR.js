import{i as u,C as Me,d as ze,o as i,w as g,b as e,t as r,f as y,c as o,e as v,a as l,F as Ge,r as He,u as m,p as Je,W as Ee}from"./app-B0R_bMJi.js";import{E as Ke}from"./EmployeeLayout-BQLa5PLV.js";import{_ as Te}from"./PrimaryButton-z6gddSkS.js";/* empty css                                                                  */import{_ as Qe}from"./TextArea-DUZFOSeU.js";import{_ as Xe}from"./PaymentStatusBadge-C7Ui0v1p.js";import{_ as Ye}from"./StatusBadge-c3owwLTJ.js";import{L as Ze}from"./LoadingSpinner-ZMvEcnIG.js";import{u as et}from"./index-4gnSGlTA.js";import{r as tt}from"./ExclamationTriangleIcon-CPUbss0Z.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-BchASNUp.js";import"./DangerButton-DlTel5kP.js";const st={class:"flex justify-between items-center px-6"},rt={class:"px-2 md:px-6 py-4 max-w-5xl mx-auto"},at={class:"bg-white dark:bg-gray-800 shadow-sm rounded-lg border border-gray-200 dark:border-gray-700 mb-6"},dt={class:"flex flex-col md:flex-row md:items-center md:justify-between p-4 bg-indigo-50 dark:bg-indigo-900 border-b border-gray-200 dark:border-gray-700"},it={class:"flex items-center gap-2"},ot={class:"text-lg font-bold text-indigo-900 dark:text-indigo-100 tracking-wide"},lt={class:"mt-1 text-xs text-gray-500 dark:text-gray-300"},nt={key:0},ut={class:"p-4 md:p-6"},yt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6"},mt={class:"bg-gray-50 dark:bg-gray-700/50 p-3 md:p-4 rounded-lg flex flex-col gap-1"},ct={class:"font-medium truncate"},pt={class:"text-xs text-gray-600 dark:text-gray-400 truncate"},gt={class:"text-xs text-gray-600 dark:text-gray-400 truncate"},vt={class:"bg-gray-50 dark:bg-gray-700/50 p-3 md:p-4 rounded-lg flex flex-col gap-1"},xt={class:"font-medium truncate"},_t={class:"text-xs text-gray-600 dark:text-gray-400 truncate"},ft={class:"text-xs text-gray-600 dark:text-gray-400 truncate"},bt={class:"bg-gray-50 dark:bg-gray-700/50 p-3 md:p-4 rounded-lg flex flex-col gap-1"},kt={class:"flex items-center gap-2 mb-1"},ht={class:"text-xs text-gray-600 dark:text-gray-400"},wt={key:0,class:"text-xs text-gray-600 dark:text-gray-400"},Rt={key:0},qt={class:"font-medium text-gray-900 dark:text-gray-100 mt-1"},Nt={class:"bg-white dark:bg-gray-800 shadow-sm rounded-lg border border-gray-200 dark:border-gray-700 mb-6"},Ct={class:"p-3 md:p-4 bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-700"},Dt={class:"font-medium text-gray-900 dark:text-gray-100"},Pt={class:"p-3 md:p-6 overflow-x-auto"},St={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Vt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},At={class:"px-3 py-2 whitespace-nowrap font-medium text-gray-900 dark:text-gray-100"},Bt={class:"px-3 py-2 whitespace-nowrap font-medium text-gray-900 dark:text-gray-100"},jt={class:"px-3 py-2 whitespace-nowrap text-gray-900 dark:text-gray-100"},Ft={class:"px-3 py-2 whitespace-nowrap text-gray-900 dark:text-gray-100"},Lt={class:"px-3 py-2 whitespace-nowrap text-gray-900 dark:text-gray-100"},Et={class:"px-3 py-2 whitespace-nowrap"},Tt={class:"bg-white dark:bg-gray-800 shadow-sm rounded-lg border border-gray-200 dark:border-gray-700"},Ut={class:"p-4 md:p-6"},$t={key:0,class:"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 dark:border-yellow-600 p-3 md:p-4 mb-4 md:mb-6"},It={class:"flex"},Ot={class:"flex-shrink-0"},Wt={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-4 md:mb-6"},Mt={class:"mb-1"},zt={class:"flex justify-end mt-4 md:mt-6"},Gt={key:0},Ht={key:1},os={__name:"Release",props:{order:{type:Object,default:()=>({id:null,status:"",deliveryRequest:null})}},setup(Ue){var R,q,N,C;const x=et(),f=Ue,s=u(()=>({...f.order,deliveryRequest:f.order.deliveryRequest||{sender:{},receiver:{},packages:[],payment:null}})),n=Me({receiver_name:((q=(R=s.value.deliveryRequest)==null?void 0:R.receiver)==null?void 0:q.name)||"",receiver_contact:((C=(N=s.value.deliveryRequest)==null?void 0:N.receiver)==null?void 0:C.mobile)||"",notes:""}),_=u(()=>{var a;return((a=s.value.deliveryRequest)==null?void 0:a.payment_type)==="prepaid"}),$e=u(()=>{var a;return((a=s.value.deliveryRequest)==null?void 0:a.payment_type)==="postpaid"}),b=u(()=>{var a,t,c,p;return((t=(a=s.value.deliveryRequest)==null?void 0:a.payment)==null?void 0:t.verified_by)!==null&&((p=(c=s.value.deliveryRequest)==null?void 0:c.payment)==null?void 0:p.verified_by)!==void 0}),Ie=u(()=>s.value.status==="delivered"),k=u(()=>!(!Ie.value||_.value&&!b.value)),Oe=async()=>{if(!k.value){x.error("Cannot release packages - validation failed");return}n.post(route("cargo-assignments.delivery-completion.complete",s.value.id),{onSuccess:()=>{x.success("Delivery completed successfully"),Ee.visit(route("cargo-assignments.delivery-completion.ready-for-release"))},onError:()=>{x.error("Failed to complete delivery")}})};function h(a){const t=typeof a=="number"?a:parseFloat(a||0);return isNaN(t)?"0.00":t.toFixed(2)}function w(a){if(!a)return"N/A";try{return new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"Invalid date"}}function We(){Ee.visit(route("cargo-assignments.delivery-completion.ready-for-release"))}return(a,t)=>(i(),ze(Ke,null,{header:g(()=>[e("div",st,[t[2]||(t[2]=e("h2",{class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"}," Package Release ",-1)),l(Te,{onClick:We,class:"inline-flex items-center"},{default:g(()=>t[1]||(t[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),y(" Back to releases ")])),_:1})])]),default:g(()=>{var c,p,D,P,S,V,A,B,j,F,L,E,T,U,$,I,O,W,M,z,G,H,J,K,Q,X,Y,Z,ee,te,se,re,ae,de,ie,oe,le,ne,ue,ye,me,ce,pe,ge,ve,xe,_e,fe,be,ke,he,we,Re,qe,Ne,Ce,De,Pe,Se,Ve,Ae,Be,je,Fe,Le;return[e("div",rt,[e("div",at,[e("div",dt,[e("div",null,[e("div",it,[t[3]||(t[3]=e("span",{class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-indigo-100 text-indigo-800 dark:bg-indigo-800 dark:text-indigo-100"}," Reference # ",-1)),e("span",ot,r(((p=(c=s.value)==null?void 0:c.deliveryRequest)==null?void 0:p.reference_number)||"DR-"+(((P=(D=s.value)==null?void 0:D.deliveryRequest)==null?void 0:P.id)??((S=s.value)==null?void 0:S.id)).toString().padStart(6,"0")),1)]),e("div",lt,[y(" Order ID: DO-"+r(((A=(V=s.value)==null?void 0:V.id)==null?void 0:A.toString().padStart(6,"0"))||"")+" ",1),(j=(B=s.value)==null?void 0:B.deliveryRequest)!=null&&j.created_at?(i(),o("span",nt," | Created: "+r(w((L=(F=s.value)==null?void 0:F.deliveryRequest)==null?void 0:L.created_at)),1)):v("",!0)])]),t[4]||(t[4]=e("div",{class:"mt-3 md:mt-0 flex items-center gap-2"},null,-1))]),e("div",ut,[e("div",yt,[e("div",mt,[t[5]||(t[5]=e("h3",{class:"text-base font-medium text-gray-900 dark:text-gray-100 mb-2"},"Sender",-1)),e("p",ct,r(((U=(T=(E=s.value)==null?void 0:E.deliveryRequest)==null?void 0:T.sender)==null?void 0:U.name)??"N/A"),1),e("p",pt,r(((O=(I=($=s.value)==null?void 0:$.deliveryRequest)==null?void 0:I.sender)==null?void 0:O.mobile)??""),1),e("p",gt,r(((z=(M=(W=s.value)==null?void 0:W.deliveryRequest)==null?void 0:M.sender)==null?void 0:z.address)??""),1)]),e("div",vt,[t[6]||(t[6]=e("h3",{class:"text-base font-medium text-gray-900 dark:text-gray-100 mb-2"},"Receiver",-1)),e("p",xt,r(((J=(H=(G=s.value)==null?void 0:G.deliveryRequest)==null?void 0:H.receiver)==null?void 0:J.name)??"N/A"),1),e("p",_t,r(((X=(Q=(K=s.value)==null?void 0:K.deliveryRequest)==null?void 0:Q.receiver)==null?void 0:X.mobile)??""),1),e("p",ft,r(((ee=(Z=(Y=s.value)==null?void 0:Y.deliveryRequest)==null?void 0:Z.receiver)==null?void 0:ee.address)??""),1)]),e("div",bt,[t[10]||(t[10]=e("h3",{class:"text-base font-medium text-gray-900 dark:text-gray-100 mb-2"},"Payment",-1)),e("div",kt,[l(Xe,{payment:(se=(te=s.value)==null?void 0:te.deliveryRequest)==null?void 0:se.payment,delivery:(re=s.value)==null?void 0:re.deliveryRequest},null,8,["payment","delivery"]),e("span",ht,r(((ie=(de=(ae=s.value)==null?void 0:ae.deliveryRequest)==null?void 0:de.payment_type)==null?void 0:ie.toUpperCase())||"")+" - "+r(((ne=(le=(oe=s.value)==null?void 0:oe.deliveryRequest)==null?void 0:le.payment_method)==null?void 0:ne.toUpperCase())||""),1)]),((ye=(ue=s.value)==null?void 0:ue.deliveryRequest)==null?void 0:ye.payment_type)==="postpaid"?(i(),o("p",wt,[t[9]||(t[9]=e("span",{class:"font-semibold"},"Terms:",-1)),e("span",null,r(((ce=(me=s.value)==null?void 0:me.deliveryRequest)==null?void 0:ce.payment_terms)==="net_7"?"Net 7":((ge=(pe=s.value)==null?void 0:pe.deliveryRequest)==null?void 0:ge.payment_terms)==="net_15"?"Net 15":((xe=(ve=s.value)==null?void 0:ve.deliveryRequest)==null?void 0:xe.payment_terms)==="net_30"?"Net 30":((fe=(_e=s.value)==null?void 0:_e.deliveryRequest)==null?void 0:fe.payment_terms)==="cnd"?"CND":((ke=(be=s.value)==null?void 0:be.deliveryRequest)==null?void 0:ke.payment_terms)||"N/A"),1),(we=(he=s.value)==null?void 0:he.deliveryRequest)!=null&&we.payment_due_date?(i(),o("span",Rt,[t[7]||(t[7]=y("  | ")),t[8]||(t[8]=e("span",{class:"font-semibold"},"Due:",-1)),y(" "+r(w((qe=(Re=s.value)==null?void 0:Re.deliveryRequest)==null?void 0:qe.payment_due_date)),1)])):v("",!0)])):v("",!0),e("p",qt," ₱"+r(h((Ce=(Ne=s.value)==null?void 0:Ne.deliveryRequest)==null?void 0:Ce.total_price)),1)])])])]),e("div",Nt,[e("div",Ct,[e("h3",Dt," Packages ("+r(((Se=(Pe=(De=s.value)==null?void 0:De.deliveryRequest)==null?void 0:Pe.packages)==null?void 0:Se.length)||0)+") ",1)]),e("div",Pt,[e("table",St,[t[11]||(t[11]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Item"),e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Category"),e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Dimensions"),e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Weight"),e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Declared Value"),e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Status")])],-1)),e("tbody",Vt,[(i(!0),o(Ge,null,He(((Ae=(Ve=s.value)==null?void 0:Ve.deliveryRequest)==null?void 0:Ae.packages)||[],d=>(i(),o("tr",{key:d.id},[e("td",At,r(d.item_name),1),e("td",Bt,r(d.category||"N/A"),1),e("td",jt,r(d.length)+"×"+r(d.width)+"×"+r(d.height)+" cm ",1),e("td",Ft,r(d.weight)+" kg ",1),e("td",Lt," ₱"+r(h(d.declared_value)),1),e("td",Et,[l(Ye,{status:d.status,variant:d.status==="delivered"?"success":"info"},{default:g(()=>[y(r(d.status.replace("_"," ")),1)]),_:2},1032,["status","variant"])])]))),128))])])])]),e("div",Tt,[t[16]||(t[16]=e("div",{class:"p-3 md:p-4 bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"font-medium text-gray-900 dark:text-gray-100"}," Confirm Package Release ")],-1)),e("div",Ut,[_.value&&!b.value?(i(),o("div",$t,[e("div",It,[e("div",Ot,[l(m(tt),{class:"h-5 w-5 text-yellow-400 dark:text-yellow-500"})]),t[12]||(t[12]=e("div",{class:"ml-3"},[e("p",{class:"text-sm text-yellow-700 dark:text-yellow-300"}," Prepaid payment must be verified before releasing packages. ")],-1))])])):v("",!0),e("form",{onSubmit:Je(Oe,["prevent"])},[$e.value?(i(),o("div",Wt,[e("div",null,[e("div",Mt,[t[13]||(t[13]=e("span",{class:"font-semibold"},"Receiver Name:",-1)),e("span",null,r(((je=(Be=s.value.deliveryRequest)==null?void 0:Be.receiver)==null?void 0:je.name)||"N/A"),1)]),e("div",null,[t[14]||(t[14]=e("span",{class:"font-semibold"},"Receiver Contact:",-1)),e("span",null,r(((Le=(Fe=s.value.deliveryRequest)==null?void 0:Fe.receiver)==null?void 0:Le.mobile)||"N/A"),1)])])])):v("",!0),l(Qe,{modelValue:m(n).notes,"onUpdate:modelValue":t[0]||(t[0]=d=>m(n).notes=d),label:"Release Notes",placeholder:"Any special instructions or notes about this release...",error:m(n).errors.notes,class:"mb-4"},null,8,["modelValue","error"]),e("div",zt,[l(Te,{type:"submit",disabled:!k.value||m(n).processing},{default:g(()=>[m(n).processing?(i(),o("span",Gt,[l(Ze,{size:"xs",class:"mr-2"}),t[15]||(t[15]=y(" Processing... "))])):(i(),o("span",Ht,r(_.value?"Release Packages":"Complete Delivery"),1))]),_:1},8,["disabled"])])],32)])])])]}),_:1}))}};export{os as default};
