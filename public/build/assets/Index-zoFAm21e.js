import{g as p,i as te,C as ae,d as j,o as n,w as l,b as s,a as g,c as d,e as m,t as o,F as D,r as M,n as B,f as b,k as se,J as U,u as x,L as re,K as le,W as k}from"./app-DSvpKds8.js";import{E as oe}from"./EmployeeLayout-41rkCMFi.js";import{_ as T}from"./PrimaryButton-BaAbC_Sk.js";import{_ as $}from"./SecondaryButton-BMk3kL1H.js";import{_ as ne}from"./SearchInput-BdZpY5qg.js";import{S as F}from"./SelectInput-CJKTp_P8.js";import{_ as ie}from"./DataTable-Bq8Hbpmy.js";import{M as de}from"./Modal-CPqIeUsw.js";import{P as ue}from"./Pagination-lASWqMkU.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-B7vUiQXa.js";import"./DangerButton-Bd5m9G75.js";const ge={class:"flex justify-between items-center w-full px-6 md:px-8"},me={class:"flex gap-2"},pe={class:"zoom-content"},fe={class:"px-6 py-4"},ve={key:0,class:"mb-4"},be={key:0,class:"p-3 bg-blue-100 text-blue-800 rounded"},xe={key:1,class:"p-3 bg-green-100 text-green-800 rounded"},ke={key:2,class:"p-3 bg-red-100 text-red-800 rounded"},ye={key:1,class:"bg-white shadow-sm rounded-lg overflow-hidden border border-gray-200 mb-4"},_e={class:"p-4"},he={class:"flex flex-wrap gap-2"},we=["onClick"],Ce={class:"mb-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3"},Se={class:"w-full sm:w-96"},Re={class:"flex items-center gap-3"},Le={class:"text-sm text-gray-500 bg-blue-50 px-3 py-1 rounded border border-blue-100 whitespace-nowrap"},Pe={key:0,class:"ml-1"},Ve={class:"justify-center flex items-center"},Ne={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-full max-w-[95vw]"},je={class:"p-4 bg-white border-b border-gray-200"},Be={class:"font-medium text-gray-900"},Te={class:"text-gray-900"},$e={class:"flex items-center"},Ae={class:"text-gray-700"},De={class:"flex space-x-2"},Me={class:"text-center py-8"},Ue={class:"bg-gray-50 rounded-lg p-6 max-w-md mx-auto"},Fe={class:"text-gray-500 mb-3"},Ie={key:0,class:"mt-4"},Ee={class:"p-5"},ze={class:"space-y-4"},Oe=["value"],We={class:"mt-6 flex justify-end space-x-3"},qe={key:0},He={key:1},Je={__name:"Index",props:{packages:Object,status:String,success:String,error:String},setup(r){const C=r,f=p(""),y=p(""),_=p(""),h=p("item_code"),S=p("asc"),w=p(!1),R=p(!1),L=p(null),I=[{field:"item_code",header:"Item Code",sortable:!0},{field:"item_name",header:"Item Name",sortable:!0},{field:"category",header:"Category",sortable:!0},{field:"status",header:"Status",sortable:!0},{field:"current_region",header:"Current Location",sortable:!0},{field:"actions",header:"Actions",sortable:!1}],E=[{value:"",text:"All Categories"},{value:"piece",text:"Piece"},{value:"carton",text:"Carton"},{value:"sack",text:"Sack"},{value:"roll",text:"Roll"},{value:"B/R",text:"Bundle/Roll"},{value:"C/S",text:"Custom Size"}],z=[{value:"",text:"All Statuses"},{value:"preparing",text:"Preparing"},{value:"ready_for_pickup",text:"Ready for Pickup"},{value:"loaded",text:"Loaded"},{value:"in_transit",text:"In Transit"},{value:"delivered",text:"Delivered"},{value:"completed",text:"Completed"},{value:"returned",text:"Returned"},{value:"rejected",text:"Rejected"},{value:"damaged_in_transit",text:"Damaged in Transit"},{value:"lost_in_transit",text:"Lost in Transit"}],A=[{value:"preparing",title:"Preparing"},{value:"ready_for_pickup",title:"Ready for Pickup"},{value:"loaded",title:"Loaded"},{value:"in_transit",title:"In Transit"},{value:"delivered",title:"Delivered"},{value:"completed",title:"Completed"},{value:"returned",title:"Returned"},{value:"rejected",title:"Rejected"},{value:"damaged_in_transit",title:"Damaged in Transit"},{value:"lost_in_transit",title:"Lost in Transit"}],O={preparing:"Preparing",ready_for_pickup:"Ready for Pickup",loaded:"Loaded",in_transit:"In Transit",delivered:"Delivered",completed:"Completed",returned:"Returned",rejected:"Rejected",damaged_in_transit:"Damaged in Transit",lost_in_transit:"Lost in Transit"};function W(a){return a?{piece:"Piece",carton:"Carton",sack:"Sack",roll:"Roll","B/R":"Bundle/Roll","C/S":"Carton/Sack"}[a]||a:"N/A"}const P=te(()=>(Array.isArray(C.packages)?C.packages:C.packages.data||[]).filter(e=>{const t=f.value===""||e.item_code.toLowerCase().includes(f.value.toLowerCase())||e.item_name.toLowerCase().includes(f.value.toLowerCase())||e.waybill_number&&e.waybill_number.toLowerCase().includes(f.value.toLowerCase()),i=y.value===""||e.category===y.value,c=_.value===""||e.status===_.value;return t&&i&&c}).sort((e,t)=>{const i=S.value==="asc"?1:-1;let c=e[h.value],v=t[h.value];return c==null&&(c=""),v==null&&(v=""),c=String(c).toLowerCase(),v=String(v).toLowerCase(),c<v?-1*i:c>v?1*i:0})),u=ae({package_id:null,status:"",remarks:""});function q(a){h.value=a.field,S.value=a.direction}function H(a){k.get(route("admin.packages.index",{page:a}),{preserveState:!0,preserveScroll:!0,replace:!0})}function J(){k.reload()}function K(a){const e=["packages.track","packages.show","admin.packages.show","employee.packages.show"];for(const t of e)if(route().has(t)){k.get(route(t,a));return}k.get(`/packages/${a}`)}function G(a){L.value=a,u.package_id=a.id,u.status=a.status,u.remarks="",R.value=!0}function V(){R.value=!1,u.reset(),L.value=null}function Q(){const a=["admin.packages.mark-status","packages.update-status","employee.packages.update-status"];let e=!1;for(const t of a)if(route().has(t)){u.put(route(t,L.value.id),{preserveScroll:!0,onSuccess:()=>{V()}}),e=!0;break}e||(console.error("No valid status update route found"),alert("Error: Could not find update route"))}function X(a){if(N.value.length===0){alert("Please select at least one package");return}if(confirm(`Are you sure you want to update ${N.value.length} package(s) to ${a}?`)){const e=["admin.packages.bulk-status","packages.bulk-status","employee.packages.bulk-status"];let t=!1;for(const i of e)if(route().has(i)){k.post(route(i),{package_ids:N.value.map(c=>c.id),status:a},{preserveScroll:!0}),t=!0;break}t||(console.error("No valid bulk status route found"),alert("Error: Could not find bulk update route"))}}function Y(a){return a==="delivered"||a==="completed"?"bg-green-500 text-white hover:bg-green-600":a==="returned"||a==="rejected"?"bg-red-500 text-white hover:bg-red-600":a==="in_transit"||a==="loaded"||a==="ready_for_pickup"?"bg-green-500 text-white hover:bg-green-600":a==="preparing"?"bg-yellow-500 text-white hover:bg-yellow-600":a==="damaged_in_transit"||a==="lost_in_transit"?"bg-red-500 text-white hover:bg-red-600":"bg-gray-500 text-white hover:bg-gray-600"}function Z(a){return a==="delivered"||a==="completed"?"bg-green-100 text-green-800":a==="returned"||a==="rejected"?"bg-red-100 text-red-800":a==="in_transit"||a==="loaded"||a==="ready_for_pickup"?"bg-green-100 text-green-800":a==="preparing"?"bg-yellow-100 text-yellow-800":a==="damaged_in_transit"||a==="lost_in_transit"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}function ee(a){switch(a){case"piece":return"bg-blue-100 text-blue-800";case"carton":return"bg-green-100 text-green-800";case"sack":return"bg-amber-100 text-amber-800";case"roll":return"bg-red-100 text-red-800";case"B/R":return"bg-indigo-100 text-indigo-800";case"C/S":return"bg-pink-100 text-pink-800";default:return"bg-gray-100 text-gray-800"}}const N=p([]);return(a,e)=>(n(),j(oe,null,{header:l(()=>[s("div",ge,[e[7]||(e[7]=s("div",null,[s("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Package Monitoring"),s("p",{class:"mt-1 text-sm text-gray-500"}," Track and manage package status and locations ")],-1)),s("div",me,[g($,{onClick:J},{default:l(()=>e[6]||(e[6]=[b("Refresh Data")])),_:1}),a.$page.props.auth.user.is_admin?(n(),j(T,{key:0,onClick:e[0]||(e[0]=t=>w.value=!w.value)},{default:l(()=>[b(o(w.value?"Hide Tools":"Status Tools"),1)]),_:1})):m("",!0)])])]),default:l(()=>[s("div",pe,[s("div",fe,[r.status||r.success||r.error?(n(),d("div",ve,[r.status?(n(),d("div",be,o(r.status),1)):m("",!0),r.success?(n(),d("div",xe,o(r.success),1)):m("",!0),r.error?(n(),d("div",ke,o(r.error),1)):m("",!0)])):m("",!0),w.value&&a.$page.props.auth.user.is_admin?(n(),d("div",ye,[e[8]||(e[8]=s("div",{class:"p-4 bg-blue-50 border-b border-gray-200"},[s("h3",{class:"font-medium text-gray-900 flex items-center"}," Bulk Status Actions ")],-1)),s("div",_e,[s("div",he,[(n(),d(D,null,M(A,t=>s("button",{key:t.value,onClick:i=>X(t.value),class:B(["px-3 py-1.5 text-sm rounded-md",Y(t.value)])}," Mark as "+o(t.title),11,we)),64))])])])):m("",!0),s("div",Ce,[s("div",Se,[g(ne,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=t=>f.value=t),placeholder:"Search packages by item code, name, or waybill...",class:"w-full"},null,8,["modelValue"])]),s("div",Re,[g(F,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=t=>y.value=t),options:E,"option-value":"value","option-label":"text",placeholder:"All Categories",class:"w-full sm:w-48"},null,8,["modelValue"]),g(F,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=t=>_.value=t),options:z,"option-value":"value","option-label":"text",placeholder:"All Statuses",class:"w-full sm:w-48"},null,8,["modelValue"]),s("div",Le,[b(" ðŸ“¦ Showing "+o(P.value.length)+" "+o(P.value.length===1?"package":"packages")+" ",1),r.packages.data&&r.packages.data.length<r.packages.total?(n(),d("span",Pe," (Page "+o(r.packages.current_page)+" of "+o(r.packages.last_page)+") ",1)):m("",!0)])])]),s("div",Ve,[s("div",Ne,[s("div",je,[g(ie,{columns:I,data:P.value,"sort-field":h.value,"sort-direction":S.value,onSort:q,class:"w-full"},{item_code:l(({row:t})=>[s("div",Be,o(t.item_code),1)]),item_name:l(({row:t})=>[s("div",Te,o(t.item_name),1)]),category:l(({row:t})=>[s("span",{class:B(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",ee(t.category)])},o(W(t.category)),3)]),status:l(({row:t})=>[s("span",{class:B(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",Z(t.status)])},o(O[t.status]||"N/A"),3)]),current_region:l(({row:t})=>{var i;return[s("div",$e,[t.current_region&&t.current_region.color_hex?(n(),d("div",{key:0,class:"w-3 h-3 rounded-full mr-2 border border-gray-300",style:se({backgroundColor:t.current_region.color_hex})},null,4)):m("",!0),s("span",Ae,o(((i=t.current_region)==null?void 0:i.name)||"N/A"),1)])]}),actions:l(({row:t})=>[s("div",De,[g($,{onClick:i=>K(t.id),class:"text-xs py-1 px-2"},{default:l(()=>e[9]||(e[9]=[b("View")])),_:2},1032,["onClick"]),a.$page.props.auth.user.is_admin?(n(),j(T,{key:0,onClick:i=>G(t),class:"text-xs py-1 px-2"},{default:l(()=>e[10]||(e[10]=[b(" Update Status ")])),_:2},1032,["onClick"])):m("",!0)])]),empty:l(()=>[s("div",Me,[s("div",Ue,[e[11]||(e[11]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-10 w-10 text-gray-400 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1)),e[12]||(e[12]=s("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No packages found",-1)),s("p",Fe,o(f.value?"Try adjusting your search terms":"No packages are currently being tracked"),1)])])]),_:1},8,["data","sort-field","sort-direction"]),r.packages&&r.packages.links&&r.packages.links.length>3?(n(),d("div",Ie,[g(ue,{pagination:r.packages,onPageChanged:H},null,8,["pagination"])])):m("",!0)])])])])]),g(de,{show:R.value,onClose:V,"max-width":"md"},{default:l(()=>[s("div",Ee,[e[17]||(e[17]=s("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Update Package Status",-1)),s("div",ze,[s("div",null,[e[14]||(e[14]=s("label",{for:"status",class:"block text-sm font-medium text-gray-700"},"New Status *",-1)),U(s("select",{id:"status","onUpdate:modelValue":e[4]||(e[4]=t=>x(u).status=t),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},[e[13]||(e[13]=s("option",{disabled:"",value:""},"Select a status",-1)),(n(),d(D,null,M(A,t=>s("option",{key:t.value,value:t.value},o(t.title),9,Oe)),64))],512),[[re,x(u).status]])]),s("div",null,[e[15]||(e[15]=s("label",{for:"remarks",class:"block text-sm font-medium text-gray-700"},"Remarks",-1)),U(s("textarea",{id:"remarks",rows:"3","onUpdate:modelValue":e[5]||(e[5]=t=>x(u).remarks=t),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Add any remarks about the status update..."},null,512),[[le,x(u).remarks]])])]),s("div",We,[g($,{onClick:V},{default:l(()=>e[16]||(e[16]=[b(" Cancel ")])),_:1}),g(T,{onClick:Q,disabled:x(u).processing},{default:l(()=>[x(u).processing?(n(),d("span",qe,"Updating...")):(n(),d("span",He,"Update Status"))]),_:1},8,["disabled"])])])]),_:1},8,["show"])]),_:1}))}},ot=ce(Je,[["__scopeId","data-v-2ee48c4f"]]);export{ot as default};
