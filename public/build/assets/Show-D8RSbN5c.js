import{c as r,o as u,b as e,t as n,g as b,i as U,d as Q,w as v,a as s,e as g,n as j,f as p,v as X,x as Y,W as w}from"./app-AKIpI5kC.js";import{E as ee}from"./EmployeeLayout-BOs8DfTq.js";import{_ as H}from"./PrimaryButton-C4c8jBYk.js";import{_ as N}from"./SecondaryButton-piyuntTR.js";import{D as I}from"./DangerButton-ttTomH3t.js";import{_ as te}from"./InputLabel-C8m8AA1I.js";import{M as T}from"./Modal-BjHu2a2U.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-BIDGqMa0.js";const le={props:{label:String,value:[String,Number],currentValue:[String,Number],hasChange:Boolean}},se={class:"flex justify-between items-start py-2"},ae={class:"flex-1"},oe={class:"text-sm font-medium text-gray-700"},ne={key:0,class:"mt-1"},ue={class:"text-sm text-gray-500 line-through"},re={class:"text-sm text-green-600 font-medium"},ie={key:1,class:"text-sm text-gray-900 mt-1"};function de(i,C,d,_,x,m){return u(),r("div",se,[e("div",ae,[e("span",oe,n(d.label)+":",1),d.hasChange?(u(),r("div",ne,[e("p",ue,n(d.currentValue||"Not set"),1),e("p",re,n(d.value||"Not set"),1)])):(u(),r("p",ie,n(d.value||"Not set"),1))])])}const o=O(le,[["render",de]]),ce={class:"flex justify-between items-center w-full px-6 md:px-8"},ve={class:"text-xl font-semibold leading-tight text-gray-800"},me={class:"flex gap-2"},ge={class:"zoom-content"},pe={class:"px-6 py-4"},xe={key:0,class:"mb-4"},be={key:0,class:"p-3 bg-blue-100 text-blue-800 rounded text-sm"},fe={key:1,class:"p-3 bg-green-100 text-green-800 rounded text-sm"},_e={key:2,class:"p-3 bg-red-100 text-red-800 rounded text-sm"},he={class:"mb-4 bg-white p-3 rounded-lg shadow-sm border"},ye={class:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs"},ke={class:"mt-0.5 text-gray-900 capitalize"},we={class:"grid grid-cols-1 xl:grid-cols-2 gap-4"},je={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg h-full"},Ce={class:"px-4 py-3 border-b border-gray-200 bg-gray-50"},Re={class:"text-xs text-gray-600 mt-0.5"},Ne={class:"p-4 space-y-3"},qe={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Se={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg h-full"},Be={class:"border-b border-gray-200"},$e={class:"px-4 py-3 bg-gray-50"},Me={class:"text-xs text-gray-600 mt-0.5"},Ae={class:"p-4"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ze={class:"border-b border-gray-200"},De={class:"p-4"},Ee={class:"bg-gray-50 p-3 rounded text-sm"},Ve={class:"text-gray-700"},Le={key:0,class:"border-b border-gray-200"},Fe={class:"p-4"},Ue={class:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm"},He={class:"mt-0.5 text-gray-900"},Ie={class:"mt-0.5 text-gray-900"},Te={key:0,class:"md:col-span-2"},Oe={class:"mt-0.5 text-red-600 bg-red-50 p-2 rounded text-sm"},We={key:1,class:"px-4 py-3 bg-gray-50"},Ze={class:"flex justify-end space-x-3"},Ge={class:"p-6"},Je={class:"mt-4 text-center"},Ke={class:"mt-2 text-sm text-gray-600"},Qe={key:0,class:"mt-3 p-2 bg-blue-50 rounded text-xs"},Xe={class:"font-medium text-blue-800"},Ye={class:"mt-6 flex justify-end space-x-3"},et={key:0},tt={key:1},lt={class:"p-6"},st={class:"mt-4 text-center"},at={class:"mt-2 text-sm text-gray-600"},ot={class:"mt-4"},nt={key:0,class:"mt-1 text-sm text-red-600"},ut={class:"mt-6 flex justify-end space-x-3"},rt={key:0},it={key:1},dt={__name:"Show",props:{request:Object,customer:Object,status:String,success:String,error:String},setup(i){const C=i,d=b(!1),_=b(!1),x=b(""),m=b(""),h=b(!1),y=b(!1),l=b(C.request),a=b(C.customer),W=U(()=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"})[l.value.status]||"bg-gray-100 text-gray-800"),R=U(()=>["first_name","middle_name","last_name","email","mobile","phone","building_number","street","barangay","city","province","zip_code"].filter(t=>l.value[t]!==null).length),Z=c=>({pending:"Pending",approved:"Approved",rejected:"Rejected"})[c]||c,q=c=>c?new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",G=()=>{w.visit(route("admin.customer-update-requests.index"))},J=()=>{y.value=!0,w.post(route("admin.customer-update-requests.approve",l.value.id),{},{preserveScroll:!0,onSuccess:()=>{d.value=!1,y.value=!1,w.reload({only:["request","customer"]})},onError:()=>{y.value=!1}})},K=()=>{if(!x.value.trim()){m.value="Please provide a rejection reason";return}if(x.value.trim().length<10){m.value="Rejection reason must be at least 10 characters long";return}h.value=!0,m.value="",w.post(route("admin.customer-update-requests.reject",l.value.id),{rejection_reason:x.value},{preserveScroll:!0,onSuccess:()=>{_.value=!1,x.value="",h.value=!1,w.reload({only:["request","customer"]})},onError:c=>{c.rejection_reason?m.value=c.rejection_reason:m.value="An error occurred while rejecting the request",h.value=!1}})};return(c,t)=>(u(),Q(ee,null,{header:v(()=>{var k;return[e("div",ce,[e("div",null,[e("h2",ve," Update Request: "+n(((k=l.value.customer)==null?void 0:k.name)||"N/A"),1),t[7]||(t[7]=e("p",{class:"mt-1 text-sm text-gray-500"}," Review and process profile update request ",-1))]),e("div",me,[s(N,{onClick:G},{default:v(()=>t[8]||(t[8]=[p("Back to Requests")])),_:1})])])]}),default:v(()=>{var k,S,B,$,M,A,P,z,D,E,V,L,F;return[e("div",ge,[e("div",pe,[i.status||i.success||i.error?(u(),r("div",xe,[i.status?(u(),r("div",be,n(i.status),1)):g("",!0),i.success?(u(),r("div",fe,n(i.success),1)):g("",!0),i.error?(u(),r("div",_e,n(i.error),1)):g("",!0)])):g("",!0),e("div",he,[e("div",ye,[e("div",null,[t[9]||(t[9]=e("label",{class:"block font-medium text-gray-700"},"Customer Type",-1)),e("p",ke,n(a.value.customer_category),1)]),e("div",null,[t[10]||(t[10]=e("label",{class:"block font-medium text-gray-700"},"Field Locking",-1)),e("p",{class:j(["mt-0.5",a.value.critical_fields_locked?"text-amber-600":"text-green-600"])},n(a.value.critical_fields_locked?"Locked":"Editable"),3)]),e("div",null,[t[11]||(t[11]=e("label",{class:"block font-medium text-gray-700"},"Delivery History",-1)),e("p",{class:j(["mt-0.5",a.value.has_delivery_history?"text-blue-600":"text-gray-600"])},n(a.value.has_delivery_history?"Has History":"No History"),3)]),e("div",null,[t[12]||(t[12]=e("label",{class:"block font-medium text-gray-700"},"Status",-1)),e("span",{class:j(["px-2 py-0.5 rounded-full text-xs font-medium capitalize mt-0.5 inline-block",W.value])},n(Z(l.value.status)),3)])])]),e("div",we,[e("div",null,[e("div",je,[e("div",Ce,[t[13]||(t[13]=e("h3",{class:"text-sm font-medium text-gray-900"},"Current Profile",-1)),e("p",Re,"Submitted: "+n(q(l.value.created_at)),1)]),e("div",Ne,[e("div",qe,[s(o,{label:"First Name",value:a.value.first_name,compact:""},null,8,["value"]),s(o,{label:"Middle Name",value:a.value.middle_name,compact:""},null,8,["value"]),s(o,{label:"Last Name",value:a.value.last_name,compact:""},null,8,["value"]),s(o,{label:"Email",value:a.value.email,compact:""},null,8,["value"]),s(o,{label:"Mobile",value:a.value.mobile,compact:""},null,8,["value"]),s(o,{label:"Phone",value:a.value.phone,compact:""},null,8,["value"]),s(o,{label:"Building No.",value:a.value.building_number,compact:""},null,8,["value"]),s(o,{label:"Street",value:a.value.street,compact:""},null,8,["value"]),s(o,{label:"Barangay",value:a.value.barangay,compact:""},null,8,["value"]),s(o,{label:"City",value:a.value.city,compact:""},null,8,["value"]),s(o,{label:"Province",value:a.value.province,compact:""},null,8,["value"]),s(o,{label:"ZIP Code",value:a.value.zip_code,compact:""},null,8,["value"])])])])]),e("div",null,[e("div",Se,[e("div",Be,[e("div",$e,[t[14]||(t[14]=e("h3",{class:"text-sm font-medium text-gray-900"},"Requested Changes",-1)),e("p",Me,n(R.value)+" field(s) modified",1)]),e("div",Ae,[e("div",Pe,[s(o,{label:"First Name",value:l.value.first_name,"current-value":(k=a.value)==null?void 0:k.first_name,"has-change":l.value.first_name!==null,compact:""},null,8,["value","current-value","has-change"]),s(o,{label:"Middle Name",value:l.value.middle_name,"current-value":(S=a.value)==null?void 0:S.middle_name,"has-change":l.value.middle_name!==null,compact:""},null,8,["value","current-value","has-change"]),s(o,{label:"Last Name",value:l.value.last_name,"current-value":(B=a.value)==null?void 0:B.last_name,"has-change":l.value.last_name!==null,compact:""},null,8,["value","current-value","has-change"]),s(o,{label:"Email",value:l.value.email,"current-value":($=a.value)==null?void 0:$.email,"has-change":l.value.email!==null,compact:""},null,8,["value","current-value","has-change"]),s(o,{label:"Mobile",value:l.value.mobile,"current-value":(M=a.value)==null?void 0:M.mobile,"has-change":l.value.mobile!==null,compact:""},null,8,["value","current-value","has-change"]),s(o,{label:"Phone",value:l.value.phone,"current-value":(A=a.value)==null?void 0:A.phone,"has-change":l.value.phone!==null,compact:""},null,8,["value","current-value","has-change"]),s(o,{label:"Building No.",value:l.value.building_number,"current-value":(P=a.value)==null?void 0:P.building_number,"has-change":l.value.building_number!==null,compact:""},null,8,["value","current-value","has-change"]),s(o,{label:"Street",value:l.value.street,"current-value":(z=a.value)==null?void 0:z.street,"has-change":l.value.street!==null,compact:""},null,8,["value","current-value","has-change"]),s(o,{label:"Barangay",value:l.value.barangay,"current-value":(D=a.value)==null?void 0:D.barangay,"has-change":l.value.barangay!==null,compact:""},null,8,["value","current-value","has-change"]),s(o,{label:"City",value:l.value.city,"current-value":(E=a.value)==null?void 0:E.city,"has-change":l.value.city!==null,compact:""},null,8,["value","current-value","has-change"]),s(o,{label:"Province",value:l.value.province,"current-value":(V=a.value)==null?void 0:V.province,"has-change":l.value.province!==null,compact:""},null,8,["value","current-value","has-change"]),s(o,{label:"ZIP Code",value:l.value.zip_code,"current-value":(L=a.value)==null?void 0:L.zip_code,"has-change":l.value.zip_code!==null,compact:""},null,8,["value","current-value","has-change"])])])]),e("div",ze,[t[15]||(t[15]=e("div",{class:"px-4 py-3 bg-gray-50"},[e("h3",{class:"text-sm font-medium text-gray-900"},"Reason for Changes")],-1)),e("div",De,[e("div",Ee,[e("p",Ve,n(l.value.reason||"No reason provided"),1)])])]),l.value.reviewed_by?(u(),r("div",Le,[t[19]||(t[19]=e("div",{class:"px-4 py-3 bg-gray-50"},[e("h3",{class:"text-sm font-medium text-gray-900"},"Review Information")],-1)),e("div",Fe,[e("div",Ue,[e("div",null,[t[16]||(t[16]=e("label",{class:"block font-medium text-gray-700 text-xs"},"Reviewed By",-1)),e("p",He,n(((F=l.value.reviewer)==null?void 0:F.name)||"N/A"),1)]),e("div",null,[t[17]||(t[17]=e("label",{class:"block font-medium text-gray-700 text-xs"},"Reviewed At",-1)),e("p",Ie,n(q(l.value.reviewed_at)),1)]),l.value.admin_notes&&l.value.status==="rejected"?(u(),r("div",Te,[t[18]||(t[18]=e("label",{class:"block font-medium text-gray-700 text-xs"},"Rejection Reason",-1)),e("p",Oe,n(l.value.admin_notes),1)])):g("",!0)])])])):g("",!0),l.value.status==="pending"?(u(),r("div",We,[e("div",Ze,[s(I,{onClick:t[0]||(t[0]=f=>_.value=!0),class:"text-xs py-1.5 px-3"},{default:v(()=>t[20]||(t[20]=[p("Reject")])),_:1}),s(H,{onClick:t[1]||(t[1]=f=>d.value=!0),class:"text-xs py-1.5 px-3"},{default:v(()=>t[21]||(t[21]=[p("Approve")])),_:1})])])):g("",!0)])])])])]),s(T,{show:d.value,onClose:t[3]||(t[3]=f=>d.value=!1),"max-width":"md"},{default:v(()=>[e("div",Ge,[t[26]||(t[26]=e("div",{class:"flex items-center justify-center w-12 h-12 mx-auto bg-green-100 rounded-full"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",Je,[t[24]||(t[24]=e("h2",{class:"text-lg font-medium text-gray-900"},"Approve Update Request?",-1)),e("p",Ke,[t[22]||(t[22]=p(" Approve profile changes for ")),e("strong",null,n(a.value.name),1),t[23]||(t[23]=p("? "))]),R.value>0?(u(),r("div",Qe,[e("p",Xe,n(R.value)+" field(s) will be updated ",1)])):g("",!0)]),e("div",Ye,[s(N,{onClick:t[2]||(t[2]=f=>d.value=!1),class:"text-sm"},{default:v(()=>t[25]||(t[25]=[p("Cancel")])),_:1}),s(H,{onClick:J,disabled:y.value,class:"text-sm"},{default:v(()=>[y.value?(u(),r("span",et,"Processing...")):(u(),r("span",tt,"Confirm Approval"))]),_:1},8,["disabled"])])])]),_:1},8,["show"]),s(T,{show:_.value,onClose:t[6]||(t[6]=f=>_.value=!1),"max-width":"md"},{default:v(()=>[e("div",lt,[t[32]||(t[32]=e("div",{class:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full"},[e("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",st,[t[29]||(t[29]=e("h2",{class:"text-lg font-medium text-gray-900"},"Reject Update Request?",-1)),e("p",at,[t[27]||(t[27]=p(" Reject request from ")),e("strong",null,n(a.value.name),1),t[28]||(t[28]=p("? "))])]),e("div",ot,[s(te,{for:"rejection_reason",value:"Rejection Reason *",class:"text-sm"}),X(e("textarea",{id:"rejection_reason",rows:"3",class:j(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm",{"border-red-300":m.value}]),"onUpdate:modelValue":t[4]||(t[4]=f=>x.value=f),required:"",placeholder:"Reason for rejection (visible to customer)..."},null,2),[[Y,x.value]]),m.value?(u(),r("div",nt,n(m.value),1)):g("",!0),t[30]||(t[30]=e("p",{class:"mt-1 text-xs text-gray-500"}," Minimum 10 characters required ",-1))]),e("div",ut,[s(N,{onClick:t[5]||(t[5]=f=>_.value=!1),class:"text-sm"},{default:v(()=>t[31]||(t[31]=[p("Cancel")])),_:1}),s(I,{onClick:K,disabled:!x.value.trim()||h.value,class:"text-sm"},{default:v(()=>[h.value?(u(),r("span",rt,"Processing...")):(u(),r("span",it,"Confirm Rejection"))]),_:1},8,["disabled"])])])]),_:1},8,["show"])]}),_:1}))}},ht=O(dt,[["__scopeId","data-v-61ac12a7"]]);export{ht as default};
