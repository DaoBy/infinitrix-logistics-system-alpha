import{g as b,p as z,c as o,o as r,a as p,u as H,m as I,w as c,b as e,e as n,t as l,F as y,r as h,f as i,n as D,d as q,J as B,L as W,K as J,W as _}from"./app-DSvpKds8.js";import{E as K}from"./EmployeeLayout-41rkCMFi.js";import{_ as M}from"./PrimaryButton-BaAbC_Sk.js";import{_ as w}from"./SecondaryButton-BMk3kL1H.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-B7vUiQXa.js";import"./DangerButton-Bd5m9G75.js";const O={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2"},Y={class:"py-12"},G={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},Q={key:0,class:"mb-8"},X={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 dark:bg-yellow-900/20 dark:border-yellow-700"},Z={class:"flex items-center justify-between mb-4"},ee={class:"bg-yellow-100 text-yellow-800 text-sm font-medium px-3 py-1 rounded-full dark:bg-yellow-900 dark:text-yellow-200"},te={class:"space-y-4"},se={class:"flex items-center justify-between"},ae={class:"flex-1"},re={class:"flex items-center gap-3 mb-2"},oe={class:"font-medium text-gray-900 dark:text-white"},le={class:"text-sm text-gray-500 dark:text-gray-400"},de={class:"text-sm text-gray-600 dark:text-gray-300"},ne={class:"flex items-center gap-4"},ie={class:"bg-white shadow-sm rounded-xl dark:bg-gray-800 overflow-hidden"},ue={class:"p-6"},ce={key:0,class:"text-center py-12"},ge={key:1,class:"space-y-6"},pe={class:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 mb-4"},me={class:"flex items-center gap-3"},xe={class:"bg-blue-50 dark:bg-blue-900/30 px-3 py-1 rounded-lg"},ke={class:"text-sm font-medium text-blue-800 dark:text-blue-200"},fe={key:0,class:"px-3 py-1 text-sm font-medium rounded-full bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-200 flex items-center gap-1"},be={class:"flex gap-3"},ye={class:"mb-4 p-3 bg-blue-50 rounded-lg dark:bg-blue-900/20"},ve={class:"flex items-center justify-between text-sm"},he={class:"flex items-center"},_e={class:"mx-2 text-blue-600 dark:text-blue-400"},we={class:"text-blue-600 dark:text-blue-400"},Ce={key:0,class:"text-xs text-purple-600 dark:text-purple-400 font-medium"},Se={key:0,class:"mb-4 p-3 bg-purple-50 border border-purple-200 rounded-lg dark:bg-purple-900/20 dark:border-purple-700"},je={class:"text-xs text-purple-700 dark:text-purple-300 list-disc list-inside space-y-1"},De={class:"flex items-center justify-between mb-3"},Me={class:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-1"},Ue={key:0,class:"space-y-2"},Be={class:"flex justify-between items-start"},Pe={class:"font-medium"},Re={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Fe={key:0,class:"text-xs text-red-600 dark:text-red-400 mt-1"},Le={class:"text-xs text-gray-400"},Ae={key:1,class:"mt-3 p-2 bg-gray-100 dark:bg-gray-700 rounded-lg"},$e={class:"flex justify-between text-xs"},Ne={class:"font-medium"},Te={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},Ve={class:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto"},Ee={class:"p-6"},ze={key:0,class:"space-y-4"},He={class:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg"},Ie={class:"font-medium"},qe={class:"text-sm text-gray-600 dark:text-gray-300"},We={class:"text-xs text-gray-500 dark:text-gray-400"},Je={key:0},Ke={class:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center"},Oe={key:0,class:"mt-3"},Ye={class:"text-sm text-gray-600 dark:text-gray-300"},Ge=["onClick"],Qe={class:"flex gap-3 pt-4"},Xe={key:0},Ze={key:1},nt={__name:"AssignedDeliveries",props:{deliveries:{type:Array,default:()=>[]},readyForStatusUpdate:{type:Array,default:()=>[]}},setup(x){const k=b({}),C=b(!1),g=b(null),f=b(!1),m=b([]),u=z({status:"delivered",remarks:"",evidence:[]}),P=a=>{k.value={...k.value,[a]:!k.value[a]}};function U(a){return a?{assigned:"Assigned",dispatched:"Dispatched",in_transit:"In Transit",delivered:"Delivered",completed:"Completed",returned:"Returned",rejected:"Rejected",damaged_in_transit:"Damaged",lost_in_transit:"Lost"}[a]||(typeof a=="string"?a.charAt(0).toUpperCase()+a.slice(1):a):"N/A"}function R(a){return{delivered:"text-green-600 dark:text-green-400",completed:"text-green-600 dark:text-green-400",damaged_in_transit:"text-yellow-600 dark:text-yellow-400",lost_in_transit:"text-red-600 dark:text-red-400",in_transit:"text-blue-600 dark:text-blue-400",assigned:"text-gray-600 dark:text-gray-400"}[a]||"text-gray-600 dark:text-gray-400"}function F(a){return new Date(a).toLocaleDateString()}function L(a){g.value=a,C.value=!0,u.status="delivered",u.remarks="",u.evidence=[],m.value=[]}function S(){C.value=!1,g.value=null}function A(a){const t=Array.from(a.target.files);m.value=[...m.value,...t]}function $(a){m.value.splice(a,1)}async function N(){if(g.value){f.value=!0;try{const a=new FormData;a.append("package_updates[0][package_id]",g.value.id),a.append("package_updates[0][status]",u.status),a.append("package_updates[0][remarks]",u.remarks),m.value.forEach((t,v)=>{a.append(`package_updates[0][evidence][${v}]`,t)}),_.post(route("driver.packages.update-destination-status"),a,{onFinish:()=>{f.value=!1,S()},onError:t=>{console.error("Status update errors:",t),alert("Failed to update status. Please check your inputs.")}})}catch(a){console.error("Error updating status:",a),f.value=!1,alert("Failed to update status. Please try again.")}}}function T(){_.visit(route("driver.status-update"))}function V(a){_.visit(route("driver.track-package",{package:a}))}function E(){_.visit(route("driver.dashboard"))}return(a,t)=>(r(),o(y,null,[p(H(I),{title:"Assigned Deliveries"}),p(K,null,{header:c(()=>[e("div",O,[t[4]||(t[4]=e("div",null,[e("h2",{class:"text-2xl font-bold leading-tight text-gray-900 dark:text-gray-100"}," Assigned Deliveries "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"}," Manage your deliveries and report package status at destination ")],-1)),p(w,{onClick:E,class:"ml-0 sm:ml-4 mt-3 sm:mt-0"},{default:c(()=>t[3]||(t[3]=[e("svg",{class:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 10h2l.4 2M7 13h10l4-8H5.4"})],-1),i(" Dashboard ")])),_:1})])]),default:c(()=>{var v;return[e("div",Y,[e("div",G,[x.readyForStatusUpdate.length>0?(r(),o("div",Q,[e("div",X,[e("div",Z,[t[5]||(t[5]=e("div",{class:"flex items-center"},[e("svg",{class:"h-6 w-6 text-yellow-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 15.5c-.77.833.192 2.5 1.732 2.5z"})]),e("h3",{class:"text-lg font-semibold text-yellow-800 dark:text-yellow-200"}," Packages Ready for Status Update ")],-1)),e("span",ee,l(x.readyForStatusUpdate.length)+" package(s) ",1)]),t[7]||(t[7]=e("p",{class:"text-yellow-700 dark:text-yellow-300 mb-4"}," You've arrived at destination regions. Please update the status of these packages. ",-1)),e("div",te,[(r(!0),o(y,null,h(x.readyForStatusUpdate,s=>{var d,j;return r(),o("div",{key:s.id,class:"bg-white border border-yellow-200 rounded-lg p-4 dark:bg-gray-800 dark:border-yellow-600"},[e("div",se,[e("div",ae,[e("div",re,[e("span",oe,l(s.item_code),1),e("span",le,l(s.item_name),1)]),e("div",de,[e("div",ne,[e("span",null,"Reference: "+l((d=s.deliveryRequest)==null?void 0:d.reference_number),1),e("span",null,"Destination: "+l((j=s.deliveryRequest)==null?void 0:j.dropOffRegion),1)])])]),p(M,{onClick:et=>L(s),class:"ml-4"},{default:c(()=>t[6]||(t[6]=[i(" Update Status ")])),_:2},1032,["onClick"])])])}),128))])])])):n("",!0),e("div",ie,[e("div",ue,[x.deliveries.length===0?(r(),o("div",ce,t[8]||(t[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-10 w-10 mx-auto text-gray-300 dark:text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 17v-2a4 4 0 018 0v2M12 7a4 4 0 100 8 4 4 0 000-8z"})],-1),e("p",{class:"mt-4 text-gray-500 dark:text-gray-400"},"No assigned deliveries found",-1)]))):(r(),o("div",ge,[(r(!0),o(y,null,h(x.deliveries,s=>(r(),o("div",{key:s.id,class:D(["bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg p-6 shadow-sm",{"border-purple-300 dark:border-purple-700":s.is_backhaul}])},[e("div",pe,[e("div",me,[e("div",xe,[e("span",ke,l(s.reference_number),1)]),s.is_backhaul?(r(),o("span",fe,t[9]||(t[9]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1),i(" Backhaul Assignment ")]))):n("",!0),e("span",{class:D(["px-3 py-1 text-sm font-medium rounded-full",{"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200":s.status==="assigned","bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200":s.status==="dispatched","bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":s.status==="in_transit"}])},l(U(s.status)),3)]),e("div",be,[p(M,{type:"button",class:"flex items-center",onClick:T},{default:c(()=>t[10]||(t[10]=[i(" Update Location ")])),_:1}),s.packages&&s.packages.length>0?(r(),q(w,{key:0,type:"button",class:"flex items-center",onClick:d=>V(s.packages[0].id)},{default:c(()=>t[11]||(t[11]=[i(" Track ")])),_:2},1032,["onClick"])):n("",!0)])]),e("div",ye,[e("div",ve,[e("div",he,[t[12]||(t[12]=e("span",{class:"font-medium text-blue-700 dark:text-blue-300"},"Route:",-1)),e("span",_e,l(s.current_region),1),t[13]||(t[13]=e("svg",{class:"w-4 h-4 text-blue-500 mx-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 8l4 4m0 0l-4 4m4-4H3"})],-1)),e("span",we,l(s.destination),1)]),s.is_backhaul?(r(),o("span",Ce," Return to "+l(s.home_region),1)):n("",!0)])]),s.is_backhaul?(r(),o("div",Se,[t[17]||(t[17]=e("h4",{class:"text-sm font-medium text-purple-800 dark:text-purple-200 mb-2 flex items-center"},[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),i(" Backhaul Instructions ")],-1)),e("ul",je,[e("li",null,"Return trip to home region: "+l(s.home_region),1),t[14]||(t[14]=e("li",null,"Priority: Standard Backhaul",-1)),t[15]||(t[15]=e("li",null,"No additional pickups allowed",-1)),t[16]||(t[16]=e("li",null,"Direct route to home region",-1))])])):n("",!0),e("div",null,[e("div",De,[e("h3",Me,[t[18]||(t[18]=e("svg",{class:"h-4 w-4 text-blue-400",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[e("rect",{width:"20",height:"12",x:"2",y:"6",rx:"2"})],-1)),i(" Packages ("+l(s.package_count||0)+") ",1)]),p(w,{type:"button",onClick:d=>P(s.id),class:"text-xs px-2 py-1"},{default:c(()=>[i(l(k.value[s.id]?"Hide":"Show"),1)]),_:2},1032,["onClick"])]),k.value[s.id]&&s.packages?(r(),o("div",Ue,[(r(!0),o(y,null,h(s.packages,d=>(r(),o("div",{key:d.id,class:"text-sm text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 border"},[e("div",Be,[e("div",null,[e("p",Pe,l(d.item_code||"N/A"),1),e("p",Re,[t[19]||(t[19]=i(" Status: ")),e("span",{class:D(R(d.status))},l(U(d.status)),3)]),d.incident_reported_at?(r(),o("p",Fe," Incident Reported: "+l(F(d.incident_reported_at)),1)):n("",!0)]),e("span",Le," #"+l(d.id),1)])]))),128))])):n("",!0),s.packages?(r(),o("div",Ae,[e("div",$e,[t[20]||(t[20]=e("span",{class:"text-gray-600 dark:text-gray-300"},"Verified Packages:",-1)),e("span",Ne,l(s.packages.filter(d=>d.verified_at).length)+" / "+l(s.packages.length),1)])])):n("",!0)])],2))),128))]))])])])]),C.value?(r(),o("div",Te,[e("div",Ve,[e("div",Ee,[e("div",{class:"flex items-center justify-between mb-4"},[t[22]||(t[22]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Update Package Status ",-1)),e("button",{onClick:S,class:"text-gray-400 hover:text-gray-600"},t[21]||(t[21]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),g.value?(r(),o("div",ze,[e("div",He,[e("p",Ie,l(g.value.item_code),1),e("p",qe,l(g.value.item_name),1),e("p",We," Reference: "+l((v=g.value.deliveryRequest)==null?void 0:v.reference_number),1)]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Package Status * ",-1)),B(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>u.status=s),class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},t[23]||(t[23]=[e("option",{value:"delivered"},"✅ Delivered - Package successfully delivered",-1),e("option",{value:"damaged_in_transit"},"⚠️ Damaged - Package arrived but damaged",-1),e("option",{value:"lost_in_transit"},"❌ Lost - Package missing/lost in transit",-1)]),512),[[W,u.status]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Remarks ",-1)),B(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=s=>u.remarks=s),placeholder:"Add any notes about the package condition...",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white",rows:"3"},null,512),[[J,u.remarks]])]),u.status!=="delivered"?(r(),o("div",Je,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Evidence Photos ",-1)),e("div",Ke,[e("input",{type:"file",ref:"fileInput",multiple:"",accept:"image/*",onChange:A,class:"hidden"},null,544),e("button",{onClick:t[2]||(t[2]=s=>a.$refs.fileInput.click()),class:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300"},t[26]||(t[26]=[e("svg",{class:"w-8 h-8 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),i(" Upload Photos ")])),t[27]||(t[27]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," Upload photos as evidence for damaged or lost packages ",-1))]),m.value.length>0?(r(),o("div",Oe,[(r(!0),o(y,null,h(m.value,(s,d)=>(r(),o("div",{key:d,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 rounded mb-2"},[e("span",Ye,l(s.name),1),e("button",{onClick:j=>$(d),class:"text-red-500 hover:text-red-700"},t[28]||(t[28]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ge)]))),128))])):n("",!0)])):n("",!0),e("div",Qe,[p(w,{onClick:S,class:"flex-1"},{default:c(()=>t[30]||(t[30]=[i(" Cancel ")])),_:1}),p(M,{onClick:N,disabled:f.value,class:"flex-1"},{default:c(()=>[f.value?(r(),o("span",Xe,"Updating...")):(r(),o("span",Ze,"Update Status"))]),_:1},8,["disabled"])])])):n("",!0)])])])):n("",!0)]}),_:1})],64))}};export{nt as default};
