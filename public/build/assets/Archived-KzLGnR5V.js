import{g as m,h as q,W as v,L as G,d as T,o as r,w as o,b as s,a as n,c as i,e as b,t as d,f as u,F as j,r as J,u as K,P as Q,n as X,j as Y}from"./app-B0R_bMJi.js";import{E as Z}from"./EmployeeLayout-BQLa5PLV.js";import{_ as S}from"./SecondaryButton-BDpVYXxA.js";import{D as F}from"./DangerButton-DlTel5kP.js";import{_ as ee}from"./SearchInput-BHbkz-wy.js";import{S as P}from"./SelectInput-f4kpY-DU.js";import{_ as te}from"./DataTable-C_2NMP2T.js";import{M as le}from"./Modal-Oa0ozw3w.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-BchASNUp.js";/* empty css                                                                    */const oe={class:"flex justify-between items-center px-6"},ae={class:"px-6 sm:px-8"},re={key:0,class:"mb-6"},ne={key:0,class:"p-4 bg-blue-100 text-blue-800 rounded"},ie={key:1,class:"p-4 bg-green-100 text-green-800 rounded"},de={key:2,class:"p-4 bg-red-100 text-red-800 rounded"},ue={class:"mb-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 w-full mx-auto"},ce={class:"flex flex-wrap gap-2 w-full md:w-auto"},me={class:"justify-center flex items-center"},fe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-center"},ve={class:"p-5 bg-white border-b border-gray-200"},pe={class:"truncate block"},ye={class:"truncate block"},ge={class:"flex space-x-2"},xe={key:0,class:"mt-4 flex justify-center"},he={class:"flex flex-wrap -mb-1"},be=["innerHTML"],_e={class:"p-6"},we={class:"mt-1 text-sm text-gray-600"},Ae={class:"mt-6 flex justify-end space-x-4"},De={key:0},ke={key:1},Se={__name:"Archived",props:{employees:Object,status:String,success:String,error:String},setup(a){var N,V,L,M,R;const p=a,k=m(!1),y=m(null),g=m(!1),_=m(((N=p.employees.filters)==null?void 0:N.search)||""),w=m(((V=p.employees.filters)==null?void 0:V.role)||""),A=m(((L=p.employees.filters)==null?void 0:L.region)||""),x=m(((M=p.employees.filters)==null?void 0:M.sort_field)||"archived_at"),f=m(((R=p.employees.filters)==null?void 0:R.sort_direction)||"desc"),C=m([{value:"",text:"All Regions"}]),B=[{value:"",text:"All Roles"},{value:"admin",text:"Admin"},{value:"staff",text:"Staff"},{value:"driver",text:"Driver"},{value:"collector",text:"Collector"}],U=[{field:"name",header:"Name",sortable:!0},{field:"email",header:"Email",sortable:!0},{field:"role",header:"Role",sortable:!0,formatter:t=>t?t.charAt(0).toUpperCase()+t.slice(1):"N/A"},{field:"employee_profile",header:"Employee ID",sortable:!0,formatter:t=>(t==null?void 0:t.employee_id)||"N/A"},{field:"employee_profile",header:"Region",sortable:!0,formatter:t=>{var l;return((l=t==null?void 0:t.region)==null?void 0:l.name)||"Not assigned"}},{field:"employee_profile",header:"Disabled On",sortable:!0,formatter:t=>t!=null&&t.archived_at?new Date(t.archived_at).toLocaleDateString():"N/A"},{field:"actions",header:"Actions",sortable:!1}],$=async()=>{try{const{data:t}=await Y.get("/api/delivery/regions"),l=Array.isArray(t)?t:t.data||t.regions||[];C.value=[{value:"",text:"All Regions"},...l.map(h=>({value:String(h.id),text:h.name}))]}catch(t){console.error("Failed to fetch regions:",t)}},H=t=>{x.value===t?f.value=f.value==="asc"?"desc":"asc":(x.value=t,f.value="asc")},O=t=>{y.value=t,k.value=!0},D=()=>{k.value=!1,setTimeout(()=>{y.value=null,g.value=!1},300)},I=async()=>{if(y.value){g.value=!0;try{await v.delete(route("admin.employees.destroy",y.value.id),{preserveScroll:!0}),D(),v.reload({only:["employees"]})}catch{D(),alert("Failed to delete employee. Please try again.")}finally{g.value=!1}}},W=t=>{v.put(route("admin.employees.restore",t.id),{},{preserveScroll:!0,onSuccess:()=>{v.reload()}})},z=()=>v.get(route("admin.employees.index"));return q([_,w,A,x,f],()=>{v.get(route("admin.employees.archived"),{search:_.value,role:w.value,region:A.value,sort_field:x.value,sort_direction:f.value,page:1},{preserveState:!0,replace:!0})},{deep:!0}),G($),(t,l)=>(r(),T(Z,null,{header:o(()=>[s("div",oe,[l[4]||(l[4]=s("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Disabled Accounts",-1)),n(S,{onClick:z},{default:o(()=>l[3]||(l[3]=[u("View Active Accounts")])),_:1})])]),default:o(()=>{var h;return[s("div",ae,[a.status||a.success||a.error?(r(),i("div",re,[a.status?(r(),i("div",ne,d(a.status),1)):b("",!0),a.success?(r(),i("div",ie,d(a.success),1)):b("",!0),a.error?(r(),i("div",de,d(a.error),1)):b("",!0)])):b("",!0),s("div",ue,[n(ee,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=e=>_.value=e),placeholder:"Search disabled accounts...",class:"w-full md:w-72"},null,8,["modelValue"]),s("div",ce,[n(P,{modelValue:w.value,"onUpdate:modelValue":l[1]||(l[1]=e=>w.value=e),options:B,"option-value":"value","option-label":"text",placeholder:"All Roles",class:"w-full md:w-48"},null,8,["modelValue"]),n(P,{modelValue:A.value,"onUpdate:modelValue":l[2]||(l[2]=e=>A.value=e),options:C.value,"option-value":"value","option-label":"text",placeholder:"All Regions",class:"w-full md:w-48"},null,8,["modelValue","options"])])]),s("div",me,[s("div",fe,[s("div",ve,[n(te,{columns:U,data:a.employees.data,"sort-field":x.value,"sort-direction":f.value,onSort:H,class:"w-full"},{name:o(({row:e})=>[s("span",pe,d(e.name||"N/A"),1)]),email:o(({row:e})=>[s("span",ye,d(e.email||"N/A"),1)]),role:o(({row:e})=>[u(d(e.role?e.role.charAt(0).toUpperCase()+e.role.slice(1):"N/A"),1)]),employee_id:o(({row:e})=>{var c;return[u(d(((c=e.employee_profile)==null?void 0:c.employee_id)||"N/A"),1)]}),region:o(({row:e})=>{var c,E;return[u(d(((E=(c=e.employee_profile)==null?void 0:c.region)==null?void 0:E.name)||"Not assigned"),1)]}),archived_at:o(({row:e})=>[u(d(e.archived_at?new Date(e.archived_at).toLocaleDateString():"N/A"),1)]),status:o(({row:e})=>l[5]||(l[5]=[s("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"}," Disabled ",-1)])),actions:o(({row:e})=>[s("div",ge,[n(S,{onClick:c=>W(e)},{default:o(()=>l[6]||(l[6]=[u("Restore")])),_:2},1032,["onClick"]),n(F,{onClick:c=>O(e)},{default:o(()=>l[7]||(l[7]=[u("Delete Permanently")])),_:2},1032,["onClick"])])]),_:1},8,["data","sort-field","sort-direction"]),((h=a.employees.links)==null?void 0:h.length)>3?(r(),i("div",xe,[s("div",he,[(r(!0),i(j,null,J(a.employees.links,(e,c)=>(r(),i(j,{key:c},[e.url?(r(),T(K(Q),{key:1,class:X(["mr-1 mb-1 px-4 py-3 text-sm leading-4 border rounded hover:bg-white focus:border-indigo-500 focus:text-indigo-500",{"bg-blue-700 text-white":e.active}]),href:e.url,innerHTML:e.label},null,8,["class","href","innerHTML"])):(r(),i("div",{key:0,class:"mr-1 mb-1 px-4 py-3 text-sm leading-4 text-gray-400 border rounded",innerHTML:e.label},null,8,be))],64))),128))])])):b("",!0)])])])]),n(le,{show:k.value,onClose:D},{default:o(()=>{var e;return[s("div",_e,[l[11]||(l[11]=s("h2",{class:"text-lg font-medium text-gray-900"},"Delete Employee Permanently?",-1)),s("p",we,[l[8]||(l[8]=u(" Are you sure you want to permanently delete ")),s("strong",null,d((e=y.value)==null?void 0:e.name),1),l[9]||(l[9]=u("? This action cannot be undone. "))]),s("div",Ae,[n(S,{onClick:D},{default:o(()=>l[10]||(l[10]=[u("Cancel")])),_:1}),n(F,{onClick:I,disabled:g.value},{default:o(()=>[g.value?(r(),i("span",De,"Deleting...")):(r(),i("span",ke,"Delete Permanently"))]),_:1},8,["disabled"])])])]}),_:1},8,["show"])]}),_:1}))}},Be=se(Se,[["__scopeId","data-v-cc96c89b"]]);export{Be as default};
