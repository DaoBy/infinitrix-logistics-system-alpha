import{c as x,o as u,b as e,g as h,i as E,C as H,h as J,W as g,d as F,w as m,a as r,u as i,t as o,e as y,F as K,r as Q,f as v,n as X,P as Y,p as ee}from"./app-BllHWhcy.js";import{E as te}from"./EmployeeLayout-CgMY_n5V.js";import{_ as se}from"./SearchInput-BSEud9IK.js";import{S as q}from"./SelectInput-BACJkmZB.js";import{P as oe}from"./Pagination-clkSGD3h.js";import{M as ae}from"./Modal-DAAK_Wm5.js";import{_ as re}from"./TextArea-aLSmk0zP.js";import{_ as le}from"./InputError-B4ahD7h-.js";import{_ as ie}from"./SecondaryButton-f4DzqSLc.js";import{D as de}from"./DangerButton-B7_oj2jq.js";import{r as ne}from"./ClockIcon-C39h7Imj.js";import{r as ce}from"./CheckCircleIcon-C_IoucZf.js";import{r as ue}from"./TruckIcon-CrR13VJY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-BG8uMyS8.js";/* empty css                                                                    */function me(l,p){return u(),x("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"})])}const fe={class:"flex justify-between items-center"},xe={class:"flex space-x-4"},pe={class:"py-6"},_e={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ve={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},he={class:"bg-white overflow-hidden shadow rounded-lg"},ge={class:"px-4 py-5 sm:p-6"},ye={class:"flex items-center"},we={class:"flex-shrink-0 bg-gray-100 rounded-md p-3"},be={class:"ml-5 w-0 flex-1"},je={class:"flex items-baseline"},ke={class:"text-2xl font-semibold text-gray-900"},Ve={class:"bg-white overflow-hidden shadow rounded-lg"},Ce={class:"px-4 py-5 sm:p-6"},Se={class:"flex items-center"},Pe={class:"flex-shrink-0 bg-green-100 rounded-md p-3"},Ae={class:"ml-5 w-0 flex-1"},Ne={class:"flex items-baseline"},Re={class:"text-2xl font-semibold text-gray-900"},Me={class:"bg-white overflow-hidden shadow rounded-lg"},$e={class:"px-4 py-5 sm:p-6"},Be={class:"flex items-center"},De={class:"flex-shrink-0 bg-blue-100 rounded-md p-3"},Oe={class:"ml-5 w-0 flex-1"},Ue={class:"flex items-baseline"},Ee={class:"text-2xl font-semibold text-gray-900"},Fe={class:"bg-white overflow-hidden shadow rounded-lg"},qe={class:"px-4 py-5 sm:p-6"},ze={class:"flex items-center"},Le={class:"flex-shrink-0 bg-purple-100 rounded-md p-3"},Te={class:"ml-5 w-0 flex-1"},Ie={class:"flex items-baseline"},We={class:"text-2xl font-semibold text-gray-900"},Ze={class:"bg-white overflow-hidden shadow rounded-lg"},Ge={class:"px-4 py-5 sm:p-6"},He={class:"overflow-x-auto"},Je={class:"min-w-full divide-y divide-gray-200"},Ke={class:"bg-white divide-y divide-gray-200"},Qe={class:"px-6 py-4 whitespace-nowrap"},Xe={class:"text-sm font-medium text-gray-900"},Ye={class:"text-sm text-gray-500"},et={key:0},tt={class:"px-6 py-4 whitespace-nowrap"},st={class:"text-sm font-medium text-gray-900"},ot={class:"text-sm text-gray-500"},at={class:"px-6 py-4 whitespace-nowrap"},rt={class:"text-sm text-gray-900 capitalize"},lt={class:"text-sm text-gray-500 capitalize"},it={class:"px-6 py-4 whitespace-nowrap"},dt={class:"text-sm font-medium text-gray-900"},nt={class:"text-sm text-gray-500"},ct={class:"px-6 py-4 whitespace-nowrap"},ut={class:"px-6 py-4 whitespace-nowrap"},mt={class:"text-sm text-gray-900"},ft={class:"text-sm text-gray-500"},xt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},pt={class:"flex justify-end space-x-2"},_t=["onClick"],vt={class:"p-6"},ht={class:"mt-6 flex justify-end space-x-3"},Ot={__name:"VerificationIndex",props:{payments:{type:Object,default:()=>({data:[],meta:{}})},filters:{type:Object,default:()=>({})},stats:{type:Object,default:()=>({})}},setup(l){var w,b,j;const p=l,d=h({status:((w=p.filters)==null?void 0:w.status)||"pending",search:((b=p.filters)==null?void 0:b.search)||"",source:((j=p.filters)==null?void 0:j.source)||""}),f=h(!1),_=h(null),z=E(()=>[{value:"pending",label:"Pending"},{value:"verified",label:"Verified"},{value:"rejected",label:"Rejected"}]),L=E(()=>[{value:"",label:"All Sources"},{value:"branch_staff",label:"Branch Staff"},{value:"collector",label:"Collector"},{value:"customer_online",label:"Customer Online"}]),c=H({rejection_reason:""});J(d.value,a=>{let t={...a};t.status==="pending"&&(t.pending=!0),g.get(route("staff.payments.verification.index"),t,{preserveState:!0,replace:!0})});const T=a=>{_.value=a,f.value=!0},I=()=>{_.value&&c.post(route("staff.payments.reject",_.value.id),{preserveScroll:!0,onSuccess:()=>{f.value=!1,c.reset(),_.value=null,g.reload({only:["payments"]})},onError:a=>{console.error("Rejection failed:",a)}})},W=a=>{g.get(route("staff.payments.verification.index"),{...d.value,page:a},{preserveState:!0})},Z=a=>a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",G=a=>{switch(a){case"pending":return"Pending Verification";case"verified":return"Verified";case"rejected":return"Rejected";default:return a}};return(a,t)=>(u(),F(te,null,{header:m(()=>[e("div",fe,[t[6]||(t[6]=e("div",null,[e("h2",{class:"text-xl font-semibold text-gray-800"}," Payment Verification "),e("p",{class:"text-sm text-gray-600 mt-1"}," Review and verify customer and collector payments ")],-1)),e("div",xe,[r(se,{modelValue:d.value.search,"onUpdate:modelValue":t[0]||(t[0]=n=>d.value.search=n),placeholder:"Search references, names...",class:"w-64"},null,8,["modelValue"]),r(q,{modelValue:d.value.status,"onUpdate:modelValue":t[1]||(t[1]=n=>d.value.status=n),options:z.value,class:"w-40"},null,8,["modelValue","options"]),r(q,{modelValue:d.value.source,"onUpdate:modelValue":t[2]||(t[2]=n=>d.value.source=n),options:L.value,class:"w-48"},null,8,["modelValue","options"])])])]),default:m(()=>{var n,k,V,C,S,P;return[e("div",pe,[e("div",_e,[e("div",ve,[e("div",he,[e("div",ge,[e("div",ye,[e("div",we,[r(i(ne),{class:"h-6 w-6 text-gray-600"})]),e("div",be,[e("dl",null,[t[7]||(t[7]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Pending Verification ",-1)),e("dd",je,[e("div",ke,o(((n=l.stats)==null?void 0:n.pending)||0),1)])])])])])]),e("div",Ve,[e("div",Ce,[e("div",Se,[e("div",Pe,[r(i(ce),{class:"h-6 w-6 text-green-600"})]),e("div",Ae,[e("dl",null,[t[8]||(t[8]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Verified Today ",-1)),e("dd",Ne,[e("div",Re,o(((k=l.stats)==null?void 0:k.verified_today)||0),1)])])])])])]),e("div",Me,[e("div",$e,[e("div",Be,[e("div",De,[r(i(me),{class:"h-6 w-6 text-blue-600"})]),e("div",Oe,[e("dl",null,[t[9]||(t[9]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Customer Online ",-1)),e("dd",Ue,[e("div",Ee,o(((V=l.stats)==null?void 0:V.customer_online)||0),1)])])])])])]),e("div",Fe,[e("div",qe,[e("div",ze,[e("div",Le,[r(i(ue),{class:"h-6 w-6 text-purple-600"})]),e("div",Te,[e("dl",null,[t[10]||(t[10]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"}," Collector ",-1)),e("dd",Ie,[e("div",We,o(((C=l.stats)==null?void 0:C.collector)||0),1)])])])])])])]),e("div",Ze,[e("div",Ge,[e("div",He,[e("table",Je,[t[12]||(t[12]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reference "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Customer "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Method & Source "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Amount "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Submitted "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",Ke,[(u(!0),x(K,null,Q(((S=l.payments)==null?void 0:S.data)||[],s=>{var A,N,R,M,$,B,D,O,U;return u(),x("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Qe,[e("div",Xe,o(((A=s.delivery_request)==null?void 0:A.reference_number)||"N/A"),1),e("div",Ye,[v(o(((N=s.method)==null?void 0:N.toUpperCase())||"N/A")+" ",1),s.reference_number?(u(),x("span",et," #"+o(s.reference_number),1)):y("",!0)])]),e("td",tt,[e("div",st,o(((M=(R=s.delivery_request)==null?void 0:R.sender)==null?void 0:M.name)||"N/A"),1),e("div",ot,o(((B=($=s.delivery_request)==null?void 0:$.sender)==null?void 0:B.mobile)||"N/A"),1)]),e("td",at,[e("div",rt,o(s.method||"N/A"),1),e("div",lt,o(((D=s.source)==null?void 0:D.replace("_"," "))||"N/A"),1)]),e("td",it,[e("div",dt," ₱"+o(parseFloat(s.amount||0).toFixed(2)),1),e("div",nt," Due: ₱"+o(((O=s.delivery_request)==null?void 0:O.total_price)||"0.00"),1)]),e("td",ct,[e("span",{class:X(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",s.verified_by?"bg-green-100 text-green-800":s.rejected_by?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"])},o(s.status?G(s.status):s.verified_by?"Verified":s.rejected_by?"Rejected":"Pending"),3)]),e("td",ut,[e("div",mt,o(Z(s.created_at)),1),e("div",ft," by "+o(((U=s.submitted_by)==null?void 0:U.name)||"System"),1)]),e("td",xt,[e("div",pt,[r(i(Y),{href:a.route("staff.payments.verify",s.id),class:"text-blue-600 hover:text-blue-900"},{default:m(()=>t[11]||(t[11]=[v(" Review ")])),_:2},1032,["href"]),!s.verified_by&&!s.rejected_by?(u(),x("button",{key:0,onClick:gt=>T(s),class:"text-red-600 hover:text-red-900"}," Reject ",8,_t)):y("",!0)])])])}),128))])])]),(P=l.payments)!=null&&P.meta&&l.payments.meta.last_page>1?(u(),F(oe,{key:0,pagination:l.payments.meta,onPageChanged:W,class:"mt-6"},null,8,["pagination"])):y("",!0)])])])]),r(ae,{show:f.value,onClose:t[5]||(t[5]=s=>f.value=!1)},{default:m(()=>[e("div",vt,[t[15]||(t[15]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Reject Payment ",-1)),t[16]||(t[16]=e("p",{class:"text-sm text-gray-600 mb-4"}," Please provide a reason for rejecting this payment. The customer will be notified. ",-1)),e("form",{onSubmit:ee(I,["prevent"])},[r(re,{modelValue:i(c).rejection_reason,"onUpdate:modelValue":t[3]||(t[3]=s=>i(c).rejection_reason=s),name:"rejection_reason",placeholder:"Enter rejection reason...",rows:"4",class:"w-full",error:i(c).errors.rejection_reason},null,8,["modelValue","error"]),r(le,{message:i(c).errors.rejection_reason,class:"mt-2"},null,8,["message"]),e("div",ht,[r(ie,{onClick:t[4]||(t[4]=s=>f.value=!1)},{default:m(()=>t[13]||(t[13]=[v(" Cancel ")])),_:1}),r(de,{type:"submit",disabled:i(c).processing},{default:m(()=>t[14]||(t[14]=[v(" Confirm Reject ")])),_:1},8,["disabled"])])],32)])]),_:1},8,["show"])]}),_:1}))}};export{Ot as default};
