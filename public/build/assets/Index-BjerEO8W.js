import{g,i as ae,h as re,W as h,j as ie,d as ne,o as u,w as a,b as l,a as i,c as p,e as b,t as r,f,u as de,n as T,k as ue,l as ce}from"./app-DSvpKds8.js";import{E as me}from"./EmployeeLayout-41rkCMFi.js";import{_ as R}from"./PrimaryButton-BaAbC_Sk.js";import{_ as L}from"./SecondaryButton-BMk3kL1H.js";import{D as O}from"./DangerButton-Bd5m9G75.js";import{_ as pe}from"./SearchInput-BdZpY5qg.js";import{S as W}from"./SelectInput-CJKTp_P8.js";import{_ as fe}from"./DataTable-Bq8Hbpmy.js";import{M as ge}from"./Modal-CPqIeUsw.js";import{P as ve}from"./Pagination-lASWqMkU.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as xe}from"./UserGroupIcon-DBuG4fUV.js";import"./NavLink-B7vUiQXa.js";const he={class:"flex justify-between items-center w-full px-6 md:px-8"},be={class:"flex gap-2"},_e={class:"zoom-content"},we={class:"px-6 py-4"},Ce={key:0,class:"mb-4"},ke={key:0,class:"p-3 bg-blue-100 text-blue-800 rounded"},Ae={key:1,class:"p-3 bg-green-100 text-green-800 rounded"},Se={key:2,class:"p-3 bg-red-100 text-red-800 rounded"},Ee={class:"mb-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3"},Ve={class:"w-full sm:w-96"},De={class:"flex items-center gap-3"},Ne={class:"text-sm text-gray-500 bg-blue-50 px-3 py-1 rounded border border-blue-100 whitespace-nowrap"},Re={key:0,class:"ml-1"},Le={class:"justify-center flex items-center"},$e={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-full max-w-[95vw]"},je={class:"p-4 bg-white border-b border-gray-200"},Ie={class:"flex items-center"},Me={class:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center mr-3"},ze={class:"text-sm font-medium text-gray-700"},Fe={class:"font-medium text-gray-900 block"},Pe={key:0,class:"text-xs text-gray-500 block"},Ue={class:"text-gray-700"},Be={class:"flex items-center"},Te={class:"text-gray-700"},Oe={class:"flex space-x-2"},We={class:"text-center py-8"},Ge={class:"bg-gray-50 rounded-lg p-6 max-w-md mx-auto"},qe={class:"text-gray-500 mb-3"},He={key:0,class:"mt-4"},Je={class:"p-5"},Ke={class:"mt-1 text-sm text-gray-600"},Qe={class:"mt-4 flex justify-end space-x-3"},Xe={key:0},Ye={key:1},Ze={__name:"Index",props:{employees:Object,status:String,success:String,error:String},setup(o){var I,M,z,F,P;const k=o,D=g(!1),S=g(null),V=g(!1),c=g(((I=k.employees.filters)==null?void 0:I.search)||""),_=g(((M=k.employees.filters)==null?void 0:M.role)||""),w=g(((z=k.employees.filters)==null?void 0:z.region)||""),v=g(((F=k.employees.filters)==null?void 0:F.sort_field)||"name"),A=g(((P=k.employees.filters)==null?void 0:P.sort_direction)||"asc"),$=g([{value:"",text:"All Regions"}]),G=[{value:"",text:"All Roles"},{value:"admin",text:"Admin"},{value:"staff",text:"Staff"},{value:"driver",text:"Driver"},{value:"collector",text:"Collector"}],q={admin:"bg-purple-100 text-purple-800",staff:"bg-blue-100 text-blue-800",driver:"bg-green-100 text-green-800",collector:"bg-yellow-100 text-yellow-800"},H=[{field:"name",header:"Employee Name",sortable:!0},{field:"email",header:"Email",sortable:!0},{field:"role",header:"Role",sortable:!0},{field:"region.name",header:"Region",sortable:!0},{field:"status",header:"Status",sortable:!0},{field:"actions",header:"Actions",sortable:!1}];ae(()=>(k.employees.data||[]).filter(e=>{var t,n,y,x,E,U,B;const m=c.value===""||((t=e.name)==null?void 0:t.toLowerCase().includes(c.value.toLowerCase()))||((n=e.email)==null?void 0:n.toLowerCase().includes(c.value.toLowerCase()))||((x=(y=e.employee_profile)==null?void 0:y.employee_id)==null?void 0:x.toLowerCase().includes(c.value.toLowerCase())),C=!_.value||e.role===_.value,d=!w.value||((B=(U=(E=e.employee_profile)==null?void 0:E.region)==null?void 0:U.id)==null?void 0:B.toString())===w.value;return m&&C&&d}).sort((e,m)=>{var n,y,x,E;const C=A.value==="asc"?1:-1;let d=e[v.value],t=m[v.value];return v.value==="region.name"&&(d=(y=(n=e.employee_profile)==null?void 0:n.region)==null?void 0:y.name,t=(E=(x=m.employee_profile)==null?void 0:x.region)==null?void 0:E.name),d==null&&(d=""),t==null&&(t=""),d=String(d).toLowerCase(),t=String(t).toLowerCase(),d<t?-1*C:d>t?1*C:0}));const J=s=>{if(!s)return"EM";const e=s.split(" ");return e.length>=2?`${e[0].charAt(0)}${e[1].charAt(0)}`.toUpperCase():s.substring(0,2).toUpperCase()},K=s=>s?s.replace(/\b\w/g,e=>e.toUpperCase()):"",Q=s=>q[s]||"bg-gray-100 text-gray-800",X=s=>{v.value=s.field,A.value=s.direction},Y=s=>{h.get(route("admin.employees.index"),{page:s,search:c.value,role:_.value,region:w.value,sort_field:v.value,sort_direction:A.value},{preserveState:!0,preserveScroll:!0,replace:!0})},Z=s=>{S.value=s,D.value=!0},N=()=>{D.value=!1,S.value=null,V.value=!1},ee=()=>{S.value&&(V.value=!0,h.put(route("admin.employees.archive",S.value.id),{},{preserveScroll:!0,onSuccess:()=>h.reload({only:["employees"]}),onError:()=>alert("Failed to disable employee"),onFinish:()=>N()}))},j=()=>h.get(route("admin.employees.create")),te=s=>h.get(route("admin.employees.show",s)),le=s=>h.get(route("admin.employees.edit",s)),se=()=>h.get(route("admin.employees.archived")),oe=async()=>{try{const{data:s}=await ce.get("/api/delivery/regions"),e=Array.isArray(s)?s:s.data||s.regions||[];$.value=[{value:"",text:"All Regions"},...e.map(m=>({value:String(m.id),text:m.name}))]}catch(s){console.error("Failed to fetch regions:",s)}};return re([c,_,w,v,A],()=>{h.get(route("admin.employees.index"),{search:c.value,role:_.value,region:w.value,sort_field:v.value,sort_direction:A.value,page:1},{preserveState:!0,replace:!0})},{deep:!0}),ie(oe),(s,e)=>(u(),ne(me,null,{header:a(()=>[l("div",he,[e[5]||(e[5]=l("div",null,[l("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Employee Management"),l("p",{class:"mt-1 text-sm text-gray-500"}," Manage active employees and their information ")],-1)),l("div",be,[i(L,{onClick:se},{default:a(()=>e[3]||(e[3]=[f("View Disabled Accounts")])),_:1}),i(R,{onClick:j},{default:a(()=>e[4]||(e[4]=[f("Add New Employee")])),_:1})])])]),default:a(()=>{var m,C,d;return[l("div",_e,[l("div",we,[o.status||o.success||o.error?(u(),p("div",Ce,[o.status?(u(),p("div",ke,r(o.status),1)):b("",!0),o.success?(u(),p("div",Ae,r(o.success),1)):b("",!0),o.error?(u(),p("div",Se,r(o.error),1)):b("",!0)])):b("",!0),l("div",Ee,[l("div",Ve,[i(pe,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),placeholder:"Search employees by name, email, or employee ID...",class:"w-full"},null,8,["modelValue"])]),l("div",De,[i(W,{modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=t=>_.value=t),options:G,"option-value":"value","option-label":"text",placeholder:"All Roles",class:"w-full sm:w-48"},null,8,["modelValue"]),i(W,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=t=>w.value=t),options:$.value,"option-value":"value","option-label":"text",placeholder:"All Regions",class:"w-full sm:w-48"},null,8,["modelValue","options"]),l("div",Ne,[f(" ðŸ“‹ Showing "+r(((m=o.employees.data)==null?void 0:m.length)||0)+" active "+r(((C=o.employees.data)==null?void 0:C.length)===1?"employee":"employees")+" ",1),o.employees.data&&o.employees.data.length<o.employees.total?(u(),p("span",Re," (Page "+r(o.employees.current_page)+" of "+r(o.employees.last_page)+") ",1)):b("",!0)])])]),l("div",Le,[l("div",$e,[l("div",je,[i(fe,{columns:H,data:o.employees.data||[],"sort-field":v.value,"sort-direction":A.value,onSort:X,class:"w-full"},{name:a(({row:t})=>{var n;return[l("div",Ie,[l("div",Me,[l("span",ze,r(J(t.name)),1)]),l("div",null,[l("span",Fe,r(K(t.name)||"N/A"),1),(n=t.employee_profile)!=null&&n.employee_id?(u(),p("span",Pe," ID: "+r(t.employee_profile.employee_id),1)):b("",!0)])])]}),email:a(({row:t})=>[l("span",Ue,r(t.email||"No email"),1)]),role:a(({row:t})=>[l("span",{class:T(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize",Q(t.role)])},r(t.role||"N/A"),3)]),"region.name":a(({row:t})=>{var n,y,x;return[l("div",Be,[(n=t.employee_profile)!=null&&n.region&&t.employee_profile.region.color_hex?(u(),p("div",{key:0,class:"w-3 h-3 rounded-full mr-2 border border-gray-300",style:ue({backgroundColor:t.employee_profile.region.color_hex})},null,4)):b("",!0),l("span",Te,r(((x=(y=t.employee_profile)==null?void 0:y.region)==null?void 0:x.name)||"Not assigned"),1)])]}),status:a(({row:t})=>[l("span",{class:T(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize",t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},r(t.is_active?"Active":"Inactive"),3)]),actions:a(({row:t})=>[l("div",Oe,[i(L,{onClick:n=>te(t.id),class:"text-xs py-1 px-2"},{default:a(()=>e[6]||(e[6]=[f("View")])),_:2},1032,["onClick"]),i(R,{onClick:n=>le(t.id),class:"text-xs py-1 px-2"},{default:a(()=>e[7]||(e[7]=[f("Edit")])),_:2},1032,["onClick"]),i(O,{onClick:n=>Z(t),class:"text-xs py-1 px-2"},{default:a(()=>e[8]||(e[8]=[f(" Disable ")])),_:2},1032,["onClick"])])]),empty:a(()=>[l("div",We,[l("div",Ge,[i(de(xe),{class:"h-10 w-10 text-gray-400 mx-auto mb-3"}),e[10]||(e[10]=l("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No active employees found",-1)),l("p",qe,r(c.value?"Try adjusting your search terms":"Get started by adding your first employee"),1),i(R,{onClick:j},{default:a(()=>e[9]||(e[9]=[f("Add New Employee")])),_:1})])])]),_:1},8,["data","sort-field","sort-direction"]),((d=o.employees.links)==null?void 0:d.length)>3?(u(),p("div",He,[i(ve,{pagination:o.employees,onPageChanged:Y},null,8,["pagination"])])):b("",!0)])])])])]),i(ge,{show:D.value,onClose:N},{default:a(()=>{var t;return[l("div",Je,[e[14]||(e[14]=l("h2",{class:"text-lg font-medium text-gray-900"},"Disable Employee?",-1)),l("p",Ke,[e[11]||(e[11]=f(" Are you sure you want to disable ")),l("strong",null,r((t=S.value)==null?void 0:t.name),1),e[12]||(e[12]=f("? This will move them to the disabled employees list. "))]),l("div",Qe,[i(L,{onClick:N},{default:a(()=>e[13]||(e[13]=[f("Cancel")])),_:1}),i(O,{onClick:ee,disabled:V.value},{default:a(()=>[V.value?(u(),p("span",Xe,"Processing...")):(u(),p("span",Ye,"Disable Employee"))]),_:1},8,["disabled"])])])]}),_:1},8,["show"])]}),_:1}))}},pt=ye(Ze,[["__scopeId","data-v-066ba357"]]);export{pt as default};
