import{g as u,i as h,c as n,o as a,e as C,b as e,a2 as q,a as r,t as i,w as d,d as E,f as l,F as U,r as I,W as m}from"./app-B0MxlU5m.js";import{_ as O}from"./SearchInput-SbslQi-L.js";import{_ as k}from"./PrimaryButton-Cvq5q4eC.js";import{_ as w}from"./SecondaryButton-BRyA478y.js";import{M as L}from"./Modal-DzMlMPRl.js";import{S as G}from"./SelectInput-DDrWxS1C.js";import{_ as D}from"./InputLabel-Cbv0doCr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"space-y-6"},J={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-4"},K={class:"flex items-center"},X={class:"ml-3"},Y={class:"text-sm font-medium text-green-800"},Z={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},ee={class:"flex items-center"},te={class:"ml-3"},se={class:"text-sm font-medium text-red-800"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le={class:"bg-white shadow rounded-lg border border-gray-200 p-6"},re={class:"flex items-center"},ae={class:"ml-4"},ne={class:"text-2xl font-semibold text-gray-900"},ie={class:"bg-white shadow rounded-lg border border-gray-200 p-6"},de={class:"flex items-center"},ue={class:"ml-4"},ce={class:"text-2xl font-semibold text-gray-900"},me={class:"bg-white shadow rounded-lg border border-gray-200"},pe={class:"px-6 py-4"},ve={class:"flex items-center justify-between"},fe={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ge={key:1,class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xe={key:2},he={key:3},ke={class:"bg-white shadow rounded-lg border border-gray-200 p-6"},we={class:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between"},be={class:"w-full sm:flex-1"},ye={class:"w-full sm:w-48"},_e={class:"bg-white shadow rounded-lg border border-gray-200"},Ce={class:"px-6 py-4"},Be={key:0,class:"text-center py-8"},Me={class:"mt-1 text-sm text-gray-500"},ze={key:1,class:"space-y-3"},Ve={class:"flex items-center space-x-4 flex-1"},je={class:"flex-1 min-w-0"},Se={class:"font-medium text-gray-900 truncate"},Le={class:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 mt-1 text-sm text-gray-500"},De={class:"flex items-center"},Fe={class:"flex items-center"},$e={class:"flex space-x-2"},Ae=["onClick"],Ne={class:"p-6"},Re={class:"mt-4 text-center"},He={class:"mt-2 text-sm text-gray-500"},Te={class:"mt-6 flex justify-center space-x-3"},Qe={class:"p-6"},We={class:"mt-4 text-center"},qe={class:"mt-2 text-sm text-gray-500"},Ee={class:"mt-6 flex justify-center space-x-3"},Ye={__name:"BackupSection",props:{backups:Array},setup(B){const b=B,p=u(!1),M=u(!1),c=u(""),y=u("newest"),v=u(!1),f=u(""),g=u(!1),x=u(""),F=h(()=>b.backups.length===0?"Never":b.backups[0].created_at);h(()=>"database.sqlite");const $=h(()=>[{value:"newest",label:"Newest First"},{value:"oldest",label:"Oldest First"},{value:"size",label:"File Size"}]),z=h(()=>{let s=[...b.backups];if(c.value){const t=c.value.toLowerCase();s=s.filter(o=>o.filename.toLowerCase().includes(t)||o.created_at.toLowerCase().includes(t))}switch(y.value){case"oldest":return s.reverse();case"size":return s.sort((t,o)=>{const S=parseFloat(t.size);return parseFloat(o.size)-S});case"newest":default:return s}}),V=()=>{v.value=!1,f.value=""},j=()=>{g.value=!1,x.value=""},A=()=>{p.value=!0,m.post("/admin/utilities/backup",{},{preserveScroll:!0,onFinish:()=>{p.value=!1,m.reload({only:["backups"]})}})},N=s=>{M.value=!0;const t=document.createElement("a");t.href=`/admin/utilities/backup/download?filename=${encodeURIComponent(s)}`,t.download=s,document.body.appendChild(t),t.click(),document.body.removeChild(t),M.value=!1},R=s=>{f.value=s,v.value=!0},H=()=>{m.post("/admin/utilities/restore",{filename:f.value},{preserveScroll:!0,onFinish:()=>{v.value=!1,m.reload({only:["backups"]})}})},T=s=>{x.value=s,g.value=!0},Q=()=>{g.value=!1,m.delete("/admin/utilities/backup",{data:{filename:x.value}},{preserveScroll:!0,onFinish:()=>{m.reload({only:["backups"]})}})},W=()=>{c.value=""};return(s,t)=>(a(),n("div",P,[s.$page.props.flash.success?(a(),n("div",J,[e("div",K,[t[2]||(t[2]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-green-600",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",X,[e("p",Y,i(s.$page.props.flash.success),1)])])])):C("",!0),s.$page.props.flash.error?(a(),n("div",Z,[e("div",ee,[t[3]||(t[3]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-600",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",te,[e("p",se,i(s.$page.props.flash.error),1)])])])):C("",!0),e("div",oe,[e("div",le,[e("div",re,[t[5]||(t[5]=e("div",{class:"flex-shrink-0 p-3 bg-green-100 rounded-lg"},[e("svg",{class:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})])],-1)),e("div",ae,[t[4]||(t[4]=e("p",{class:"text-sm font-medium text-gray-500"},"Total Backups",-1)),e("p",ne,i(B.backups.length),1)])])]),e("div",ie,[e("div",de,[t[7]||(t[7]=e("div",{class:"flex-shrink-0 p-3 bg-blue-100 rounded-lg"},[e("svg",{class:"h-6 w-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",ue,[t[6]||(t[6]=e("p",{class:"text-sm font-medium text-gray-500"},"Last Backup",-1)),e("p",ce,i(F.value),1)])])])]),e("div",me,[t[11]||(t[11]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Create Backup"),e("p",{class:"mt-1 text-sm text-gray-500"}," Create a complete copy of your database for safekeeping ")],-1)),e("div",pe,[e("div",ve,[t[10]||(t[10]=e("div",null,[e("p",{class:"text-sm text-gray-600"}," Click the button to create a new database backup ")],-1)),r(k,{onClick:A,disabled:p.value,class:"min-w-[160px] justify-center"},{default:d(()=>[p.value?(a(),n("svg",fe,t[8]||(t[8]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(a(),n("svg",ge,t[9]||(t[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)]))),p.value?(a(),n("span",xe,"Creating...")):(a(),n("span",he,"Create New Backup"))]),_:1},8,["disabled"])])])]),e("div",ke,[e("div",we,[e("div",be,[r(D,{value:"Search Backups",class:"mb-2"}),r(O,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),placeholder:"Search backups..."},null,8,["modelValue"])]),e("div",ye,[r(D,{value:"Sort By",class:"mb-2"}),r(G,{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=o=>y.value=o),options:$.value,"option-value":"value","option-label":"label",placeholder:"Sort by",class:"w-full"},null,8,["modelValue","options"])])])]),e("div",_e,[t[21]||(t[21]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Existing Backups"),e("p",{class:"mt-1 text-sm text-gray-500"}," Manage, download, and restore your database backups ")],-1)),e("div",Ce,[z.value.length===0?(a(),n("div",Be,[t[13]||(t[13]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t[14]||(t[14]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No backups found",-1)),e("p",Me,i(c.value?"No backups match your search.":"Get started by creating your first database backup."),1),c.value?(a(),E(w,{key:0,onClick:W,class:"mt-4"},{default:d(()=>t[12]||(t[12]=[l(" Clear Search ")])),_:1})):C("",!0)])):(a(),n("div",ze,[(a(!0),n(U,null,I(z.value,(o,S)=>(a(),n("div",{key:o.filename,class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-green-50 transition-colors duration-150 group"},[e("div",Ve,[t[17]||(t[17]=e("div",{class:"flex-shrink-0 p-2 bg-blue-100 rounded-lg group-hover:bg-green-100 transition-colors"},[e("svg",{class:"h-5 w-5 text-blue-600 group-hover:text-green-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),e("div",je,[e("h4",Se,i(o.filename),1),e("div",Le,[e("span",De,[t[15]||(t[15]=e("svg",{class:"flex-shrink-0 mr-1.5 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),l(" "+i(o.created_at),1)]),e("span",Fe,[t[16]||(t[16]=e("svg",{class:"flex-shrink-0 mr-1.5 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})],-1)),l(" "+i(o.size),1)])])])]),e("div",$e,[r(w,{onClick:_=>N(o.filename),class:"flex items-center text-sm",title:"Download backup file to your computer"},{default:d(()=>t[18]||(t[18]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),l(" Download ")])),_:2},1032,["onClick"]),r(k,{onClick:_=>R(o.filename),class:"flex items-center text-sm",title:"Restore this backup to replace current database"},{default:d(()=>t[19]||(t[19]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),l(" Restore ")])),_:2},1032,["onClick"]),e("button",{onClick:_=>T(o.filename),class:"flex items-center px-3 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors duration-200",title:"Permanently delete this backup"},t[20]||(t[20]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),l(" Delete ")]),8,Ae)])]))),128))]))])]),t[34]||(t[34]=q('<div class="bg-green-50 border border-green-200 rounded-lg p-6"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-green-600" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div><div class="ml-3"><h3 class="text-sm font-medium text-green-800"> About Database Backups </h3><div class="mt-2 text-sm text-green-700 space-y-1"><p>• <strong>Download</strong>: Save backup files to your computer for thesis demonstration</p><p>• <strong>Backups</strong>: Complete copies of your SQLite database (.sqlite files)</p><p>• <strong>Restore</strong>: Replace current database with selected backup</p><p>• <strong>Safety</strong>: Temporary backup created automatically before restoration</p><p>• <strong>File Format</strong>: Actual SQLite database files that can be opened with DB Browser for SQLite</p></div></div></div></div>',1)),r(L,{show:v.value,onClose:V,maxWidth:"md"},{default:d(()=>[e("div",Ne,[t[27]||(t[27]=e("div",{class:"flex items-center justify-center w-12 h-12 mx-auto bg-yellow-100 rounded-full"},[e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",Re,[t[24]||(t[24]=e("h3",{class:"text-lg font-medium text-gray-900"},"Restore Backup",-1)),e("p",He,[t[22]||(t[22]=l(" Are you sure you want to restore backup ")),e("strong",null,'"'+i(f.value)+'"',1),t[23]||(t[23]=l("? This will replace your current database. A temporary safety backup will be created automatically. "))])]),e("div",Te,[r(w,{onClick:V},{default:d(()=>t[25]||(t[25]=[l(" Cancel ")])),_:1}),r(k,{onClick:H,class:"bg-green-600 hover:bg-green-700"},{default:d(()=>t[26]||(t[26]=[l(" Confirm Restore ")])),_:1})])])]),_:1},8,["show"]),r(L,{show:g.value,onClose:j,maxWidth:"md"},{default:d(()=>[e("div",Qe,[t[33]||(t[33]=e("div",{class:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full"},[e("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",We,[t[30]||(t[30]=e("h3",{class:"text-lg font-medium text-gray-900"},"Delete Backup",-1)),e("p",qe,[t[28]||(t[28]=l(" Are you sure you want to delete backup ")),e("strong",null,'"'+i(x.value)+'"',1),t[29]||(t[29]=l("? This action cannot be undone. "))])]),e("div",Ee,[r(w,{onClick:j},{default:d(()=>t[31]||(t[31]=[l(" Cancel ")])),_:1}),r(k,{onClick:Q,class:"bg-red-600 hover:bg-red-700"},{default:d(()=>t[32]||(t[32]=[l(" Confirm Delete ")])),_:1})])])]),_:1},8,["show"])]))}};export{Ye as default};
