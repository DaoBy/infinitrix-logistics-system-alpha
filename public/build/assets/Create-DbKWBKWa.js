import{C as j,g as b,j as z,h as D,d as K,o as d,w as k,b as t,c as u,e as x,t as g,s as T,a as l,u as a,v as O,x as H,F as Q,r as J,f as U,W as Y}from"./app-B0MxlU5m.js";import{E as X}from"./EmployeeLayout-CfA_UWXy.js";import{_ as c}from"./InputLabel-Cbv0doCr.js";import{T as f}from"./TextInput-CgOKMwoW.js";import{_ as Z}from"./TextArea-DYBBFGZR.js";import{_ as V}from"./InputError-CNetEjNY.js";import{_ as ee}from"./PrimaryButton-Cvq5q4eC.js";import{_ as $}from"./SecondaryButton-BRyA478y.js";import{_ as te}from"./MapPicker-D9uv5oie.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-RNmN4-k9.js";import"./DangerButton-CMc3f1cK.js";/* empty css                                                                  */const oe={class:"flex justify-between items-center w-full px-4 md:px-6"},se={class:"py-6 px-2 md:px-6"},ae={class:"max-w-screen-xl mx-auto"},le={key:0,class:"mb-6"},re={key:0,class:"p-4 bg-blue-100 text-blue-800 rounded"},ie={key:1,class:"p-4 bg-green-100 text-green-800 rounded"},ne={key:2,class:"p-4 bg-red-100 text-red-800 rounded"},de={class:"grid grid-cols-1 lg:grid-cols-4 gap-8"},ue={class:"lg:col-span-3"},ce={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},me={class:"space-y-8"},pe={class:"border-b border-gray-200 pb-6"},ge={class:"grid grid-cols-1 gap-6"},fe={class:"flex items-center mt-1"},ve={class:"border-b border-gray-200 pb-6"},ye={class:"mt-1 relative"},be={key:0,class:"absolute inset-y-0 right-0 pr-3 flex items-center"},xe={key:1,class:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto"},he=["onClick"],_e={class:"font-medium"},we={class:"text-sm text-gray-600"},ke={class:"border-b border-gray-200 pb-6"},Ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ce={class:"md:col-span-2"},Se={class:"md:col-span-2"},Me={class:"pb-6"},Ue={class:"mt-2 text-sm text-gray-500"},Ae={class:"flex justify-between items-center pt-4 px-2"},Fe={class:"lg:col-span-1"},Be={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Ge={class:"flex justify-between items-start mb-3"},Te={key:0,class:"space-y-3"},$e={key:1,class:"text-center py-2"},He={__name:"Create",props:{status:String,success:String,error:String},setup(m){const o=j({name:"",warehouse_address:"",street_address:"",barangay:"",city_municipality:"",province:"",postal_code:"",color_hex:"#CCCCCC",geographic_location:{lat:14.5995,lng:120.9842}}),C=b(""),y=b([]),S=b(!1),h=b(!1),v=b(null),_=b(!0);let M=null,w=null;function P(r,e){let s;return function(...p){const n=()=>{clearTimeout(s),r(...p)};clearTimeout(s),s=setTimeout(n,e)}}const E=()=>new Promise(r=>{if(window.google&&window.google.maps){h.value=!0,r();return}const e=setInterval(()=>{window.google&&window.google.maps&&(clearInterval(e),h.value=!0,I(),r())},100)});function I(){window.google&&window.google.maps&&(M=new google.maps.places.AutocompleteService,w=new google.maps.Geocoder)}z(async()=>{await E()});const R=P(async r=>{const e=r.target.value;if(!e||e.length<3){y.value=[];return}if(!h.value||!M){console.warn("Google Maps not loaded yet");return}S.value=!0;try{const s={input:e,types:["geocode","establishment"],componentRestrictions:{country:"ph"}};M.getPlacePredictions(s,(i,p)=>{S.value=!1,p===google.maps.places.PlacesServiceStatus.OK&&i?y.value=i.map(n=>({place_id:n.place_id,main_text:n.structured_formatting.main_text,secondary_text:n.structured_formatting.secondary_text,description:n.description})):y.value=[]})}catch(s){S.value=!1,console.error("Address search error:",s)}},300);async function q(r){if(C.value=r.description,y.value=[],!h.value||!w){console.warn("Google Maps not loaded yet");return}try{const e=await new Promise((i,p)=>{w.geocode({placeId:r.place_id},(n,G)=>{G==="OK"&&n[0]?i(n[0]):p(new Error(`Geocoding failed: ${G}`))})});A(e.address_components);const s={lat:e.geometry.location.lat(),lng:e.geometry.location.lng()};o.geographic_location=s,o.warehouse_address=r.description,v.value&&typeof v.value.onMarkerManuallyUpdated=="function"&&v.value.onMarkerManuallyUpdated(s)}catch(e){console.error("Error selecting address:",e),o.warehouse_address=r.description}}function A(r){const e={street:"",barangay:"",city:"",province:"",postal:""};r.forEach(s=>{const i=s.types;i.includes("street_number")?e.street=s.long_name+" "+e.street:i.includes("route")?e.street+=s.long_name:i.includes("sublocality_level_1")||i.includes("sublocality")?e.barangay=s.long_name:i.includes("locality")?e.city=s.long_name:i.includes("administrative_area_level_2")?e.province=s.long_name:i.includes("administrative_area_level_1")?e.province||(e.province=s.long_name):i.includes("postal_code")&&(e.postal=s.long_name)}),o.street_address=e.street.trim(),o.barangay=e.barangay,o.city_municipality=e.city,o.province=e.province,o.postal_code=e.postal}function F(){const r=[o.street_address,o.barangay,o.city_municipality,o.province,o.postal_code].filter(e=>e&&e.trim()!=="");o.warehouse_address=r.join(", ")}D([()=>o.street_address,()=>o.barangay,()=>o.city_municipality,()=>o.province,()=>o.postal_code],()=>{F()});async function L(){if(!(!h.value||!w||!o.warehouse_address))try{const r=await new Promise((s,i)=>{w.geocode({address:o.warehouse_address},(p,n)=>{n==="OK"&&p[0]?s(p[0]):i(new Error(`Geocoding failed: ${n}`))})});A(r.address_components);const e={lat:r.geometry.location.lat(),lng:r.geometry.location.lng()};o.geographic_location=e,v.value&&typeof v.value.onMarkerManuallyUpdated=="function"&&v.value.onMarkerManuallyUpdated(e)}catch(r){console.error("Manual geocoding failed:",r)}}function N(r){o.geographic_location=r}function W(){F(),o.post(route("admin.regions.store"))}function B(){Y.get(route("admin.regions.index"))}return(r,e)=>(d(),K(X,null,{header:k(()=>[t("div",oe,[e[15]||(e[15]=t("div",null,[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Add New Warehouse"),t("p",{class:"mt-1 text-sm text-gray-500"}," Create and configure a new warehouse with precise location details. ")],-1)),l($,{onClick:B},{default:k(()=>e[14]||(e[14]=[U("View Warehouses")])),_:1})])]),default:k(()=>[t("div",se,[t("div",ae,[m.status||m.success||m.error?(d(),u("div",le,[m.status?(d(),u("div",re,g(m.status),1)):x("",!0),m.success?(d(),u("div",ie,g(m.success),1)):x("",!0),m.error?(d(),u("div",ne,g(m.error),1)):x("",!0)])):x("",!0),t("div",de,[t("div",ue,[t("div",ce,[t("form",{onSubmit:T(W,["prevent"])},[t("div",me,[t("div",pe,[e[17]||(e[17]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Step 1: Region Information",-1)),t("div",ge,[t("div",null,[l(c,{for:"name",value:"Region Name *"}),l(f,{id:"name",modelValue:a(o).name,"onUpdate:modelValue":e[0]||(e[0]=s=>a(o).name=s),class:"mt-1 block w-full",placeholder:"e.g., Metro Manila, Central Luzon, Bataan Warehouse",required:""},null,8,["modelValue"]),l(V,{message:a(o).errors.name},null,8,["message"])]),t("div",null,[l(c,{for:"color_hex",value:"Region Color *"}),t("div",fe,[O(t("input",{type:"color",id:"color_hex","onUpdate:modelValue":e[1]||(e[1]=s=>a(o).color_hex=s),class:"h-10 w-10 rounded border border-gray-300 mr-2"},null,512),[[H,a(o).color_hex]]),l(f,{modelValue:a(o).color_hex,"onUpdate:modelValue":e[2]||(e[2]=s=>a(o).color_hex=s),class:"block w-32",placeholder:"#FF0000",required:"",pattern:"^#[0-9A-Fa-f]{6}$"},null,8,["modelValue"])]),l(V,{message:a(o).errors.color_hex},null,8,["message"]),e[16]||(e[16]=t("p",{class:"text-sm text-gray-500 mt-1"},"Choose a color to represent this region on maps and charts",-1))])])]),t("div",ve,[e[20]||(e[20]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Step 2: Find General Location",-1)),t("div",null,[l(c,{for:"address-search",value:"Search for City/Municipality/Landmark *"}),t("div",ye,[l(f,{id:"address-search",modelValue:C.value,"onUpdate:modelValue":e[3]||(e[3]=s=>C.value=s),onInput:a(R),class:"block w-full pr-10",placeholder:"Type city, municipality, or landmark (e.g., Balanga City, Bataan)",autocomplete:"off"},null,8,["modelValue","onInput"]),S.value?(d(),u("div",be,e[18]||(e[18]=[t("svg",{class:"animate-spin h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):x("",!0),y.value.length>0&&C.value?(d(),u("div",xe,[(d(!0),u(Q,null,J(y.value,(s,i)=>(d(),u("div",{key:i,onClick:p=>q(s),onMousedown:e[4]||(e[4]=T(()=>{},["prevent"])),class:"px-4 py-2 cursor-pointer hover:bg-gray-100 border-b border-gray-100 last:border-b-0"},[t("div",_e,g(s.main_text),1),t("div",we,g(s.secondary_text),1)],40,he))),128))])):x("",!0)]),e[19]||(e[19]=t("p",{class:"text-sm text-gray-500 mt-1"},"Search for the general area first. You'll specify the exact warehouse address in the next step.",-1))])]),t("div",ke,[e[21]||(e[21]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Step 3: Specify Exact Warehouse Address",-1)),t("div",Ve,[t("div",Ce,[l(c,{for:"street_address",value:"Street Address/Building Name *"}),l(f,{id:"street_address",modelValue:a(o).street_address,"onUpdate:modelValue":e[5]||(e[5]=s=>a(o).street_address=s),class:"mt-1 block w-full",placeholder:"e.g., 4th Floor, The Bunker, Capitol Compound",required:""},null,8,["modelValue"])]),t("div",null,[l(c,{for:"barangay",value:"Barangay"}),l(f,{id:"barangay",modelValue:a(o).barangay,"onUpdate:modelValue":e[6]||(e[6]=s=>a(o).barangay=s),class:"mt-1 block w-full",placeholder:"e.g., San Jose"},null,8,["modelValue"])]),t("div",null,[l(c,{for:"city_municipality",value:"City/Municipality *"}),l(f,{id:"city_municipality",modelValue:a(o).city_municipality,"onUpdate:modelValue":e[7]||(e[7]=s=>a(o).city_municipality=s),class:"mt-1 block w-full",placeholder:"e.g., Balanga City",required:""},null,8,["modelValue"])]),t("div",null,[l(c,{for:"province",value:"Province *"}),l(f,{id:"province",modelValue:a(o).province,"onUpdate:modelValue":e[8]||(e[8]=s=>a(o).province=s),class:"mt-1 block w-full",placeholder:"e.g., Bataan",required:""},null,8,["modelValue"])]),t("div",null,[l(c,{for:"postal_code",value:"Postal Code"}),l(f,{id:"postal_code",modelValue:a(o).postal_code,"onUpdate:modelValue":e[9]||(e[9]=s=>a(o).postal_code=s),class:"mt-1 block w-full",placeholder:"e.g., 2100"},null,8,["modelValue"])]),t("div",Se,[l(c,{for:"warehouse_address",value:"Full Warehouse Address (Auto-generated) *"}),l(Z,{id:"warehouse_address",modelValue:a(o).warehouse_address,"onUpdate:modelValue":e[10]||(e[10]=s=>a(o).warehouse_address=s),class:"mt-1 block w-full",rows:2,required:"",readonly:"",placeholder:"This will be automatically generated from the fields above"},null,8,["modelValue"]),l(V,{message:a(o).errors.warehouse_address},null,8,["message"])])]),t("div",{class:"mt-4"},[t("button",{type:"button",onClick:L,class:"text-sm text-blue-600 hover:text-blue-800"}," ðŸ”„ Update map location based on address above ")])]),t("div",Me,[e[23]||(e[23]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Step 4: Verify Location on Map",-1)),t("div",null,[l(c,{value:"Region Location *"}),e[22]||(e[22]=t("p",{class:"text-sm text-gray-600 mb-2"},"Drag the marker to the exact warehouse location. The map will update when you search or enter an address.",-1)),l(te,{ref_key:"mapPickerRef",ref:v,modelValue:a(o).geographic_location,"onUpdate:modelValue":e[11]||(e[11]=s=>a(o).geographic_location=s),class:"h-64 border border-gray-300 rounded-lg mt-2",onMarkerUpdated:N},null,8,["modelValue"]),t("div",Ue," Coordinates: "+g(a(o).geographic_location.lat.toFixed(6))+", "+g(a(o).geographic_location.lng.toFixed(6)),1),l(V,{message:a(o).errors["geographic_location.lat"]},null,8,["message"]),l(V,{message:a(o).errors["geographic_location.lng"]},null,8,["message"])])]),t("div",Ae,[l($,{type:"button",onClick:B},{default:k(()=>e[24]||(e[24]=[U("View Warehouses")])),_:1}),l(ee,{type:"submit",disabled:a(o).processing},{default:k(()=>[U(g(a(o).processing?"Saving...":"Save Region"),1)]),_:1},8,["disabled"])])])],32)])]),t("div",Fe,[t("div",Be,[t("div",Ge,[e[25]||(e[25]=t("h3",{class:"font-semibold text-blue-800"},"ðŸ“ Quick Guide",-1)),t("button",{onClick:e[12]||(e[12]=s=>_.value=!_.value),class:"text-blue-500 hover:text-blue-700 text-sm"},g(_.value?"Hide":"Show"),1)]),_.value?(d(),u("div",Te,e[26]||(e[26]=[t("div",{class:"text-sm text-blue-700"},[t("h4",{class:"font-medium mb-1"},"Step 1: Region Info"),t("p",{class:"text-xs"},"Name your region and choose a color")],-1),t("div",{class:"text-sm text-blue-700"},[t("h4",{class:"font-medium mb-1"},"Step 2: General Search"),t("p",{class:"text-xs"},"Find the city or municipality first")],-1),t("div",{class:"text-sm text-blue-700"},[t("h4",{class:"font-medium mb-1"},"Step 3: Exact Address"),t("p",{class:"text-xs"},"Fill in the specific warehouse details")],-1),t("div",{class:"text-sm text-blue-700"},[t("h4",{class:"font-medium mb-1"},"Step 4: Map Verify"),t("p",{class:"text-xs"},"Drag the pin to the exact location")],-1),t("div",{class:"mt-3 p-2 bg-blue-100 rounded border border-blue-200"},[t("p",{class:"text-xs text-blue-600 font-medium"},"ðŸ’¡ Pro Tip"),t("p",{class:"text-xs text-blue-600 mt-1"}," Can't find the exact address? Search for the nearest city first, then manually enter the full warehouse address below. ")],-1)]))):(d(),u("div",$e,[t("button",{onClick:e[13]||(e[13]=s=>_.value=!0),class:"text-blue-600 hover:text-blue-800 text-sm"}," Show Guide ")]))])])])])])]),_:1}))}};export{He as default};
