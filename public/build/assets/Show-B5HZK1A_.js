import{E as T}from"./EmployeeLayout-CPjjj0VT.js";import{_ as V}from"./PrimaryButton-v78qpko7.js";import{_ as f}from"./SecondaryButton-CtLoK5i5.js";import{_ as A}from"./InputLabel-DWThjhuV.js";import{S as N}from"./SelectInput-DzDQzV_4.js";import{P as j}from"./Pagination-he4Q2J9p.js";import{g as B,i as E,h as F,W as g,d as z,o as r,w as u,b as t,c as i,e as n,t as a,n as x,a as c,f as p,F as H,r as O}from"./app-7ARdHXBa.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-DmzxVQVl.js";import"./DangerButton-CVW78upS.js";const P={class:"flex justify-between items-center w-full px-6 md:px-8"},R={class:"text-xl font-semibold leading-tight text-gray-800"},U={class:"flex gap-2"},q={class:"zoom-content"},M={class:"px-6 py-4"},$={key:0,class:"mb-4"},I={key:0,class:"p-3 bg-blue-100 text-blue-800 rounded text-sm"},W={key:1,class:"p-3 bg-green-100 text-green-800 rounded text-sm"},G={key:2,class:"p-3 bg-red-100 text-red-800 rounded text-sm"},J={class:"mb-4 bg-white p-3 rounded-lg shadow-sm border"},K={class:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs"},Q={class:"mt-0.5 text-gray-900 capitalize"},X={class:"mt-0.5 text-gray-900 font-medium"},Y={class:"mb-4 bg-white p-3 rounded-lg shadow-sm border"},Z={class:"flex items-end space-x-3"},tt={class:"flex-1"},et={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},st={class:"px-4 py-4"},at={class:"grid grid-cols-1 xl:grid-cols-2 gap-4"},ot={class:"flex justify-between items-start mb-2"},lt={class:"flex items-center space-x-2"},rt={class:"text-xs text-gray-500"},it={key:0,class:"text-right"},dt={class:"text-xs font-medium text-gray-900"},nt={class:"text-[10px] text-gray-500 truncate max-w-[120px]"},ct={key:1,class:"text-right"},ut={class:"space-y-2"},mt={class:"text-xs font-medium text-gray-900 capitalize mt-0.5"},gt={class:"grid grid-cols-2 gap-2"},xt={class:"text-xs text-red-600 bg-red-50 p-1.5 rounded mt-0.5 truncate"},pt={class:"text-xs text-green-600 bg-green-50 p-1.5 rounded mt-0.5 truncate"},yt={key:0,class:"mt-2"},ht={class:"text-xs text-gray-700 mt-0.5 line-clamp-2"},vt={key:0,class:"mt-6"},ft={key:1,class:"text-center py-8"},_t={class:"bg-gray-50 rounded-lg p-6 max-w-md mx-auto"},bt={class:"text-gray-500 text-sm"},kt={__name:"Show",props:{customer:Object,auditLogs:Object,filters:Object,changeTypes:Array,status:String,success:String,error:String},setup(s){var h;const m=s,d=B({change_type:((h=m.filters)==null?void 0:h.change_type)||""}),_=E(()=>{const l=[{value:"",text:"All Types"}];return m.changeTypes.forEach(e=>{l.push({value:e,text:y(e)})}),l}),y=l=>({customer_update:"Customer Update",admin_update:"Admin Update",auto_locked:"Auto Locked",approved_request:"Approved Request"})[l]||l,b=l=>({customer_update:"bg-blue-100 text-blue-800",admin_update:"bg-purple-100 text-purple-800",auto_locked:"bg-amber-100 text-amber-800",approved_request:"bg-green-100 text-green-800"})[l]||"bg-gray-100 text-gray-800",k=l=>new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),w=()=>{g.visit(route("admin.customer-audit-logs.index"))},C=()=>{g.reload({only:["auditLogs"]})},L=()=>{d.value.change_type=""},S=l=>{g.get(route("admin.customers.audit-logs",m.customer.id),{page:l,...d.value},{preserveState:!0,preserveScroll:!0,replace:!0})};return F(d,()=>{g.get(route("admin.customers.audit-logs",m.customer.id),d.value,{preserveState:!0,replace:!0})},{deep:!0}),(l,e)=>(r(),z(T,null,{header:u(()=>[t("div",P,[t("div",null,[t("h2",R," Audit Logs: "+a(s.customer.name),1),e[1]||(e[1]=t("p",{class:"mt-1 text-sm text-gray-500"}," Complete change history for this customer ",-1))]),t("div",U,[c(f,{onClick:w},{default:u(()=>e[2]||(e[2]=[p("Back to All Logs")])),_:1}),c(V,{onClick:C},{default:u(()=>e[3]||(e[3]=[p("Refresh")])),_:1})])])]),default:u(()=>{var v;return[t("div",q,[t("div",M,[s.status||s.success||s.error?(r(),i("div",$,[s.status?(r(),i("div",I,a(s.status),1)):n("",!0),s.success?(r(),i("div",W,a(s.success),1)):n("",!0),s.error?(r(),i("div",G,a(s.error),1)):n("",!0)])):n("",!0),t("div",J,[t("div",K,[t("div",null,[e[4]||(e[4]=t("label",{class:"block font-medium text-gray-700"},"Customer Type",-1)),t("p",Q,a(s.customer.customer_category),1)]),t("div",null,[e[5]||(e[5]=t("label",{class:"block font-medium text-gray-700"},"Field Locking",-1)),t("p",{class:x(["mt-0.5",s.customer.critical_fields_locked?"text-amber-600":"text-green-600"])},a(s.customer.critical_fields_locked?"Locked":"Editable"),3)]),t("div",null,[e[6]||(e[6]=t("label",{class:"block font-medium text-gray-700"},"Delivery History",-1)),t("p",{class:x(["mt-0.5",s.customer.has_delivery_history?"text-blue-600":"text-gray-600"])},a(s.customer.has_delivery_history?"Has History":"No History"),3)]),t("div",null,[e[7]||(e[7]=t("label",{class:"block font-medium text-gray-700"},"Total Changes",-1)),t("p",X,a(s.auditLogs.total||0),1)])])]),t("div",Y,[t("div",Z,[t("div",tt,[c(A,{for:"change_type",value:"Filter by Change Type",class:"text-sm"}),c(N,{id:"change_type",modelValue:d.value.change_type,"onUpdate:modelValue":e[0]||(e[0]=o=>d.value.change_type=o),options:_.value,"option-value":"value","option-label":"text",placeholder:"All Types",class:"mt-1 block w-full text-sm"},null,8,["modelValue","options"])]),t("div",null,[c(f,{onClick:L,class:"text-sm"},{default:u(()=>e[8]||(e[8]=[p("Reset Filters")])),_:1})])])]),t("div",et,[t("div",st,[t("div",at,[(r(!0),i(H,null,O(s.auditLogs.data,o=>(r(),i("div",{key:o.id,class:"border border-gray-200 rounded-lg p-3"},[t("div",ot,[t("div",lt,[t("span",{class:x(["px-2 py-0.5 rounded-full text-xs font-medium capitalize",b(o.change_type)])},a(y(o.change_type)),3),t("span",rt,a(k(o.created_at)),1)]),o.changed_by?(r(),i("div",it,[t("p",dt,a(o.changed_by.name),1),t("p",nt,a(o.changed_by.email),1)])):(r(),i("div",ct,e[9]||(e[9]=[t("p",{class:"text-xs text-gray-400"},"System",-1)])))]),t("div",ut,[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-xs font-medium text-gray-500"},"Field Changed",-1)),t("p",mt,a(o.field_name.replace("_"," ")),1)]),t("div",gt,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-xs font-medium text-gray-500"},"Old Value",-1)),t("p",xt,a(o.old_value||"Empty"),1)]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-xs font-medium text-gray-500"},"New Value",-1)),t("p",pt,a(o.new_value||"Empty"),1)])])]),o.change_reason?(r(),i("div",yt,[e[13]||(e[13]=t("label",{class:"block text-xs font-medium text-gray-500"},"Reason",-1)),t("p",ht,a(o.change_reason),1)])):n("",!0)]))),128))]),((v=s.auditLogs.links)==null?void 0:v.length)>3?(r(),i("div",vt,[c(j,{pagination:s.auditLogs,onPageChanged:S},null,8,["pagination"])])):n("",!0),s.auditLogs.data.length===0?(r(),i("div",ft,[t("div",_t,[e[14]||(e[14]=t("svg",{class:"h-10 w-10 text-gray-400 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e[15]||(e[15]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No audit logs found",-1)),t("p",bt,a(d.value.change_type?"Try adjusting your filters":"No changes recorded for this customer yet"),1)])])):n("",!0)])])])])]}),_:1}))}},Et=D(kt,[["__scopeId","data-v-8a49855c"]]);export{Et as default};
