import{E as $}from"./EmployeeLayout-CIwV2LFp.js";import{_ as S}from"./PrimaryButton-H84cxS-1.js";import{_ as L}from"./SecondaryButton--u4JNCYW.js";import{_ as f}from"./InputLabel-DFMv_Bau.js";import{T as v}from"./TextInput-Y0uxaz16.js";import{S as P}from"./SelectInput-HDzyvJLT.js";import{_ as q}from"./DataTable-1yjRkP_i.js";import{P as M}from"./Pagination-BU1iQEyv.js";import{g as x,i as O,h as A,W as g,d as R,o as i,w as d,b as e,c,e as _,t as n,a as l,f as h,n as W}from"./app-DfDxEqBg.js";import{l as H}from"./lodash-CJ_Ol3CV.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-Dm252fTo.js";import"./DangerButton-CCeglgOy.js";/* empty css                                                                  */const J={class:"flex justify-between items-center w-full px-6 md:px-8"},K={class:"flex gap-2"},Q={class:"zoom-content"},X={class:"px-6 py-4"},Y={key:0,class:"mb-4"},Z={key:0,class:"p-3 bg-blue-100 text-blue-800 rounded"},ee={key:1,class:"p-3 bg-green-100 text-green-800 rounded"},te={key:2,class:"p-3 bg-red-100 text-red-800 rounded"},se={class:"mb-6 bg-white p-4 rounded-lg shadow-sm border"},ae={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},oe={class:"mt-4 flex justify-end space-x-2"},le={class:"justify-center flex items-center"},re={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-full max-w-[95vw]"},de={class:"p-4 bg-white border-b border-gray-200"},ne={class:"flex items-center space-x-3"},ie={class:"font-medium text-gray-900"},ce={class:"text-sm text-gray-500"},ue={class:"space-y-1"},me={class:"font-medium text-gray-900 capitalize"},pe={class:"text-sm"},ge={class:"text-red-600 line-through"},_e={class:"text-green-600"},fe={key:0},he={class:"font-medium text-gray-900"},ye={class:"text-sm text-gray-500"},ve={key:1,class:"text-gray-400"},xe={class:"text-sm text-gray-900"},be={class:"flex space-x-2"},ke={class:"text-center py-8"},Ce={class:"bg-gray-50 rounded-lg p-6 max-w-md mx-auto"},we={class:"text-gray-500 mb-3"},Ve={key:0,class:"mt-4"},Te={__name:"Index",props:{auditLogs:Object,filters:Object,changeTypes:Array,status:String,success:String,error:String},setup(r){var k,C,w,V;const u=r,o=x({search:((k=u.filters)==null?void 0:k.search)||"",change_type:((C=u.filters)==null?void 0:C.change_type)||"",date_from:((w=u.filters)==null?void 0:w.date_from)||"",date_to:((V=u.filters)==null?void 0:V.date_to)||""}),m=x("created_at"),p=x("desc"),j=O(()=>{const a=[{value:"",text:"All Types"}];return u.changeTypes.forEach(t=>{a.push({value:t,text:b(t)})}),a}),D=[{field:"customer",header:"Customer",sortable:!0},{field:"change_type",header:"Change Type",sortable:!0},{field:"changes",header:"Field Changes",sortable:!1},{field:"changed_by",header:"Changed By",sortable:!0},{field:"created_at",header:"Date & Time",sortable:!0},{field:"actions",header:"Actions",sortable:!1}],b=a=>({customer_update:"Customer Update",admin_update:"Admin Update",auto_locked:"Auto Locked",approved_request:"Approved Request"})[a]||a,E=a=>({customer_update:"bg-blue-100 text-blue-800",admin_update:"bg-purple-100 text-purple-800",auto_locked:"bg-amber-100 text-amber-800",approved_request:"bg-green-100 text-green-800"})[a]||"bg-gray-100 text-gray-800",F=a=>new Date(a).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),N=a=>{m.value=a.field,p.value=a.direction},U=a=>{g.get(route("admin.customer-audit-logs.index"),{page:a,...o.value,sort_field:m.value,sort_direction:p.value},{preserveState:!0,preserveScroll:!0,replace:!0})},y=()=>{g.get(route("admin.customer-audit-logs.index"),{...o.value},{preserveState:!0,replace:!0})},B=()=>{o.value={search:"",change_type:"",date_from:"",date_to:""},y()},z=()=>{g.reload({only:["auditLogs"]})},I=a=>{g.get(route("admin.customers.audit-logs",a))};return A(o,H.debounce(()=>{y()},500),{deep:!0}),A([m,p],()=>{g.get(route("admin.customer-audit-logs.index"),{...o.value,sort_field:m.value,sort_direction:p.value},{preserveState:!0,replace:!0})}),(a,t)=>(i(),R($,null,{header:d(()=>[e("div",J,[t[5]||(t[5]=e("div",null,[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Customer Profile Audit Logs"),e("p",{class:"mt-1 text-sm text-gray-500"}," Track and monitor all customer profile changes ")],-1)),e("div",K,[l(S,{onClick:z},{default:d(()=>t[4]||(t[4]=[h("Refresh")])),_:1})])])]),default:d(()=>{var T;return[e("div",Q,[e("div",X,[r.status||r.success||r.error?(i(),c("div",Y,[r.status?(i(),c("div",Z,n(r.status),1)):_("",!0),r.success?(i(),c("div",ee,n(r.success),1)):_("",!0),r.error?(i(),c("div",te,n(r.error),1)):_("",!0)])):_("",!0),e("div",se,[e("div",ae,[e("div",null,[l(f,{for:"search",value:"Search Customer"}),l(v,{id:"search",type:"text",class:"mt-1 block w-full",modelValue:o.value.search,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.search=s),placeholder:"Name, email, company..."},null,8,["modelValue"])]),e("div",null,[l(f,{for:"change_type",value:"Change Type"}),l(P,{id:"change_type",modelValue:o.value.change_type,"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.change_type=s),options:j.value,"option-value":"value","option-label":"text",placeholder:"All Types",class:"mt-1 block w-full"},null,8,["modelValue","options"])]),e("div",null,[l(f,{for:"date_from",value:"From Date"}),l(v,{id:"date_from",type:"date",class:"mt-1 block w-full",modelValue:o.value.date_from,"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.date_from=s)},null,8,["modelValue"])]),e("div",null,[l(f,{for:"date_to",value:"To Date"}),l(v,{id:"date_to",type:"date",class:"mt-1 block w-full",modelValue:o.value.date_to,"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.date_to=s)},null,8,["modelValue"])])]),e("div",oe,[l(L,{onClick:B},{default:d(()=>t[6]||(t[6]=[h("Reset Filters")])),_:1}),l(S,{onClick:y},{default:d(()=>t[7]||(t[7]=[h("Apply Filters")])),_:1})])]),e("div",le,[e("div",re,[e("div",de,[l(q,{columns:D,data:r.auditLogs.data,"sort-field":m.value,"sort-direction":p.value,onSort:N,class:"w-full"},{customer:d(({row:s})=>[e("div",ne,[e("div",null,[e("p",ie,n(s.customer.name),1),e("p",ce,n(s.customer.email),1)])])]),change_type:d(({row:s})=>[e("span",{class:W(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize",E(s.change_type)])},n(b(s.change_type)),3)]),changes:d(({row:s})=>[e("div",ue,[e("div",me,n(s.field_name.replace("_"," ")),1),e("div",pe,[e("span",ge,n(s.old_value||"Empty"),1),t[8]||(t[8]=e("span",{class:"mx-2 text-gray-400"},"â†’",-1)),e("span",_e,n(s.new_value||"Empty"),1)])])]),changed_by:d(({row:s})=>[s.changed_by?(i(),c("div",fe,[e("p",he,n(s.changed_by.name),1),e("p",ye,n(s.changed_by.email),1)])):(i(),c("span",ve,"System"))]),created_at:d(({row:s})=>[e("div",xe,n(F(s.created_at)),1)]),actions:d(({row:s})=>[e("div",be,[l(L,{onClick:Se=>I(s.customer_id),class:"text-xs py-1 px-2"},{default:d(()=>t[9]||(t[9]=[h(" View All ")])),_:2},1032,["onClick"])])]),empty:d(()=>[e("div",ke,[e("div",Ce,[t[10]||(t[10]=e("svg",{class:"h-10 w-10 text-gray-400 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t[11]||(t[11]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No audit logs found",-1)),e("p",we,n(o.value.search?"Try adjusting your search terms":"No profile changes recorded yet"),1)])])]),_:1},8,["data","sort-field","sort-direction"]),((T=r.auditLogs.links)==null?void 0:T.length)>3?(i(),c("div",Ve,[l(M,{pagination:r.auditLogs,onPageChanged:U},null,8,["pagination"])])):_("",!0)])])])])])]}),_:1}))}},Me=G(Te,[["__scopeId","data-v-c0ebbdb7"]]);export{Me as default};
