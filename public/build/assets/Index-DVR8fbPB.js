import{g as _,i as K,h as Q,W as f,d as X,o as d,w as l,b as s,a as i,c as v,e as p,t as n,f as u,u as j,n as Y,k as Z}from"./app-DV6QGe5n.js";import{E as ee}from"./EmployeeLayout-iir4z3Zz.js";import{_ as N}from"./PrimaryButton-D1QT-SsD.js";import{_ as M}from"./SecondaryButton-Cs3_kGiW.js";import{D as B}from"./DangerButton-vX3ciNPD.js";import{_ as te}from"./SearchInput-0z3jiYwM.js";import{S as se}from"./SelectInput-oxDmFdQg.js";import{_ as ae}from"./DataTable-BvTR-QKR.js";import{M as le}from"./Modal-BHxmLOSx.js";import{P as ne}from"./Pagination-C1DXSjd8.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as oe}from"./TruckIcon-mNbyQtUp.js";import{r as ie}from"./ExclamationTriangleIcon-pXiqXvQ5.js";import"./NavLink-sW0XPEdd.js";const ue={class:"flex justify-between items-center w-full px-6 md:px-8"},ce={class:"flex gap-2"},de={class:"zoom-content"},me={class:"px-6 py-4"},ve={key:0,class:"mb-4"},ge={key:0,class:"p-3 bg-blue-100 text-blue-800 rounded"},fe={key:1,class:"p-3 bg-green-100 text-green-800 rounded"},be={key:2,class:"p-3 bg-red-100 text-red-800 rounded"},xe={class:"mb-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3"},_e={class:"w-full sm:w-96"},pe={class:"flex items-center gap-3"},ke={class:"text-sm text-gray-500 bg-blue-50 px-3 py-1 rounded border border-blue-100 whitespace-nowrap"},he={key:0,class:"ml-1"},ye={class:"justify-center flex items-center"},we={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-full max-w-[95vw]"},Ce={class:"p-4 bg-white border-b border-gray-200"},Se={class:"font-medium text-gray-900"},Ae={class:"text-gray-700"},Te={class:"text-gray-700"},Ne={class:"flex items-center"},Me={class:"text-gray-700"},De={class:"text-gray-600"},Le={class:"flex space-x-2"},$e={class:"text-center py-8"},Pe={class:"bg-gray-50 rounded-lg p-6 max-w-md mx-auto"},Ue={class:"text-gray-500 mb-3"},Ve={key:0,class:"mt-4"},Ie={class:"p-5"},je={class:"text-lg font-medium text-gray-900"},Be={key:0,class:"mt-1"},Ee={class:"p-3 bg-red-50 border border-red-200 rounded-md"},Fe={class:"flex items-center"},ze={class:"mt-2 text-sm text-red-600"},Re={class:"font-semibold"},We={key:1,class:"mt-1 text-sm text-gray-600"},Oe={class:"mt-4 flex justify-end space-x-3"},Ge={key:0},qe={key:1},He={__name:"Index",props:{trucks:Object,status:String,success:String,error:String},setup(r){var $,P,U,V;const y=r,S=_(!1),m=_(null),C=_(!1),g=_((($=y.trucks.filters)==null?void 0:$.search)||""),b=_(((P=y.trucks.filters)==null?void 0:P.status)||""),x=_(((U=y.trucks.filters)==null?void 0:U.sort_field)||"license_plate"),k=_(((V=y.trucks.filters)==null?void 0:V.sort_direction)||"asc"),E=[{value:"",text:"All Statuses"},{value:"available",text:"Available"},{value:"unavailable",text:"Unavailable"},{value:"maintenance",text:"Maintenance"}],F={available:"bg-green-100 text-green-800",unavailable:"bg-gray-100 text-gray-800",maintenance:"bg-red-100 text-red-800",assigned:"bg-blue-100 text-blue-800",in_transit:"bg-purple-100 text-purple-800",returning:"bg-orange-100 text-orange-800",nearly_full:"bg-yellow-100 text-yellow-800",available_for_backhaul:"bg-green-100 text-green-800",cooldown:"bg-blue-100 text-blue-800"},z=[{field:"license_plate",header:"License Plate",sortable:!0},{field:"make",header:"Make",sortable:!0},{field:"model",header:"Model",sortable:!0},{field:"volume_capacity",header:"Volume Capacity",sortable:!0},{field:"weight_capacity",header:"Weight Capacity",sortable:!0},{field:"region.name",header:"Region",sortable:!0},{field:"status",header:"Status",sortable:!0},{field:"last_maintenance_date",header:"Last Maintenance",sortable:!0},{field:"actions",header:"Actions",sortable:!1}],A=K(()=>(y.trucks.data||[]).filter(t=>{var o,c,I;const h=g.value===""||((o=t.license_plate)==null?void 0:o.toLowerCase().includes(g.value.toLowerCase()))||((c=t.make)==null?void 0:c.toLowerCase().includes(g.value.toLowerCase()))||((I=t.model)==null?void 0:I.toLowerCase().includes(g.value.toLowerCase())),e=!b.value||t.status===b.value;return h&&e}).sort((t,h)=>{const e=k.value==="asc"?1:-1;let o=t[x.value],c=h[x.value];return o==null&&(o=""),c==null&&(c=""),o=String(o).toLowerCase(),c=String(c).toLowerCase(),o<c?-1*e:o>c?1*e:0})),D=a=>a&&!["available","unavailable","maintenance"].includes(a)?"In Use":{available:"Available",unavailable:"Unavailable",maintenance:"Maintenance",assigned:"Assigned",in_transit:"In Transit",returning:"Returning",nearly_full:"Nearly Full",available_for_backhaul:"Available for Backhaul",cooldown:"Cooldown"}[a]||(a==null?void 0:a.replace(/_/g," "))||"N/A",w=a=>a?["assigned","in_transit","returning","nearly_full","available_for_backhaul","cooldown"].includes(a.status):!1,R=a=>{x.value=a.field,k.value=a.direction},W=a=>{f.get(route("admin.trucks.index"),{page:a,search:g.value,status:b.value,sort_field:x.value,sort_direction:k.value},{preserveState:!0,preserveScroll:!0,replace:!0})},O=a=>{m.value=a,S.value=!0},T=()=>{S.value=!1,m.value=null,C.value=!1},G=()=>{!m.value||w(m.value)||(C.value=!0,f.put(route("admin.trucks.archive",m.value.id),{},{preserveScroll:!0,onSuccess:()=>f.reload({only:["trucks"]}),onError:()=>alert("Failed to disable truck"),onFinish:()=>T()}))},L=()=>f.get(route("admin.trucks.create")),q=a=>f.get(route("admin.trucks.show",a)),H=a=>f.get(route("admin.trucks.edit",a)),J=()=>f.get(route("admin.trucks.archived"));return Q([g,b,x,k],()=>{f.get(route("admin.trucks.index"),{search:g.value,status:b.value,sort_field:x.value,sort_direction:k.value,page:1},{preserveState:!0,replace:!0})},{deep:!0}),(a,t)=>(d(),X(ee,null,{header:l(()=>[s("div",ue,[t[4]||(t[4]=s("div",null,[s("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Truck Management"),s("p",{class:"mt-1 text-sm text-gray-500"}," Manage active trucks and their assignments ")],-1)),s("div",ce,[i(M,{onClick:J},{default:l(()=>t[2]||(t[2]=[u("View Disabled Trucks")])),_:1}),i(N,{onClick:L},{default:l(()=>t[3]||(t[3]=[u("Add New Truck")])),_:1})])])]),default:l(()=>{var h;return[s("div",de,[s("div",me,[r.status||r.success||r.error?(d(),v("div",ve,[r.status?(d(),v("div",ge,n(r.status),1)):p("",!0),r.success?(d(),v("div",fe,n(r.success),1)):p("",!0),r.error?(d(),v("div",be,n(r.error),1)):p("",!0)])):p("",!0),s("div",xe,[s("div",_e,[i(te,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),placeholder:"Search trucks by license plate, make, or model...",class:"w-full"},null,8,["modelValue"])]),s("div",pe,[i(se,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=e=>b.value=e),options:E,"option-value":"value","option-label":"text",placeholder:"All Statuses",class:"w-full sm:w-48"},null,8,["modelValue"]),s("div",ke,[u(" ðŸ“‹ Showing "+n(A.value.length)+" active "+n(A.value.length===1?"truck":"trucks")+" ",1),r.trucks.data&&r.trucks.data.length<r.trucks.total?(d(),v("span",he," (Page "+n(r.trucks.current_page)+" of "+n(r.trucks.last_page)+") ",1)):p("",!0)])])]),s("div",ye,[s("div",we,[s("div",Ce,[i(ae,{columns:z,data:A.value,"sort-field":x.value,"sort-direction":k.value,onSort:R,class:"w-full"},{license_plate:l(({row:e})=>[s("span",Se,n(e.license_plate||"N/A"),1)]),make:l(({row:e})=>[s("span",Ae,n(e.make||"N/A"),1)]),model:l(({row:e})=>[s("span",Te,n(e.model||"N/A"),1)]),volume_capacity:l(({row:e})=>[u(n(e.volume_capacity?`${e.volume_capacity} mÂ³`:"N/A"),1)]),weight_capacity:l(({row:e})=>[u(n(e.weight_capacity?`${e.weight_capacity} kg`:"N/A"),1)]),"region.name":l(({row:e})=>[s("div",Ne,[e.region&&e.region.color_hex?(d(),v("div",{key:0,class:"w-3 h-3 rounded-full mr-2 border border-gray-300",style:Z({backgroundColor:e.region.color_hex})},null,4)):p("",!0),s("span",Me,n(e.region&&e.region.name?e.region.name:"N/A"),1)])]),status:l(({row:e})=>[s("span",{class:Y(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize",e.status&&!["available","unavailable","maintenance"].includes(e.status)?"bg-yellow-100 text-yellow-800":F[e.status]])},n(D(e.status)),3)]),last_maintenance_date:l(({row:e})=>[s("span",De,n(e.last_maintenance_date||"Never"),1)]),actions:l(({row:e})=>[s("div",Le,[i(M,{onClick:o=>q(e.id),class:"text-xs py-1 px-2"},{default:l(()=>t[5]||(t[5]=[u("View")])),_:2},1032,["onClick"]),i(N,{onClick:o=>H(e.id),class:"text-xs py-1 px-2"},{default:l(()=>t[6]||(t[6]=[u("Edit")])),_:2},1032,["onClick"]),i(B,{onClick:o=>O(e),class:"text-xs py-1 px-2",disabled:w(e)},{default:l(()=>t[7]||(t[7]=[u(" Disable ")])),_:2},1032,["onClick","disabled"])])]),empty:l(()=>[s("div",$e,[s("div",Pe,[i(j(oe),{class:"h-10 w-10 text-gray-400 mx-auto mb-3"}),t[9]||(t[9]=s("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No active trucks found",-1)),s("p",Ue,n(g.value?"Try adjusting your search terms":"Get started by adding your first truck"),1),i(N,{onClick:L},{default:l(()=>t[8]||(t[8]=[u("Add New Truck")])),_:1})])])]),_:1},8,["data","sort-field","sort-direction"]),((h=r.trucks.links)==null?void 0:h.length)>3?(d(),v("div",Ve,[i(ne,{pagination:r.trucks,onPageChanged:W},null,8,["pagination"])])):p("",!0)])])])])]),i(le,{show:S.value,onClose:T},{default:l(()=>{var e,o,c;return[s("div",Ie,[s("h2",je,n(w(m.value)?"Cannot Disable Truck":"Disable Truck?"),1),w(m.value)?(d(),v("div",Be,[s("div",Ee,[s("div",Fe,[i(j(ie),{class:"h-5 w-5 text-red-400 mr-2"}),t[10]||(t[10]=s("p",{class:"text-sm font-medium text-red-800"},"Truck is currently in use",-1))]),s("p",ze,[s("strong",null,n((e=m.value)==null?void 0:e.license_plate),1),t[11]||(t[11]=u(" cannot be disabled because it is currently ")),s("span",Re,n(D((o=m.value)==null?void 0:o.status)),1),t[12]||(t[12]=u(". Please wait until the truck becomes available before disabling it. "))])])])):(d(),v("p",We,[t[13]||(t[13]=u(" Are you sure you want to disable ")),s("strong",null,n((c=m.value)==null?void 0:c.license_plate),1),t[14]||(t[14]=u("? This will move it to the disabled trucks list. "))])),s("div",Oe,[i(M,{onClick:T},{default:l(()=>t[15]||(t[15]=[u("Cancel")])),_:1}),i(B,{onClick:G,disabled:C.value||w(m.value)},{default:l(()=>[C.value?(d(),v("span",Ge,"Processing...")):(d(),v("span",qe,"Disable Truck"))]),_:1},8,["disabled"])])])]}),_:1},8,["show"])]}),_:1}))}},it=re(He,[["__scopeId","data-v-fe663eb7"]]);export{it as default};
