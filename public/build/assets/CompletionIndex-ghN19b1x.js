import{g as be,p as ke,i as Ce,d as $,o as i,w as g,b as e,c as o,e as u,n as z,f as p,t as r,a as x,q as Oe,F as re,r as ie,u as le,W as D}from"./app-AKIpI5kC.js";import{E as Se}from"./EmployeeLayout-BOs8DfTq.js";import{_ as Ne}from"./SearchInput-CeYc0t6l.js";import{S as qe}from"./SelectInput-Cl2C_FMi.js";import{_ as B}from"./SecondaryButton-piyuntTR.js";import{_ as je}from"./PrimaryButton-C4c8jBYk.js";import{_ as I}from"./StatusBadge-CZj25irX.js";import{P as oe}from"./Pagination-q83q6DZI.js";import{r as De}from"./CheckCircleIcon-C7POROO0.js";import{r as Re}from"./ArchiveBoxIcon-CyyJZiKi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-BIDGqMa0.js";import"./DangerButton-ttTomH3t.js";const Pe={class:"py-6 px-2 md:px-6 w-full max-w-[95rem] mx-auto"},Ae={class:"bg-white shadow-sm rounded-lg border border-gray-200 mb-6 w-full"},Ve={class:"border-b border-gray-200"},Te={class:"-mb-px flex space-x-8 px-6"},$e={class:"ml-2 bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium"},ze={class:"ml-2 bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium"},Le={class:"p-4 border-b border-gray-200"},Ue={class:"flex flex-col lg:flex-row gap-4"},Be={class:"flex-1"},Ie={class:"sm:w-48"},Ee={class:"flex items-center gap-2"},Fe={class:"flex justify-between items-center mt-4"},Me={class:"text-sm text-gray-500"},Ke={key:0,class:"ml-2"},We={key:1,class:"ml-2"},He={key:0},Ge={class:"bg-white shadow-sm rounded-lg overflow-hidden border border-gray-200 w-full"},Je={class:"px-4 py-5 sm:px-6 border-b border-gray-200"},Qe={class:"flex justify-between items-center"},Xe={class:"text-sm text-gray-500"},Ye={class:"overflow-x-auto"},Ze={class:"min-w-full divide-y divide-gray-200"},et={class:"bg-white divide-y divide-gray-200"},tt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},st={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},nt={class:"text-xs text-gray-400"},at={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},rt={class:"px-6 py-4 whitespace-nowrap"},it={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},lt={class:"space-y-1"},ot={class:"flex items-center space-x-1"},dt={class:"font-medium"},ct={class:"flex flex-wrap gap-1 text-xs"},ut={key:0,class:"text-green-600 bg-green-50 px-1 rounded"},pt={key:1,class:"text-orange-600 bg-orange-50 px-1 rounded"},xt={key:2,class:"text-red-600 bg-red-50 px-1 rounded"},mt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},gt={class:"capitalize"},ft={class:"px-6 py-4 whitespace-nowrap text-sm"},yt={key:1,class:"inline-flex px-2 text-xs font-semibold leading-5 rounded-full bg-yellow-100 text-yellow-800"},ht={key:2,class:"text-gray-400 text-xs"},_t={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},vt={class:"flex justify-end space-x-2"},wt={key:1},bt={colspan:"8",class:"px-6 py-4 text-center text-sm text-gray-500"},kt={class:"text-center py-12"},Ct={key:1},Ot={class:"bg-white shadow-sm rounded-lg overflow-hidden border border-gray-200 w-full"},St={class:"px-4 py-5 sm:px-6 border-b border-gray-200"},Nt={class:"flex justify-between items-center"},qt={class:"text-sm text-gray-500"},jt={class:"overflow-x-auto"},Dt={class:"min-w-full divide-y divide-gray-200"},Rt={class:"bg-white divide-y divide-gray-200"},Pt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},At={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Vt={class:"text-xs text-gray-400"},Tt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},$t={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},zt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Lt={class:"space-y-1"},Ut={class:"flex items-center space-x-1"},Bt={class:"font-medium"},It={class:"flex flex-wrap gap-1 text-xs"},Et={key:0,class:"text-green-600 bg-green-50 px-1 rounded"},Ft={key:1,class:"text-orange-600 bg-orange-50 px-1 rounded"},Mt={key:2,class:"text-red-600 bg-red-50 px-1 rounded"},Kt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Wt={class:"px-6 py-4 whitespace-nowrap text-sm"},Ht={key:1,class:"inline-flex px-2 text-xs font-semibold leading-5 rounded-full bg-yellow-100 text-yellow-800"},Gt={key:2,class:"text-gray-400 text-xs"},Jt={key:1},Qt={colspan:"7",class:"px-6 py-4 text-center text-sm text-gray-500"},Xt={class:"text-center py-12"},us={__name:"CompletionIndex",props:{pendingOrders:Object,completedOrders:Object,stats:Object,filters:Object},setup(d){var J,Q,X;const f=d,m=be(((J=f.filters)==null?void 0:J.tab)||"pending"),c=ke({search:((Q=f.filters)==null?void 0:Q.search)||"",status:((X=f.filters)==null?void 0:X.status)||""}),de=Ce(()=>[{value:"",label:"All Status"},{value:"delivered",label:"Delivered"},{value:"needs_review",label:"Needs Review"},{value:"completed",label:"Completed"}]);function ce(){var s,t,a,l;switch(m.value){case"pending":return((t=(s=f.pendingOrders)==null?void 0:s.data)==null?void 0:t.length)||0;case"completed":return((l=(a=f.completedOrders)==null?void 0:a.data)==null?void 0:l.length)||0;default:return 0}}function ue(){return m.value==="pending"?"pending orders":"completed orders"}function E(s){m.value=s,y()}function y(){const s={tab:m.value,...c};Object.keys(s).forEach(t=>{(s[t]===""||s[t]===null)&&delete s[t]}),D.visit(route("delivery-completion.ready-for-completion"),{data:s,preserveState:!0,preserveScroll:!0,replace:!0})}let F=null;function pe(){clearTimeout(F),F=setTimeout(()=>{(c.search===""||c.search.length>=3)&&y()},500)}function xe(){Object.keys(c).forEach(s=>{c[s]=""}),y()}function me(){D.reload({only:["pendingOrders","completedOrders","stats"],preserveScroll:!0})}function M(s,t){if(s>=1&&s<=ge(t)){const a={tab:m.value,...c};t==="pending"?a.pending_page=s:t==="completed"&&(a.completed_page=s),Object.keys(a).forEach(l=>{(a[l]===""||a[l]===null)&&delete a[l]}),D.visit(route("delivery-completion.ready-for-completion"),{data:a,preserveState:!0,preserveScroll:!0})}}function ge(s){var t,a,l,h;switch(s){case"pending":return((a=(t=f.pendingOrders)==null?void 0:t.meta)==null?void 0:a.last_page)||1;case"completed":return((h=(l=f.completedOrders)==null?void 0:l.meta)==null?void 0:h.last_page)||1;default:return 1}}function fe(s){return{delivered:"Delivered",needs_review:"Needs Review",completed:"Completed"}[s]||s}function ye(s){D.visit(route("delivery-completion.show-form",{order:s}))}function he(s){D.visit(route("refunds.show",{refund:s}))}function L(s){return s?s.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):"UNKNOWN"}function _e(s){return{delivered:"success",needs_review:"warning",completed:"info",partially_delivered:"warning",pending:"warning",in_transit:"info",cancelled:"danger"}[s]||"secondary"}function K(s){return{paid:"success",unpaid:"danger",pending:"warning",awaiting_payment:"warning",refunded:"info",requires_adjustment:"warning",cancelled:"danger",verified:"success",rejected:"danger",pending_verification:"warning"}[s]||"secondary"}function R(s){var t,a;return((a=(t=s.delivery_request)==null?void 0:t.packages)==null?void 0:a.filter(l=>l.status==="delivered").length)||0}function P(s){var t,a;return((a=(t=s.delivery_request)==null?void 0:t.packages)==null?void 0:a.filter(l=>l.status==="damaged_in_transit").length)||0}function A(s){var t,a;return((a=(t=s.delivery_request)==null?void 0:t.packages)==null?void 0:a.filter(l=>l.status==="lost_in_transit").length)||0}function V(s){var t,a;return((a=(t=s.delivery_request)==null?void 0:t.refunds)==null?void 0:a.length)>0}function W(s){var t;return s.status==="needs_review"&&((t=s.delivery_request)==null?void 0:t.payment_type)==="prepaid"&&!V(s)}function U(s){var a,l;const t=(l=(a=s.delivery_request)==null?void 0:a.refunds)==null?void 0:l[0];return t?typeof t.status=="string"?t.status.charAt(0).toUpperCase()+t.status.slice(1):t.status_label||"":""}function H(s){var t,a,l;return(l=(a=(t=s.delivery_request)==null?void 0:t.refunds)==null?void 0:a[0])==null?void 0:l.id}function G(s){const t=U(s).toLowerCase();return{pending:"bg-yellow-100 text-yellow-800",processed:"bg-green-100 text-green-800",adjusted:"bg-blue-100 text-blue-800"}[t]||"bg-gray-100 text-gray-800"}function ve(s){if(!s)return"N/A";try{const t=new Date(s);return isNaN(t.getTime())?"Invalid Date":t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("Date formatting error:",t),"Invalid Date"}}function we(s){return s.completed_at||s.updated_at||s.created_at}return(s,t)=>(i(),$(Se,null,{header:g(()=>t[6]||(t[6]=[e("div",{class:"flex flex-wrap justify-between items-center gap-4 px-4 md:px-6 w-full"},[e("div",null,[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Delivery Completion "),e("p",{class:"text-sm text-gray-600 mt-1"}," Process delivery outcomes and handle package releases. ")])],-1)])),default:g(()=>{var a,l,h,Y,Z,ee,te,se,ne,ae;return[e("div",Pe,[e("div",Ae,[e("div",Ve,[e("nav",Te,[e("button",{onClick:t[0]||(t[0]=n=>E("pending")),class:z(["py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 flex items-center",m.value==="pending"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[t[7]||(t[7]=p(" ⏳ Pending Completion ")),e("span",$e,r(d.stats.pending_total||0),1)],2),e("button",{onClick:t[1]||(t[1]=n=>E("completed")),class:z(["py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 flex items-center",m.value==="completed"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[t[8]||(t[8]=p(" ✅ Completed Orders ")),e("span",ze,r(d.stats.completed_total||0),1)],2)])]),e("div",Le,[e("div",Ue,[e("div",Be,[x(Ne,{modelValue:c.search,"onUpdate:modelValue":t[2]||(t[2]=n=>c.search=n),placeholder:"Search by reference number or sender...",onKeyup:Oe(y,["enter"]),onInput:pe,class:"w-full"},null,8,["modelValue"])]),e("div",Ie,[x(qe,{modelValue:c.status,"onUpdate:modelValue":t[3]||(t[3]=n=>c.status=n),options:de.value,placeholder:"All Status",onChange:y},null,8,["modelValue","options"])]),e("div",Ee,[x(B,{onClick:me},{default:g(()=>t[9]||(t[9]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),p(" Refresh ")])),_:1}),x(B,{onClick:xe},{default:g(()=>t[10]||(t[10]=[p(" Reset ")])),_:1})])]),e("div",Fe,[e("div",Me,[p(" Showing "+r(ce())+" "+r(ue())+" ",1),c.search?(i(),o("span",Ke,'• "'+r(c.search)+'"',1)):u("",!0),c.status?(i(),o("span",We," • "+r(fe(c.status)),1)):u("",!0)])])])]),m.value==="pending"?(i(),o("div",He,[e("div",Ge,[e("div",Je,[e("div",Qe,[t[11]||(t[11]=e("div",null,[e("h3",{class:"text-lg font-medium text-gray-900"}," Pending Completion "),e("p",{class:"mt-1 text-sm text-gray-500"}," Orders that need completion processing ")],-1)),e("div",Xe," Showing "+r(((l=(a=d.pendingOrders)==null?void 0:a.data)==null?void 0:l.length)||0)+" orders ",1)])]),e("div",Ye,[e("table",Ze,[t[15]||(t[15]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reference "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Sender → Receiver "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Driver "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Packages "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Payment "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Refund Status "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",et,[((Y=(h=d.pendingOrders)==null?void 0:h.data)==null?void 0:Y.length)>0?(i(!0),o(re,{key:0},ie(d.pendingOrders.data,n=>{var _,v,w,b,k,C,O,S,N,q,j;return i(),o("tr",{key:n.id,class:"hover:bg-gray-50"},[e("td",tt,r(((_=n.delivery_request)==null?void 0:_.reference_number)||"N/A"),1),e("td",st,[e("div",null,r(((w=(v=n.delivery_request)==null?void 0:v.sender)==null?void 0:w.name)||"N/A"),1),e("div",nt,"→ "+r(((k=(b=n.delivery_request)==null?void 0:b.receiver)==null?void 0:k.name)||"N/A"),1)]),e("td",at,r(((C=n.driver)==null?void 0:C.name)||"Unassigned"),1),e("td",rt,[x(I,{status:n.status,variant:_e(n.status)},{default:g(()=>[p(r(L(n.status)),1)]),_:2},1032,["status","variant"])]),e("td",it,[e("div",lt,[e("div",ot,[e("span",dt,r(((S=(O=n.delivery_request)==null?void 0:O.packages)==null?void 0:S.length)||0)+" total",1)]),e("div",ct,[R(n)>0?(i(),o("span",ut,r(R(n))+" delivered ",1)):u("",!0),P(n)>0?(i(),o("span",pt,r(P(n))+" damaged ",1)):u("",!0),A(n)>0?(i(),o("span",xt,r(A(n))+" lost ",1)):u("",!0)])])]),e("td",mt,[e("div",gt,r(((N=n.delivery_request)==null?void 0:N.payment_type)||"N/A"),1),x(I,{status:(q=n.delivery_request)==null?void 0:q.payment_status,variant:K((j=n.delivery_request)==null?void 0:j.payment_status),size:"xs"},{default:g(()=>{var T;return[p(r(L((T=n.delivery_request)==null?void 0:T.payment_status)),1)]}),_:2},1032,["status","variant"])]),e("td",ft,[V(n)?(i(),o("span",{key:0,class:z([G(n),"inline-flex px-2 text-xs font-semibold leading-5 rounded-full"])},r(U(n)),3)):W(n)?(i(),o("span",yt," Needs Refund ")):(i(),o("span",ht,"No refund"))]),e("td",_t,[e("div",vt,[x(je,{onClick:T=>ye(n.id),size:"xs",class:"flex items-center"},{default:g(()=>t[12]||(t[12]=[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1),p(" Process ")])),_:2},1032,["onClick"]),V(n)&&H(n)?(i(),$(B,{key:0,onClick:T=>he(H(n)),size:"xs",class:"flex items-center"},{default:g(()=>t[13]||(t[13]=[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),p(" View Refund ")])),_:2},1032,["onClick"])):u("",!0)])])])}),128)):(i(),o("tr",wt,[e("td",bt,[e("div",kt,[x(le(De),{class:"h-12 w-12 mx-auto text-gray-400"}),t[14]||(t[14]=e("p",{class:"text-gray-500 mt-2"},"No pending orders found",-1))])])]))])])]),(Z=d.pendingOrders)!=null&&Z.meta&&d.pendingOrders.meta.last_page>1?(i(),$(oe,{key:0,pagination:d.pendingOrders.meta,onPageChanged:t[4]||(t[4]=n=>M(n,"pending")),class:"px-4 py-3"},null,8,["pagination"])):u("",!0)])])):m.value==="completed"?(i(),o("div",Ct,[e("div",Ot,[e("div",St,[e("div",Nt,[t[16]||(t[16]=e("div",null,[e("h3",{class:"text-lg font-medium text-gray-900"}," Completed Orders "),e("p",{class:"mt-1 text-sm text-gray-500"}," Successfully processed deliveries ")],-1)),e("div",qt," Showing "+r(((te=(ee=d.completedOrders)==null?void 0:ee.data)==null?void 0:te.length)||0)+" orders ",1)])]),e("div",jt,[e("table",Dt,[t[18]||(t[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reference "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Sender → Receiver "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Driver "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Completed At "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Packages "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Payment Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Refund Status ")])],-1)),e("tbody",Rt,[((ne=(se=d.completedOrders)==null?void 0:se.data)==null?void 0:ne.length)>0?(i(!0),o(re,{key:0},ie(d.completedOrders.data,n=>{var _,v,w,b,k,C,O,S,N,q;return i(),o("tr",{key:n.id,class:"hover:bg-gray-50"},[e("td",Pt,r(((_=n.delivery_request)==null?void 0:_.reference_number)||"N/A"),1),e("td",At,[e("div",null,r(((w=(v=n.delivery_request)==null?void 0:v.sender)==null?void 0:w.name)||"N/A"),1),e("div",Vt,"→ "+r(((k=(b=n.delivery_request)==null?void 0:b.receiver)==null?void 0:k.name)||"N/A"),1)]),e("td",Tt,r(((C=n.driver)==null?void 0:C.name)||"Unassigned"),1),e("td",$t,r(ve(we(n))),1),e("td",zt,[e("div",Lt,[e("div",Ut,[e("span",Bt,r(((S=(O=n.delivery_request)==null?void 0:O.packages)==null?void 0:S.length)||0)+" total",1)]),e("div",It,[R(n)>0?(i(),o("span",Et,r(R(n))+" delivered ",1)):u("",!0),P(n)>0?(i(),o("span",Ft,r(P(n))+" damaged ",1)):u("",!0),A(n)>0?(i(),o("span",Mt,r(A(n))+" lost ",1)):u("",!0)])])]),e("td",Kt,[x(I,{status:(N=n.delivery_request)==null?void 0:N.payment_status,variant:K((q=n.delivery_request)==null?void 0:q.payment_status)},{default:g(()=>{var j;return[p(r(L((j=n.delivery_request)==null?void 0:j.payment_status)),1)]}),_:2},1032,["status","variant"])]),e("td",Wt,[V(n)?(i(),o("span",{key:0,class:z([G(n),"inline-flex px-2 text-xs font-semibold leading-5 rounded-full"])},r(U(n)),3)):W(n)?(i(),o("span",Ht," Needs Refund ")):(i(),o("span",Gt,"No refund"))])])}),128)):(i(),o("tr",Jt,[e("td",Qt,[e("div",Xt,[x(le(Re),{class:"h-12 w-12 mx-auto text-gray-400"}),t[17]||(t[17]=e("p",{class:"text-gray-500 mt-2"},"No completed orders found",-1))])])]))])])]),(ae=d.completedOrders)!=null&&ae.meta&&d.completedOrders.meta.last_page>1?(i(),$(oe,{key:0,pagination:d.completedOrders.meta,onPageChanged:t[5]||(t[5]=n=>M(n,"completed")),class:"px-4 py-3"},null,8,["pagination"])):u("",!0)])])):u("",!0)])]}),_:1}))}};export{us as default};
