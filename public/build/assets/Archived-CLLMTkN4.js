import{g as y,i as le,h as se,W as C,j as oe,d as ae,o as c,w as a,b as l,a as d,c as p,e as x,t as n,f as h,u as re,k as ne,n as ie,l as de}from"./app-BOCrhSfO.js";import{E as ue}from"./EmployeeLayout-D01AghRc.js";import{_ as R}from"./SecondaryButton-BoCxbQ9w.js";import{D as B}from"./DangerButton-CBhu99um.js";import{_ as ce}from"./SearchInput-g_WCWFPT.js";import{S as O}from"./SelectInput-BaEQ9Gfo.js";import{_ as me}from"./DataTable-C5A94wxb.js";import{M as pe}from"./Modal-Dwgib7t_.js";import{P as fe}from"./Pagination-D3KPnYBN.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as ve}from"./UserGroupIcon-DAY8LawG.js";import"./NavLink-DsrNUkqS.js";const ge={class:"flex justify-between items-center w-full px-6 md:px-8"},xe={class:"flex gap-2"},he={class:"zoom-content"},_e={class:"px-6 py-4"},be={key:0,class:"mb-4"},we={key:0,class:"p-3 bg-blue-100 text-blue-800 rounded"},Ce={key:1,class:"p-3 bg-green-100 text-green-800 rounded"},ke={key:2,class:"p-3 bg-red-100 text-red-800 rounded"},Se={class:"mb-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3"},De={class:"w-full sm:w-96"},Ae={class:"flex items-center gap-3"},Ve={class:"text-sm text-gray-500 bg-blue-50 px-3 py-1 rounded border border-blue-100 whitespace-nowrap"},Ee={key:0,class:"ml-1"},Ne={class:"justify-center flex items-center"},Re={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-full max-w-[95vw]"},Le={class:"p-4 bg-white border-b border-gray-200"},je={class:"flex items-center"},Pe={class:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center mr-3"},Me={class:"text-sm font-medium text-gray-700"},$e={class:"font-medium text-gray-900 block"},Fe={key:0,class:"text-xs text-gray-500 block"},Ie={class:"text-gray-700"},Ue={class:"flex items-center"},ze={class:"text-gray-700"},Be={class:"text-gray-600"},Oe={class:"flex space-x-2"},Te={class:"text-center py-8"},We={class:"bg-gray-50 rounded-lg p-6 max-w-md mx-auto"},qe={class:"text-gray-500 mb-3"},Ge={key:0,class:"mt-4"},He={class:"p-5"},Je={class:"mt-1 text-sm text-gray-600"},Ke={class:"mt-4 flex justify-end space-x-3"},Qe={key:0},Xe={key:1},Ye={__name:"Archived",props:{employees:Object,status:String,success:String,error:String},setup(o){var $,F,I,U,z;const k=o,L=y(!1),D=y(null),N=y(!1),m=y((($=k.employees.filters)==null?void 0:$.search)||""),_=y(((F=k.employees.filters)==null?void 0:F.role)||""),b=y(((I=k.employees.filters)==null?void 0:I.region)||""),f=y(((U=k.employees.filters)==null?void 0:U.sort_field)||"employee_profile.archived_at"),S=y(((z=k.employees.filters)==null?void 0:z.sort_direction)||"desc"),P=y([{value:"",text:"All Regions"}]),T=[{value:"",text:"All Roles"},{value:"admin",text:"Admin"},{value:"staff",text:"Staff"},{value:"driver",text:"Driver"},{value:"collector",text:"Collector"}],W={admin:"bg-purple-100 text-purple-800",staff:"bg-blue-100 text-blue-800",driver:"bg-green-100 text-green-800",collector:"bg-yellow-100 text-yellow-800"},q=[{field:"name",header:"Employee Name",sortable:!0},{field:"email",header:"Email",sortable:!0},{field:"role",header:"Role",sortable:!0},{field:"region.name",header:"Region",sortable:!0},{field:"archived_at",header:"Disabled On",sortable:!0},{field:"status",header:"Status",sortable:!0},{field:"actions",header:"Actions",sortable:!1}];le(()=>(k.employees.data||[]).filter(e=>{var t,r,v,g,A,V,E;const u=m.value===""||((t=e.name)==null?void 0:t.toLowerCase().includes(m.value.toLowerCase()))||((r=e.email)==null?void 0:r.toLowerCase().includes(m.value.toLowerCase()))||((g=(v=e.employee_profile)==null?void 0:v.employee_id)==null?void 0:g.toLowerCase().includes(m.value.toLowerCase())),w=!_.value||e.role===_.value,i=!b.value||((E=(V=(A=e.employee_profile)==null?void 0:A.region)==null?void 0:V.id)==null?void 0:E.toString())===b.value;return u&&w&&i}).sort((e,u)=>{var r,v,g,A,V,E;const w=S.value==="asc"?1:-1;let i=e[f.value],t=u[f.value];return f.value==="region.name"&&(i=(v=(r=e.employee_profile)==null?void 0:r.region)==null?void 0:v.name,t=(A=(g=u.employee_profile)==null?void 0:g.region)==null?void 0:A.name),f.value==="archived_at"&&(i=(V=e.employee_profile)==null?void 0:V.archived_at,t=(E=u.employee_profile)==null?void 0:E.archived_at),i==null&&(i=""),t==null&&(t=""),i=String(i).toLowerCase(),t=String(t).toLowerCase(),i<t?-1*w:i>t?1*w:0}));const G=s=>{if(!s)return"EM";const e=s.split(" ");return e.length>=2?`${e[0].charAt(0)}${e[1].charAt(0)}`.toUpperCase():s.substring(0,2).toUpperCase()},H=s=>s?s.replace(/\b\w/g,e=>e.toUpperCase()):"",J=s=>W[s]||"bg-gray-100 text-gray-800",K=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleDateString()}catch{return"Invalid Date"}},Q=s=>{f.value=s.field,S.value=s.direction},X=s=>{C.get(route("admin.employees.archived"),{page:s,search:m.value,role:_.value,region:b.value,sort_field:f.value,sort_direction:S.value},{preserveState:!0,preserveScroll:!0,replace:!0})},Y=s=>{D.value=s,L.value=!0},j=()=>{L.value=!1,D.value=null,N.value=!1},Z=()=>{D.value&&(N.value=!0,C.delete(route("admin.employees.destroy",D.value.id),{},{preserveScroll:!0,onSuccess:()=>C.reload({only:["employees"]}),onError:()=>alert("Failed to delete employee"),onFinish:()=>j()}))},ee=s=>{C.put(route("admin.employees.restore",s.id),{},{preserveScroll:!0,onSuccess:()=>C.reload({only:["employees"]})})},M=()=>C.get(route("admin.employees.index")),te=async()=>{try{const{data:s}=await de.get("/api/delivery/regions"),e=Array.isArray(s)?s:s.data||s.regions||[];P.value=[{value:"",text:"All Regions"},...e.map(u=>({value:String(u.id),text:u.name}))]}catch(s){console.error("Failed to fetch regions:",s)}};return se([m,_,b,f,S],()=>{C.get(route("admin.employees.archived"),{search:m.value,role:_.value,region:b.value,sort_field:f.value,sort_direction:S.value,page:1},{preserveState:!0,replace:!0})},{deep:!0}),oe(te),(s,e)=>(c(),ae(ue,null,{header:a(()=>[l("div",ge,[e[4]||(e[4]=l("div",null,[l("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Disabled Employees"),l("p",{class:"mt-1 text-sm text-gray-500"}," Manage disabled employee accounts ")],-1)),l("div",xe,[d(R,{onClick:M},{default:a(()=>e[3]||(e[3]=[h("View Active Employees")])),_:1})])])]),default:a(()=>{var u,w,i;return[l("div",he,[l("div",_e,[o.status||o.success||o.error?(c(),p("div",be,[o.status?(c(),p("div",we,n(o.status),1)):x("",!0),o.success?(c(),p("div",Ce,n(o.success),1)):x("",!0),o.error?(c(),p("div",ke,n(o.error),1)):x("",!0)])):x("",!0),l("div",Se,[l("div",De,[d(ce,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),placeholder:"Search disabled employees by name, email, or employee ID...",class:"w-full"},null,8,["modelValue"])]),l("div",Ae,[d(O,{modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=t=>_.value=t),options:T,"option-value":"value","option-label":"text",placeholder:"All Roles",class:"w-full sm:w-48"},null,8,["modelValue"]),d(O,{modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=t=>b.value=t),options:P.value,"option-value":"value","option-label":"text",placeholder:"All Regions",class:"w-full sm:w-48"},null,8,["modelValue","options"]),l("div",Ve,[h(" ðŸ“‹ Showing "+n(((u=o.employees.data)==null?void 0:u.length)||0)+" disabled "+n(((w=o.employees.data)==null?void 0:w.length)===1?"employee":"employees")+" ",1),o.employees.data&&o.employees.data.length<o.employees.total?(c(),p("span",Ee," (Page "+n(o.employees.current_page)+" of "+n(o.employees.last_page)+") ",1)):x("",!0)])])]),l("div",Ne,[l("div",Re,[l("div",Le,[d(me,{columns:q,data:o.employees.data||[],"sort-field":f.value,"sort-direction":S.value,onSort:Q,class:"w-full"},{name:a(({row:t})=>{var r;return[l("div",je,[l("div",Pe,[l("span",Me,n(G(t.name)),1)]),l("div",null,[l("span",$e,n(H(t.name)||"N/A"),1),(r=t.employee_profile)!=null&&r.employee_id?(c(),p("span",Fe," ID: "+n(t.employee_profile.employee_id),1)):x("",!0)])])]}),email:a(({row:t})=>[l("span",Ie,n(t.email||"No email"),1)]),role:a(({row:t})=>[l("span",{class:ie(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize",J(t.role)])},n(t.role||"N/A"),3)]),"region.name":a(({row:t})=>{var r,v,g;return[l("div",Ue,[(r=t.employee_profile)!=null&&r.region&&t.employee_profile.region.color_hex?(c(),p("div",{key:0,class:"w-3 h-3 rounded-full mr-2 border border-gray-300",style:ne({backgroundColor:t.employee_profile.region.color_hex})},null,4)):x("",!0),l("span",ze,n(((g=(v=t.employee_profile)==null?void 0:v.region)==null?void 0:g.name)||"Not assigned"),1)])]}),archived_at:a(({row:t})=>{var r;return[l("span",Be,n((r=t.employee_profile)!=null&&r.archived_at?K(t.employee_profile.archived_at):"N/A"),1)]}),status:a(({row:t})=>e[5]||(e[5]=[l("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"}," Disabled ",-1)])),actions:a(({row:t})=>[l("div",Oe,[d(R,{onClick:r=>ee(t),class:"text-xs py-1 px-2"},{default:a(()=>e[6]||(e[6]=[h("Restore")])),_:2},1032,["onClick"]),d(B,{onClick:r=>Y(t),class:"text-xs py-1 px-2"},{default:a(()=>e[7]||(e[7]=[h("Delete")])),_:2},1032,["onClick"])])]),empty:a(()=>[l("div",Te,[l("div",We,[d(re(ve),{class:"h-10 w-10 text-gray-400 mx-auto mb-3"}),e[9]||(e[9]=l("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No disabled employees found",-1)),l("p",qe,n(m.value?"Try adjusting your search terms":"All employee accounts are currently active"),1),d(R,{onClick:M},{default:a(()=>e[8]||(e[8]=[h("View Active Employees")])),_:1})])])]),_:1},8,["data","sort-field","sort-direction"]),((i=o.employees.links)==null?void 0:i.length)>3?(c(),p("div",Ge,[d(fe,{pagination:o.employees,onPageChanged:X},null,8,["pagination"])])):x("",!0)])])])])]),d(pe,{show:L.value,onClose:j},{default:a(()=>{var t;return[l("div",He,[e[13]||(e[13]=l("h2",{class:"text-lg font-medium text-gray-900"},"Delete Employee Permanently?",-1)),l("p",Je,[e[10]||(e[10]=h(" Are you sure you want to permanently delete ")),l("strong",null,n((t=D.value)==null?void 0:t.name),1),e[11]||(e[11]=h("? This action cannot be undone. "))]),l("div",Ke,[d(R,{onClick:j},{default:a(()=>e[12]||(e[12]=[h("Cancel")])),_:1}),d(B,{onClick:Z,disabled:N.value},{default:a(()=>[N.value?(c(),p("span",Qe,"Processing...")):(c(),p("span",Xe,"Delete Permanently"))]),_:1},8,["disabled"])])])]}),_:1},8,["show"])]}),_:1}))}},ct=ye(Ye,[["__scopeId","data-v-cdf1a3d0"]]);export{ct as default};
