import{g as d,h as K,W as c,L as Q,d as T,o as r,w as s,b as o,a,c as u,e as X,f as n,n as j,t as m,F,r as Y,u as Z,P as ee,j as te}from"./app-BllHWhcy.js";import{E as le}from"./EmployeeLayout-CgMY_n5V.js";import{_ as L}from"./PrimaryButton-eC2eu5yQ.js";import{_ as C}from"./SecondaryButton-f4DzqSLc.js";import{D as $}from"./DangerButton-B7_oj2jq.js";import{_ as oe}from"./SearchInput-BSEud9IK.js";import{S as B}from"./SelectInput-BACJkmZB.js";import{_ as se}from"./DataTable-BArupUOg.js";import{M as ae}from"./Modal-DAAK_Wm5.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-BG8uMyS8.js";/* empty css                                                                    */const re={class:"flex justify-between items-center px-6"},ne={class:"flex space-x-2"},de={class:"px-6 sm:px-8"},ue={class:"mb-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 w-full mx-auto"},ce={class:"flex flex-wrap gap-2 w-full md:w-auto"},me={class:"justify-center flex items-center"},fe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg w-center"},pe={class:"p-5 bg-white border-b border-gray-200"},ve={class:"truncate block"},ye={class:"truncate block"},ge={key:0},xe={key:1,class:"text-gray-400"},_e={class:"flex space-x-2"},he={key:0,class:"mt-4 flex justify-center"},be={class:"flex flex-wrap -mb-1"},we=["innerHTML"],Ae={class:"p-6"},ke={class:"mt-1 text-sm text-gray-600"},Ce={class:"mt-6 flex justify-end space-x-4"},Ve={key:0},Ne={key:1},De={__name:"Index",props:{employees:Object,status:String,success:String,error:String},setup(_){var N,D,E,S,M;const p=_,k=d(!1),v=d(null),y=d(!1),h=d(((N=p.employees.filters)==null?void 0:N.search)||""),b=d(((D=p.employees.filters)==null?void 0:D.role)||""),w=d(((E=p.employees.filters)==null?void 0:E.region)||""),g=d(((S=p.employees.filters)==null?void 0:S.sort_field)||"created_at"),f=d(((M=p.employees.filters)==null?void 0:M.sort_direction)||"desc"),V=d([{value:"",text:"All Regions"}]),I=[{value:"",text:"All Roles"},{value:"admin",text:"Admin"},{value:"staff",text:"Staff"},{value:"driver",text:"Driver"},{value:"collector",text:"Collector"}],U=[{field:"name",header:"Name",sortable:!0},{field:"email",header:"Email",sortable:!0},{field:"role",header:"Role",sortable:!0,formatter:t=>(t==null?void 0:t.charAt(0).toUpperCase())+(t==null?void 0:t.slice(1))||"N/A"},{field:"employee_profile",header:"Employee ID",sortable:!0,formatter:t=>(t==null?void 0:t.employee_id)||"N/A"},{field:"employee_profile",header:"Region/Branch",sortable:!1,formatter:t=>{var l;return((l=t==null?void 0:t.region)==null?void 0:l.name)||"Not assigned"}},{field:"actions",header:"Actions",sortable:!1}],H=async()=>{try{const{data:t}=await te.get("/api/delivery/regions"),l=Array.isArray(t)?t:t.data||t.regions||[];V.value=[{value:"",text:"All Regions"},...l.map(x=>({value:String(x.id),text:x.name}))]}catch(t){console.error("Failed to fetch regions:",t)}},O=t=>{g.value===t?f.value=f.value==="asc"?"desc":"asc":(g.value=t,f.value="asc")},P=t=>{v.value=t,k.value=!0},A=()=>{k.value=!1,setTimeout(()=>{v.value=null,y.value=!1},300)},W=async()=>{if(v.value){y.value=!0;try{await c.put(route("admin.employees.archive",v.value.id),{},{preserveScroll:!0}),A(),c.reload({only:["employees"]})}catch{A(),alert("Failed to archive employee. Please try again.")}finally{y.value=!1}}},z=()=>c.get(route("admin.employees.create")),q=t=>c.get(route("admin.employees.show",t)),G=t=>c.get(route("admin.employees.edit",t)),J=()=>c.get(route("admin.employees.archived"));return K([h,b,w,g,f],()=>{c.get(route("admin.employees.index"),{search:h.value,role:b.value,region:w.value,sort_field:g.value,sort_direction:f.value,page:1},{preserveState:!0,replace:!0})},{deep:!0}),Q(H),(t,l)=>(r(),T(le,null,{header:s(()=>[o("div",re,[l[5]||(l[5]=o("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Employee Management",-1)),o("div",ne,[a(L,{onClick:z},{default:s(()=>l[3]||(l[3]=[n("Add New Employee")])),_:1}),a(C,{onClick:J},{default:s(()=>l[4]||(l[4]=[n("View Disabled Accounts")])),_:1})])])]),default:s(()=>{var x;return[o("div",de,[o("div",ue,[a(oe,{modelValue:h.value,"onUpdate:modelValue":l[0]||(l[0]=e=>h.value=e),placeholder:"Search employees...",class:"w-full md:w-72"},null,8,["modelValue"]),o("div",ce,[a(B,{modelValue:b.value,"onUpdate:modelValue":l[1]||(l[1]=e=>b.value=e),options:I,"option-value":"value","option-label":"text",placeholder:"All Roles",class:"w-full md:w-48"},null,8,["modelValue"]),a(B,{modelValue:w.value,"onUpdate:modelValue":l[2]||(l[2]=e=>w.value=e),options:V.value,"option-value":"value","option-label":"text",placeholder:"All Regions",class:"w-full md:w-48"},null,8,["modelValue","options"])])]),o("div",me,[o("div",fe,[o("div",pe,[a(se,{columns:U,data:_.employees.data,"sort-field":g.value,"sort-direction":f.value,onSort:O,class:"w-full"},{name:s(({row:e})=>[o("span",ve,m(e.name||"N/A"),1)]),email:s(({row:e})=>[o("span",ye,m(e.email||"N/A"),1)]),role:s(({row:e})=>[n(m(e.role?e.role.charAt(0).toUpperCase()+e.role.slice(1):"N/A"),1)]),employee_id:s(({row:e})=>{var i;return[(i=e.employee_profile)!=null&&i.employee_id?(r(),u("span",ge,m(e.employee_profile.employee_id),1)):(r(),u("span",xe," Not assigned "))]}),region:s(({row:e})=>{var i,R;return[n(m(((R=(i=e.employee_profile)==null?void 0:i.region)==null?void 0:R.name)||"Not assigned"),1)]}),status:s(({row:e})=>[o("span",{class:j(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},m(e.is_active?"Active":"Inactive"),3)]),actions:s(({row:e})=>[o("div",_e,[a(C,{onClick:i=>q(e.id)},{default:s(()=>l[6]||(l[6]=[n("View")])),_:2},1032,["onClick"]),a(L,{onClick:i=>G(e.id)},{default:s(()=>l[7]||(l[7]=[n("Edit")])),_:2},1032,["onClick"]),a($,{onClick:i=>P(e)},{default:s(()=>l[8]||(l[8]=[n("Disable")])),_:2},1032,["onClick"])])]),_:1},8,["data","sort-field","sort-direction"]),((x=_.employees.links)==null?void 0:x.length)>3?(r(),u("div",he,[o("div",be,[(r(!0),u(F,null,Y(_.employees.links,(e,i)=>(r(),u(F,{key:i},[e.url?(r(),T(Z(ee),{key:1,class:j(["mr-1 mb-1 px-4 py-3 text-sm leading-4 border rounded hover:bg-white focus:border-indigo-500 focus:text-indigo-500",{"bg-blue-700 text-white":e.active}]),href:e.url,innerHTML:e.label},null,8,["class","href","innerHTML"])):(r(),u("div",{key:0,class:"mr-1 mb-1 px-4 py-3 text-sm leading-4 text-gray-400 border rounded",innerHTML:e.label},null,8,we))],64))),128))])])):X("",!0)])])])]),a(ae,{show:k.value,onClose:A},{default:s(()=>{var e;return[o("div",Ae,[l[12]||(l[12]=o("h2",{class:"text-lg font-medium text-gray-900"},"Disable Employee?",-1)),o("p",ke,[l[9]||(l[9]=n(" Are you sure you want to Disable ")),o("strong",null,m((e=v.value)==null?void 0:e.name),1),l[10]||(l[10]=n("? This action can be undone later if needed. "))]),o("div",Ce,[a(C,{onClick:A},{default:s(()=>l[11]||(l[11]=[n("Cancel")])),_:1}),a($,{onClick:W,disabled:y.value},{default:s(()=>[y.value?(r(),u("span",Ve,"Disabling...")):(r(),u("span",Ne,"Disable"))]),_:1},8,["disabled"])])])]}),_:1},8,["show"])]}),_:1}))}},He=ie(De,[["__scopeId","data-v-24451c29"]]);export{He as default};
