import{p as ie,h as le,d as O,o as r,w as D,b as e,v as H,q as de,x as oe,L as ce,e as c,t as n,c as l,F as J,r as Q,n as b,a as ue,u as X,P as Y,f as Z,W as pe}from"./app-SYI-8bdC.js";import{E as xe}from"./EmployeeLayout-B8SQYBgj.js";import{P as $}from"./Pagination-DOkO8BU-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-D6cPZaLM.js";import"./DangerButton-CNs3xLhr.js";const ge={class:"space-y-6"},ye={class:"bg-white shadow rounded-lg"},me={class:"p-4 border-b border-gray-200"},fe={class:"flex flex-col sm:flex-row gap-4"},he={class:"flex-1"},_e={class:"sm:w-48"},ve={class:"bg-white shadow rounded-lg"},we={class:"px-4 py-5 sm:px-6 border-b border-gray-200"},be={class:"text-lg font-medium leading-6 text-gray-900"},ke={class:"overflow-hidden"},Ne={class:"min-w-full divide-y divide-gray-200"},qe={class:"bg-white divide-y divide-gray-200"},Ce={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Se={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Oe={class:"text-xs text-gray-400"},Ae={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},De={class:"px-6 py-4 whitespace-nowrap"},Re={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Pe={class:"space-y-1"},je={class:"flex items-center space-x-1"},Ue={class:"font-medium"},Ve={class:"flex flex-wrap gap-1 text-xs"},Be={key:0,class:"text-green-600 bg-green-50 px-1 rounded"},Le={key:1,class:"text-orange-600 bg-orange-50 px-1 rounded"},Te={key:2,class:"text-red-600 bg-red-50 px-1 rounded"},ze={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ie={class:"capitalize"},Ee={class:"px-6 py-4 whitespace-nowrap text-sm"},Ke={key:1,class:"inline-flex px-2 text-xs font-semibold leading-5 rounded-full bg-yellow-100 text-yellow-800"},We={key:2,class:"text-gray-400 text-xs"},Fe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Me={class:"flex space-x-2"},Ge={key:1},He={class:"bg-white shadow rounded-lg"},Je={class:"px-4 py-5 sm:px-6 border-b border-gray-200"},Qe={class:"text-lg font-medium leading-6 text-gray-900"},Xe={class:"overflow-hidden"},Ye={class:"min-w-full divide-y divide-gray-200"},Ze={class:"bg-white divide-y divide-gray-200"},$e={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},et={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},tt={class:"text-xs text-gray-400"},st={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},at={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},nt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},rt={class:"space-y-1"},it={class:"flex items-center space-x-1"},lt={class:"font-medium"},dt={class:"flex flex-wrap gap-1 text-xs"},ot={key:0,class:"text-green-600 bg-green-50 px-1 rounded"},ct={key:1,class:"text-orange-600 bg-orange-50 px-1 rounded"},ut={key:2,class:"text-red-600 bg-red-50 px-1 rounded"},pt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},xt={class:"px-6 py-4 whitespace-nowrap text-sm"},gt={key:1,class:"inline-flex px-2 text-xs font-semibold leading-5 rounded-full bg-yellow-100 text-yellow-800"},yt={key:2,class:"text-gray-400 text-xs"},mt={key:1},kt={__name:"CompletionIndex",props:{pendingOrders:Object,completedOrders:Object,filters:Object},setup(o){var B,L;const R=o,u=ie({search:((B=R.filters)==null?void 0:B.search)||"",status:((L=R.filters)==null?void 0:L.status)||""});function k(){pe.get(route("delivery-completion.ready-for-completion"),u,{preserveState:!0,replace:!0})}function N(a){var t,i;return((i=(t=a.delivery_request)==null?void 0:t.packages)==null?void 0:i.filter(d=>d.status==="delivered").length)||0}function q(a){var t,i;return((i=(t=a.delivery_request)==null?void 0:t.packages)==null?void 0:i.filter(d=>d.status==="damaged_in_transit").length)||0}function C(a){var t,i;return((i=(t=a.delivery_request)==null?void 0:t.packages)==null?void 0:i.filter(d=>d.status==="lost_in_transit").length)||0}function S(a){var t,i;return((i=(t=a.delivery_request)==null?void 0:t.refunds)==null?void 0:i.length)>0}function P(a){var t;return a.status==="needs_review"&&((t=a.delivery_request)==null?void 0:t.payment_type)==="prepaid"&&!S(a)}function A(a){var i,d;const t=(d=(i=a.delivery_request)==null?void 0:i.refunds)==null?void 0:d[0];return t?typeof t.status=="string"?t.status.charAt(0).toUpperCase()+t.status.slice(1):t.status_label||"":""}function j(a){var t,i,d;return(d=(i=(t=a.delivery_request)==null?void 0:t.refunds)==null?void 0:i[0])==null?void 0:d.id}function ee(a){return a?a.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):"UNKNOWN"}function te(a){return{delivered:"bg-green-100 text-green-800",needs_review:"bg-yellow-100 text-yellow-800",completed:"bg-blue-100 text-blue-800",partially_delivered:"bg-orange-100 text-orange-800"}[a]||"bg-gray-100 text-gray-800"}function se(a){return{paid:"text-green-600",awaiting_payment:"text-yellow-600",refunded:"text-blue-600",requires_adjustment:"text-orange-600",unpaid:"text-red-600",cancelled:"text-red-600"}[a]||"text-gray-600"}function ae(a){return{paid:"bg-green-100 text-green-800",awaiting_payment:"bg-yellow-100 text-yellow-800",refunded:"bg-blue-100 text-blue-800",requires_adjustment:"bg-orange-100 text-orange-800",unpaid:"bg-red-100 text-red-800"}[a]||"bg-gray-100 text-gray-800"}function U(a){const t=A(a).toLowerCase();return{pending:"bg-yellow-100 text-yellow-800",processed:"bg-green-100 text-green-800",adjusted:"bg-blue-100 text-blue-800"}[t]||"bg-gray-100 text-gray-800"}function ne(a){if(!a)return"N/A";try{const t=new Date(a);return isNaN(t.getTime())?"Invalid Date":t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("Date formatting error:",t),"Invalid Date"}}function re(a){return a.completed_at||a.updated_at||a.created_at}let V;return le(()=>u.search,()=>{clearTimeout(V),V=setTimeout(()=>{(u.search===""||u.search.length>=3)&&k()},500)}),(a,t)=>(r(),O(xe,null,{default:D(()=>{var i,d,T,z,I,E,K,W,F,M;return[e("div",ge,[t[11]||(t[11]=e("div",{class:"sm:flex sm:items-center"},[e("div",{class:"sm:flex-auto"},[e("h1",{class:"text-2xl font-semibold text-gray-900"},"Delivery Completion"),e("p",{class:"mt-2 text-sm text-gray-700"}," Process delivery outcomes and handle package releases. ")])],-1)),e("div",ye,[e("div",me,[e("div",fe,[e("div",he,[H(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>u.search=s),type:"text",placeholder:"Search by reference number or sender...",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onKeyup:de(k,["enter"])},null,544),[[oe,u.search]])]),e("div",_e,[H(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>u.status=s),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:k},t[2]||(t[2]=[e("option",{value:""},"All Status",-1),e("option",{value:"delivered"},"Delivered",-1),e("option",{value:"needs_review"},"Needs Review",-1),e("option",{value:"completed"},"Completed",-1)]),544),[[ce,u.status]])]),e("button",{onClick:k,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Search ")])])]),e("div",ve,[e("div",we,[e("h3",be," Pending Completion ("+n(((d=(i=o.pendingOrders)==null?void 0:i.meta)==null?void 0:d.total)||0)+") ",1),t[3]||(t[3]=e("p",{class:"mt-1 text-sm text-gray-500"}," Orders that need completion processing ",-1))]),e("div",ke,[e("table",Ne,[t[7]||(t[7]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reference "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Sender → Receiver "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Driver "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Packages "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Payment "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Refund Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",qe,[((z=(T=o.pendingOrders)==null?void 0:T.data)==null?void 0:z.length)>0?(r(!0),l(J,{key:0},Q(o.pendingOrders.data,s=>{var p,x,g,y,m,f,h,_,v,w,G;return r(),l("tr",{key:s.id},[e("td",Ce,n(((p=s.delivery_request)==null?void 0:p.reference_number)||"N/A"),1),e("td",Se,[e("div",null,n(((g=(x=s.delivery_request)==null?void 0:x.sender)==null?void 0:g.name)||"N/A"),1),e("div",Oe,"→ "+n(((m=(y=s.delivery_request)==null?void 0:y.receiver)==null?void 0:m.name)||"N/A"),1)]),e("td",Ae,n(((f=s.driver)==null?void 0:f.name)||"Unassigned"),1),e("td",De,[e("span",{class:b([te(s.status),"inline-flex px-2 text-xs font-semibold leading-5 rounded-full"])},n(ee(s.status)),3)]),e("td",Re,[e("div",Pe,[e("div",je,[e("span",Ue,n(((_=(h=s.delivery_request)==null?void 0:h.packages)==null?void 0:_.length)||0)+" total",1)]),e("div",Ve,[N(s)>0?(r(),l("span",Be,n(N(s))+" delivered ",1)):c("",!0),q(s)>0?(r(),l("span",Le,n(q(s))+" damaged ",1)):c("",!0),C(s)>0?(r(),l("span",Te,n(C(s))+" lost ",1)):c("",!0)])])]),e("td",ze,[e("div",Ie,n(((v=s.delivery_request)==null?void 0:v.payment_type)||"N/A"),1),e("div",{class:b([se((w=s.delivery_request)==null?void 0:w.payment_status),"text-xs capitalize"])},n(((G=s.delivery_request)==null?void 0:G.payment_status)||"N/A"),3)]),e("td",Ee,[S(s)?(r(),l("span",{key:0,class:b([U(s),"inline-flex px-2 text-xs font-semibold leading-5 rounded-full"])},n(A(s)),3)):P(s)?(r(),l("span",Ke," Needs Refund ")):(r(),l("span",We,"No refund"))]),e("td",Fe,[e("div",Me,[ue(X(Y),{href:a.route("delivery-completion.show-form",{order:s.id}),class:"text-blue-600 hover:text-blue-900"},{default:D(()=>t[4]||(t[4]=[Z(" Process ")])),_:2},1032,["href"]),S(s)&&j(s)?(r(),O(X(Y),{key:0,href:a.route("refunds.show",{refund:j(s)}),class:"text-green-600 hover:text-green-900"},{default:D(()=>t[5]||(t[5]=[Z(" View Refund ")])),_:2},1032,["href"])):c("",!0)])])])}),128)):(r(),l("tr",Ge,t[6]||(t[6]=[e("td",{colspan:"8",class:"px-6 py-4 text-center text-sm text-gray-500"}," No pending orders found. ",-1)])))])])]),(I=o.pendingOrders)!=null&&I.links?(r(),O($,{key:0,links:o.pendingOrders.links,class:"px-4 py-3"},null,8,["links"])):c("",!0)]),e("div",He,[e("div",Je,[e("h3",Qe," Completed Orders ("+n(((K=(E=o.completedOrders)==null?void 0:E.meta)==null?void 0:K.total)||0)+") ",1),t[8]||(t[8]=e("p",{class:"mt-1 text-sm text-gray-500"}," Successfully processed deliveries ",-1))]),e("div",Xe,[e("table",Ye,[t[10]||(t[10]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reference "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Sender → Receiver "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Driver "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Completed At "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Packages "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Payment Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Refund Status ")])],-1)),e("tbody",Ze,[((F=(W=o.completedOrders)==null?void 0:W.data)==null?void 0:F.length)>0?(r(!0),l(J,{key:0},Q(o.completedOrders.data,s=>{var p,x,g,y,m,f,h,_,v,w;return r(),l("tr",{key:s.id},[e("td",$e,n(((p=s.delivery_request)==null?void 0:p.reference_number)||"N/A"),1),e("td",et,[e("div",null,n(((g=(x=s.delivery_request)==null?void 0:x.sender)==null?void 0:g.name)||"N/A"),1),e("div",tt,"→ "+n(((m=(y=s.delivery_request)==null?void 0:y.receiver)==null?void 0:m.name)||"N/A"),1)]),e("td",st,n(((f=s.driver)==null?void 0:f.name)||"Unassigned"),1),e("td",at,n(ne(re(s))),1),e("td",nt,[e("div",rt,[e("div",it,[e("span",lt,n(((_=(h=s.delivery_request)==null?void 0:h.packages)==null?void 0:_.length)||0)+" total",1)]),e("div",dt,[N(s)>0?(r(),l("span",ot,n(N(s))+" delivered ",1)):c("",!0),q(s)>0?(r(),l("span",ct,n(q(s))+" damaged ",1)):c("",!0),C(s)>0?(r(),l("span",ut,n(C(s))+" lost ",1)):c("",!0)])])]),e("td",pt,[e("span",{class:b([ae((v=s.delivery_request)==null?void 0:v.payment_status),"inline-flex px-2 text-xs font-semibold leading-5 rounded-full capitalize"])},n(((w=s.delivery_request)==null?void 0:w.payment_status)||"N/A"),3)]),e("td",xt,[S(s)?(r(),l("span",{key:0,class:b([U(s),"inline-flex px-2 text-xs font-semibold leading-5 rounded-full"])},n(A(s)),3)):P(s)?(r(),l("span",gt," Needs Refund ")):(r(),l("span",yt,"No refund"))])])}),128)):(r(),l("tr",mt,t[9]||(t[9]=[e("td",{colspan:"7",class:"px-6 py-4 text-center text-sm text-gray-500"}," No completed orders found. ",-1)])))])])]),(M=o.completedOrders)!=null&&M.links?(r(),O($,{key:0,links:o.completedOrders.links,class:"px-4 py-3"},null,8,["links"])):c("",!0)])])]}),_:1}))}};export{kt as default};
